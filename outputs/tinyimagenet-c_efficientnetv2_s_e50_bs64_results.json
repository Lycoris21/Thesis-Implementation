{
  "config": {
    "dataset": "tinyimagenet-c",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [],
  "baseline": {
    "test_acc": 0.09843333333333333,
    "test_loss": 5.054373860967
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7335895735998609,
      "ECE": 0.2285272784418861,
      "ARC_area": 0.1891627018418087,
      "AvUC": 0.42855918599154674
    },
    "gradient": {
      "AUROC_error": 0.5841811798005081,
      "ECE": 0.2285272784418861,
      "ARC_area": 0.1461070139542262,
      "AvUC": 0.6485599906445351
    },
    "hybrid": {
      "AUROC_error": 0.709140650396844,
      "ECE": 0.2285272784418861,
      "ARC_area": 0.1868543909250791,
      "AvUC": 0.5385595883070454
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.10666962962962963,
      "kept_count": 675000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.115715,
      "kept_count": 600000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.12568761904761905,
      "kept_count": 525000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.13784444444444444,
      "kept_count": 450000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.152888,
      "kept_count": 375000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.09966074074074074,
      "kept_count": 675000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.10206333333333334,
      "kept_count": 600000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.10566285714285714,
      "kept_count": 525000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.11028444444444445,
      "kept_count": 450000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.11659466666666667,
      "kept_count": 375000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.10397037037037037,
      "kept_count": 675000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.111265,
      "kept_count": 600000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.12043428571428572,
      "kept_count": 525000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.1319511111111111,
      "kept_count": 450000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09843333333333333,
      "accuracy_after_rejection": 0.14694666666666667,
      "kept_count": 375000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.057982187718153,
      0.10602989047765732,
      0.16632547974586487,
      0.23200270533561707,
      0.29846298694610596,
      0.365201473236084,
      0.43166041374206543,
      0.4985368847846985,
      0.565515398979187,
      0.6319965720176697,
      0.6988192200660706,
      0.7658224701881409,
      0.8324233889579773,
      0.8990690112113953,
      0.9542372226715088
    ],
    "bin_acc": [
      0.017516421154141426,
      0.028565043583512306,
      0.04376063868403435,
      0.06070706993341446,
      0.07676143944263458,
      0.09694045782089233,
      0.12067700922489166,
      0.1387174278497696,
      0.16252857446670532,
      0.1923341602087021,
      0.22639049589633942,
      0.26159486174583435,
      0.32273873686790466,
      0.43429824709892273,
      0.6337825655937195
    ],
    "bin_count": [
      6394,
      102923,
      143348,
      120299,
      91374,
      69651,
      53175,
      40341,
      31053,
      24707,
      19939,
      16365,
      13466,
      11400,
      5565
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        200,
        1637,
        2575,
        2638,
        2686,
        2797,
        3156,
        3441,
        3773,
        3792,
        4047,
        4012,
        4259,
        4309,
        4258,
        4058,
        4049,
        3820,
        3633,
        3224,
        2765,
        2018,
        1411,
        806,
        329,
        104,
        24,
        4,
        0,
        0
      ],
      "incorrect_counts": [
        78,
        806,
        2016,
        3229,
        4362,
        5825,
        7527,
        10054,
        12470,
        15708,
        18734,
        23037,
        27544,
        32495,
        38140,
        43677,
        49095,
        54184,
        57581,
        59458,
        57333,
        52969,
        44874,
        31544,
        16678,
        5557,
        1132,
        68,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        527,
        1596,
        2800,
        3340,
        4737,
        6163,
        7590,
        8553,
        8355,
        7477,
        6507,
        4996,
        3855,
        2647,
        1837,
        1150,
        739,
        428,
        251,
        124,
        73,
        39,
        21,
        7,
        6,
        4,
        3,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        110,
        890,
        3075,
        7813,
        23875,
        48175,
        71305,
        84098,
        91042,
        88174,
        76287,
        60257,
        43570,
        30070,
        19393,
        12137,
        7232,
        4066,
        2237,
        1206,
        571,
        301,
        150,
        79,
        28,
        21,
        4,
        6,
        2,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        105,
        1084,
        1987,
        2406,
        3133,
        3834,
        4338,
        5052,
        5364,
        5857,
        6179,
        6382,
        6583,
        6212,
        5589,
        4334,
        2759,
        1493,
        705,
        261,
        105,
        45,
        12,
        3,
        3,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        6,
        302,
        999,
        2281,
        4131,
        6965,
        10652,
        16161,
        23175,
        32947,
        45094,
        60496,
        77001,
        94982,
        104272,
        89120,
        57577,
        29946,
        12945,
        4914,
        1556,
        477,
        134,
        31,
        9,
        2,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet-c_efficientnetv2_s_e50_bs64.pth"
}