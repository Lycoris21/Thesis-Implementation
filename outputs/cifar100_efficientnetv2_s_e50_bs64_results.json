{
  "config": {
    "dataset": "cifar100",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.643820125427246,
      "train_acc": 0.01222,
      "lr": 0.009990133642141357
    },
    {
      "epoch": 2,
      "train_loss": 4.624153349151611,
      "train_acc": 0.01298,
      "lr": 0.009960573506572389
    },
    {
      "epoch": 3,
      "train_loss": 4.614120920257569,
      "train_acc": 0.01312,
      "lr": 0.009911436253643442
    },
    {
      "epoch": 4,
      "train_loss": 4.606476855010986,
      "train_acc": 0.01412,
      "lr": 0.009842915805643154
    },
    {
      "epoch": 5,
      "train_loss": 4.591571945953369,
      "train_acc": 0.01534,
      "lr": 0.009755282581475767
    },
    {
      "epoch": 6,
      "train_loss": 4.435997044067383,
      "train_acc": 0.03118,
      "lr": 0.009648882429441256
    },
    {
      "epoch": 7,
      "train_loss": 4.135019862518311,
      "train_acc": 0.0705,
      "lr": 0.009524135262330098
    },
    {
      "epoch": 8,
      "train_loss": 3.943021519088745,
      "train_acc": 0.10688,
      "lr": 0.009381533400219317
    },
    {
      "epoch": 9,
      "train_loss": 3.760952311859131,
      "train_acc": 0.1463,
      "lr": 0.009221639627510075
    },
    {
      "epoch": 10,
      "train_loss": 3.5993062898254395,
      "train_acc": 0.18366,
      "lr": 0.009045084971874737
    },
    {
      "epoch": 11,
      "train_loss": 3.462380793914795,
      "train_acc": 0.21454,
      "lr": 0.008852566213878947
    },
    {
      "epoch": 12,
      "train_loss": 3.3392712126159667,
      "train_acc": 0.24426,
      "lr": 0.008644843137107058
    },
    {
      "epoch": 13,
      "train_loss": 3.230104694366455,
      "train_acc": 0.27222,
      "lr": 0.008422735529643444
    },
    {
      "epoch": 14,
      "train_loss": 3.132979783325195,
      "train_acc": 0.29394,
      "lr": 0.00818711994874345
    },
    {
      "epoch": 15,
      "train_loss": 3.03683491355896,
      "train_acc": 0.32168,
      "lr": 0.007938926261462368
    },
    {
      "epoch": 16,
      "train_loss": 2.9438030892944336,
      "train_acc": 0.34566,
      "lr": 0.007679133974894984
    },
    {
      "epoch": 17,
      "train_loss": 2.853248822555542,
      "train_acc": 0.3729,
      "lr": 0.007408768370508577
    },
    {
      "epoch": 18,
      "train_loss": 2.766136448516846,
      "train_acc": 0.39406,
      "lr": 0.0071288964578253644
    },
    {
      "epoch": 19,
      "train_loss": 2.688098299484253,
      "train_acc": 0.4142,
      "lr": 0.0068406227634233915
    },
    {
      "epoch": 20,
      "train_loss": 2.608791912612915,
      "train_acc": 0.44102,
      "lr": 0.006545084971874738
    },
    {
      "epoch": 21,
      "train_loss": 2.542783729095459,
      "train_acc": 0.45858,
      "lr": 0.006243449435824274
    },
    {
      "epoch": 22,
      "train_loss": 2.471600945739746,
      "train_acc": 0.48058,
      "lr": 0.005936906572928625
    },
    {
      "epoch": 23,
      "train_loss": 2.399101534729004,
      "train_acc": 0.5023,
      "lr": 0.005626666167821524
    },
    {
      "epoch": 24,
      "train_loss": 2.3369597759246825,
      "train_acc": 0.51984,
      "lr": 0.005313952597646569
    },
    {
      "epoch": 25,
      "train_loss": 2.277388194274902,
      "train_acc": 0.5408,
      "lr": 0.005000000000000002
    },
    {
      "epoch": 26,
      "train_loss": 2.2162609507751463,
      "train_acc": 0.56198,
      "lr": 0.004686047402353435
    },
    {
      "epoch": 27,
      "train_loss": 2.1616837652587892,
      "train_acc": 0.57602,
      "lr": 0.004373333832178481
    },
    {
      "epoch": 28,
      "train_loss": 2.103766526031494,
      "train_acc": 0.59752,
      "lr": 0.0040630934270713785
    },
    {
      "epoch": 29,
      "train_loss": 2.055377725906372,
      "train_acc": 0.6126,
      "lr": 0.0037565505641757274
    },
    {
      "epoch": 30,
      "train_loss": 2.01277853515625,
      "train_acc": 0.62948,
      "lr": 0.0034549150281252662
    },
    {
      "epoch": 31,
      "train_loss": 1.9668169770050048,
      "train_acc": 0.64564,
      "lr": 0.0031593772365766134
    },
    {
      "epoch": 32,
      "train_loss": 1.9307167022705078,
      "train_acc": 0.65766,
      "lr": 0.0028711035421746384
    },
    {
      "epoch": 33,
      "train_loss": 1.8955850175476074,
      "train_acc": 0.66938,
      "lr": 0.002591231629491424
    },
    {
      "epoch": 34,
      "train_loss": 1.858262341003418,
      "train_acc": 0.68466,
      "lr": 0.0023208660251050166
    },
    {
      "epoch": 35,
      "train_loss": 1.8356408019256591,
      "train_acc": 0.6928,
      "lr": 0.0020610737385376356
    },
    {
      "epoch": 36,
      "train_loss": 1.8002454429626464,
      "train_acc": 0.7066,
      "lr": 0.001812880051256552
    },
    {
      "epoch": 37,
      "train_loss": 1.770990736541748,
      "train_acc": 0.71674,
      "lr": 0.001577264470356557
    },
    {
      "epoch": 38,
      "train_loss": 1.7533303932952882,
      "train_acc": 0.72094,
      "lr": 0.0013551568628929439
    },
    {
      "epoch": 39,
      "train_loss": 1.7372430224609374,
      "train_acc": 0.72948,
      "lr": 0.0011474337861210548
    },
    {
      "epoch": 40,
      "train_loss": 1.7112235127258302,
      "train_acc": 0.73874,
      "lr": 0.0009549150281252636
    },
    {
      "epoch": 41,
      "train_loss": 1.6979999598693847,
      "train_acc": 0.74412,
      "lr": 0.000778360372489926
    },
    {
      "epoch": 42,
      "train_loss": 1.6783215826416016,
      "train_acc": 0.7528,
      "lr": 0.0006184665997806823
    },
    {
      "epoch": 43,
      "train_loss": 1.6671954583740234,
      "train_acc": 0.75648,
      "lr": 0.0004758647376699034
    },
    {
      "epoch": 44,
      "train_loss": 1.6585685191345214,
      "train_acc": 0.75982,
      "lr": 0.0003511175705587434
    },
    {
      "epoch": 45,
      "train_loss": 1.6520930101013183,
      "train_acc": 0.761,
      "lr": 0.00024471741852423245
    },
    {
      "epoch": 46,
      "train_loss": 1.6523365035247803,
      "train_acc": 0.76108,
      "lr": 0.00015708419435684522
    },
    {
      "epoch": 47,
      "train_loss": 1.6388379220581055,
      "train_acc": 0.7667,
      "lr": 8.856374635655642e-05
    },
    {
      "epoch": 48,
      "train_loss": 1.635222105178833,
      "train_acc": 0.76948,
      "lr": 3.942649342761119e-05
    },
    {
      "epoch": 49,
      "train_loss": 1.6348790871429444,
      "train_acc": 0.76886,
      "lr": 9.866357858642208e-06
    },
    {
      "epoch": 50,
      "train_loss": 1.6285958699035645,
      "train_acc": 0.76998,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3222,
    "test_loss": 2.948147755050659
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7672794041554457,
      "ECE": 0.15510520298033953,
      "ARC_area": 0.5397766703523051,
      "AvUC": 0.4394482873073779
    },
    "gradient": {
      "AUROC_error": 0.6644224413193524,
      "ECE": 0.15510520298033953,
      "ARC_area": 0.4745359800630716,
      "AvUC": 0.6415470932346711
    },
    "hybrid": {
      "AUROC_error": 0.7651233021208756,
      "ECE": 0.15510520298033953,
      "ARC_area": 0.5406479366668155,
      "AvUC": 0.5404976901642978
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.3457777777777778,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.3735,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.4074285714285714,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.44183333333333336,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.483,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.33255555555555555,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.3465,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.36557142857142855,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.39016666666666666,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.4174,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.3453333333333333,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.372375,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.4042857142857143,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.44083333333333335,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3222,
      "accuracy_after_rejection": 0.4816,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11368713527917862,
      0.16908863186836243,
      0.23440393805503845,
      0.299551397562027,
      0.36629635095596313,
      0.4324829876422882,
      0.49960196018218994,
      0.5656313300132751,
      0.6328532695770264,
      0.6990017294883728,
      0.7676785588264465,
      0.832694411277771,
      0.9016591310501099,
      0.9584991335868835
    ],
    "bin_acc": [
      NaN,
      0.10384615510702133,
      0.10247747600078583,
      0.11120543628931046,
      0.1871345043182373,
      0.22191528975963593,
      0.24474789202213287,
      0.29488858580589294,
      0.33190882205963135,
      0.35583940148353577,
      0.42307692766189575,
      0.5557940006256104,
      0.621004581451416,
      0.7847357988357544,
      0.9303675293922424
    ],
    "bin_count": [
      0,
      260,
      888,
      1178,
      1197,
      1086,
      952,
      763,
      702,
      548,
      494,
      466,
      438,
      511,
      517
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        24,
        216,
        250,
        211,
        186,
        183,
        169,
        194,
        167,
        173,
        142,
        162,
        172,
        160,
        168,
        123,
        145,
        91,
        95,
        66,
        51,
        30,
        20,
        16,
        5,
        3,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        3,
        7,
        32,
        46,
        76,
        103,
        132,
        180,
        207,
        258,
        330,
        377,
        375,
        445,
        483,
        495,
        558,
        596,
        570,
        510,
        396,
        290,
        174,
        87,
        36,
        11,
        1,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        604,
        1123,
        994,
        417,
        76,
        6,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        203,
        1671,
        3147,
        1482,
        219,
        26,
        4,
        4,
        2,
        2,
        3,
        1,
        2,
        2,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        3,
        1,
        1,
        0,
        2
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        90,
        397,
        316,
        330,
        314,
        322,
        268,
        293,
        277,
        243,
        180,
        125,
        43,
        22,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        4,
        31,
        87,
        182,
        287,
        437,
        596,
        751,
        879,
        1025,
        1094,
        807,
        442,
        117,
        29,
        3,
        3,
        4,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_efficientnetv2_s_e50_bs64.pth"
}