{
  "config": {
    "dataset": "cifar10",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 2.3221382429504396,
      "train_acc": 0.12492,
      "lr": 0.009990133642141357
    },
    {
      "epoch": 2,
      "train_loss": 2.275758262939453,
      "train_acc": 0.14316,
      "lr": 0.009960573506572389
    },
    {
      "epoch": 3,
      "train_loss": 2.0854563085174562,
      "train_acc": 0.21268,
      "lr": 0.009911436253643442
    },
    {
      "epoch": 4,
      "train_loss": 1.9367549263763428,
      "train_acc": 0.2913,
      "lr": 0.009842915805643154
    },
    {
      "epoch": 5,
      "train_loss": 1.7488721031951904,
      "train_acc": 0.40926,
      "lr": 0.009755282581475767
    },
    {
      "epoch": 6,
      "train_loss": 1.6061895805358886,
      "train_acc": 0.49118,
      "lr": 0.009648882429441256
    },
    {
      "epoch": 7,
      "train_loss": 1.4888639530944825,
      "train_acc": 0.54826,
      "lr": 0.009524135262330098
    },
    {
      "epoch": 8,
      "train_loss": 1.382883130683899,
      "train_acc": 0.60262,
      "lr": 0.009381533400219317
    },
    {
      "epoch": 9,
      "train_loss": 1.2819618908691406,
      "train_acc": 0.64952,
      "lr": 0.009221639627510075
    },
    {
      "epoch": 10,
      "train_loss": 1.2039875935363769,
      "train_acc": 0.68906,
      "lr": 0.009045084971874737
    },
    {
      "epoch": 11,
      "train_loss": 1.1279833054351807,
      "train_acc": 0.72208,
      "lr": 0.008852566213878947
    },
    {
      "epoch": 12,
      "train_loss": 1.0621826570129393,
      "train_acc": 0.75612,
      "lr": 0.008644843137107058
    },
    {
      "epoch": 13,
      "train_loss": 1.0054504830551148,
      "train_acc": 0.78136,
      "lr": 0.008422735529643444
    },
    {
      "epoch": 14,
      "train_loss": 0.9486176246643067,
      "train_acc": 0.80748,
      "lr": 0.00818711994874345
    },
    {
      "epoch": 15,
      "train_loss": 0.8959044578170776,
      "train_acc": 0.8328,
      "lr": 0.007938926261462368
    },
    {
      "epoch": 16,
      "train_loss": 0.853477914352417,
      "train_acc": 0.85238,
      "lr": 0.007679133974894984
    },
    {
      "epoch": 17,
      "train_loss": 0.8115894468688964,
      "train_acc": 0.87146,
      "lr": 0.007408768370508577
    },
    {
      "epoch": 18,
      "train_loss": 0.7813068508148193,
      "train_acc": 0.88542,
      "lr": 0.0071288964578253644
    },
    {
      "epoch": 19,
      "train_loss": 0.7474027914810181,
      "train_acc": 0.9006,
      "lr": 0.0068406227634233915
    },
    {
      "epoch": 20,
      "train_loss": 0.7264442926025391,
      "train_acc": 0.90894,
      "lr": 0.006545084971874738
    },
    {
      "epoch": 21,
      "train_loss": 0.7045088792800903,
      "train_acc": 0.91806,
      "lr": 0.006243449435824274
    },
    {
      "epoch": 22,
      "train_loss": 0.6848054893493652,
      "train_acc": 0.92786,
      "lr": 0.005936906572928625
    },
    {
      "epoch": 23,
      "train_loss": 0.6711197911453247,
      "train_acc": 0.93362,
      "lr": 0.005626666167821524
    },
    {
      "epoch": 24,
      "train_loss": 0.6549864415740967,
      "train_acc": 0.93948,
      "lr": 0.005313952597646569
    },
    {
      "epoch": 25,
      "train_loss": 0.6452231446075439,
      "train_acc": 0.94434,
      "lr": 0.005000000000000002
    },
    {
      "epoch": 26,
      "train_loss": 0.6305436724853516,
      "train_acc": 0.95066,
      "lr": 0.004686047402353435
    },
    {
      "epoch": 27,
      "train_loss": 0.6230773535537719,
      "train_acc": 0.95312,
      "lr": 0.004373333832178481
    },
    {
      "epoch": 28,
      "train_loss": 0.6172332090377808,
      "train_acc": 0.95654,
      "lr": 0.0040630934270713785
    },
    {
      "epoch": 29,
      "train_loss": 0.6055805731201171,
      "train_acc": 0.96146,
      "lr": 0.0037565505641757274
    },
    {
      "epoch": 30,
      "train_loss": 0.6001791510772705,
      "train_acc": 0.9638,
      "lr": 0.0034549150281252662
    },
    {
      "epoch": 31,
      "train_loss": 0.5916559635925293,
      "train_acc": 0.96692,
      "lr": 0.0031593772365766134
    },
    {
      "epoch": 32,
      "train_loss": 0.5872013920783996,
      "train_acc": 0.96844,
      "lr": 0.0028711035421746384
    },
    {
      "epoch": 33,
      "train_loss": 0.579745188369751,
      "train_acc": 0.97184,
      "lr": 0.002591231629491424
    },
    {
      "epoch": 34,
      "train_loss": 0.5751242451477051,
      "train_acc": 0.97368,
      "lr": 0.0023208660251050166
    },
    {
      "epoch": 35,
      "train_loss": 0.5730921972274781,
      "train_acc": 0.9749,
      "lr": 0.0020610737385376356
    },
    {
      "epoch": 36,
      "train_loss": 0.5675235720062256,
      "train_acc": 0.97592,
      "lr": 0.001812880051256552
    },
    {
      "epoch": 37,
      "train_loss": 0.5636077788352967,
      "train_acc": 0.97818,
      "lr": 0.001577264470356557
    },
    {
      "epoch": 38,
      "train_loss": 0.5619563210487366,
      "train_acc": 0.97864,
      "lr": 0.0013551568628929439
    },
    {
      "epoch": 39,
      "train_loss": 0.5596331472015381,
      "train_acc": 0.97984,
      "lr": 0.0011474337861210548
    },
    {
      "epoch": 40,
      "train_loss": 0.558165431060791,
      "train_acc": 0.98002,
      "lr": 0.0009549150281252636
    },
    {
      "epoch": 41,
      "train_loss": 0.5534387812042236,
      "train_acc": 0.98198,
      "lr": 0.000778360372489926
    },
    {
      "epoch": 42,
      "train_loss": 0.5497236311149597,
      "train_acc": 0.98374,
      "lr": 0.0006184665997806823
    },
    {
      "epoch": 43,
      "train_loss": 0.5496323168373108,
      "train_acc": 0.98342,
      "lr": 0.0004758647376699034
    },
    {
      "epoch": 44,
      "train_loss": 0.5501649566268921,
      "train_acc": 0.9837,
      "lr": 0.0003511175705587434
    },
    {
      "epoch": 45,
      "train_loss": 0.54848744556427,
      "train_acc": 0.98406,
      "lr": 0.00024471741852423245
    },
    {
      "epoch": 46,
      "train_loss": 0.546856548500061,
      "train_acc": 0.98462,
      "lr": 0.00015708419435684522
    },
    {
      "epoch": 47,
      "train_loss": 0.5486547863006592,
      "train_acc": 0.9842,
      "lr": 8.856374635655642e-05
    },
    {
      "epoch": 48,
      "train_loss": 0.545603881816864,
      "train_acc": 0.98526,
      "lr": 3.942649342761119e-05
    },
    {
      "epoch": 49,
      "train_loss": 0.5481936769104004,
      "train_acc": 0.98432,
      "lr": 9.866357858642208e-06
    },
    {
      "epoch": 50,
      "train_loss": 0.5475382207489013,
      "train_acc": 0.98404,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.7007,
    "test_loss": 1.116307307624817
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7387548015918978,
      "ECE": 0.13885335048735142,
      "ARC_area": 0.8168849558134623,
      "AvUC": 0.35164231681596503
    },
    "gradient": {
      "AUROC_error": 0.7750781746533739,
      "ECE": 0.13885335048735142,
      "ARC_area": 0.8635370355587801,
      "AvUC": 0.2989428360804394
    },
    "hybrid": {
      "AUROC_error": 0.7456277911387452,
      "ECE": 0.13885335048735142,
      "ARC_area": 0.8235222874413392,
      "AvUC": 0.32529257642142473
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.742,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.77775,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8108571428571428,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8461666666666666,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8616,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.7311111111111112,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.771625,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8138571428571428,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.851,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8836,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.7418888888888889,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.778,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.811,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8473333333333334,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7007,
      "accuracy_after_rejection": 0.8682,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      NaN,
      0.2452118694782257,
      0.30370956659317017,
      0.3723869025707245,
      0.43781614303588867,
      0.49937912821769714,
      0.56907719373703,
      0.6336124539375305,
      0.6995434165000916,
      0.7677422761917114,
      0.8354951739311218,
      0.9181533455848694,
      0.9386381506919861
    ],
    "bin_acc": [
      NaN,
      NaN,
      NaN,
      0.3333333432674408,
      0.18644067645072937,
      0.2539682686328888,
      0.3199999928474426,
      0.3926553726196289,
      0.3922652006149292,
      0.4122137427330017,
      0.4962025284767151,
      0.4804123640060425,
      0.5742092728614807,
      0.797468364238739,
      0.8540250658988953
    ],
    "bin_count": [
      0,
      0,
      0,
      9,
      59,
      126,
      250,
      354,
      362,
      393,
      395,
      485,
      822,
      3950,
      2795
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1,
        0,
        1,
        17,
        2012,
        2740,
        429,
        269,
        193,
        181,
        187,
        119,
        114,
        132,
        136,
        142,
        71,
        78,
        48,
        54,
        37,
        27,
        7,
        5,
        5,
        2,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        3,
        0,
        1,
        5,
        360,
        405,
        226,
        163,
        150,
        145,
        127,
        133,
        104,
        126,
        174,
        191,
        142,
        117,
        103,
        102,
        79,
        49,
        40,
        22,
        20,
        3,
        2,
        1,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        6598,
        406,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2432,
        549,
        6,
        2,
        1,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        11,
        4617,
        723,
        381,
        322,
        233,
        250,
        209,
        121,
        97,
        31,
        10,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        5,
        709,
        376,
        269,
        243,
        234,
        293,
        320,
        234,
        170,
        93,
        39,
        7,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_efficientnetv2_s_e50_bs64.pth"
}