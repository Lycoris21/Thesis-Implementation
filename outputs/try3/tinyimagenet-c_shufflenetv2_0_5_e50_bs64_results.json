{
  "config": {
    "dataset": "tinyimagenet-c",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.730239907836914,
      "train_acc": 0.04929,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.9985870713043212,
      "train_acc": 0.12871,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.6623518336486818,
      "train_acc": 0.18146,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.443054825897217,
      "train_acc": 0.21702,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.293975795135498,
      "train_acc": 0.24477,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.1706324661254883,
      "train_acc": 0.26674,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.076414133758545,
      "train_acc": 0.28339,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.997754591522217,
      "train_acc": 0.29759,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.931688884124756,
      "train_acc": 0.30924,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.8642197997283936,
      "train_acc": 0.32192,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.814852773513794,
      "train_acc": 0.33275,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.7623624011230468,
      "train_acc": 0.34114,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.706877531280518,
      "train_acc": 0.35139,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.661934051742554,
      "train_acc": 0.36106,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.618292543182373,
      "train_acc": 0.36782,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.579610032119751,
      "train_acc": 0.37568,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.531073196258545,
      "train_acc": 0.38618,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.4894564208221435,
      "train_acc": 0.39281,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.4432851584625244,
      "train_acc": 0.4025,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.3997432049560548,
      "train_acc": 0.41211,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.3611987574768065,
      "train_acc": 0.41909,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.312570127334595,
      "train_acc": 0.42786,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.2714401140594482,
      "train_acc": 0.43626,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.222421873588562,
      "train_acc": 0.44596,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.184050284729004,
      "train_acc": 0.45235,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.1327493816757204,
      "train_acc": 0.46489,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.0881530996704103,
      "train_acc": 0.47243,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.030832780380249,
      "train_acc": 0.48515,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.9882244514465333,
      "train_acc": 0.49468,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.9445405896377563,
      "train_acc": 0.50053,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.8843710622406007,
      "train_acc": 0.51527,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.8309626076507568,
      "train_acc": 0.52672,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.7783047095489501,
      "train_acc": 0.53799,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.7267359196472167,
      "train_acc": 0.54879,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.664299972114563,
      "train_acc": 0.56534,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.6108749110412597,
      "train_acc": 0.57818,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.5503792330932618,
      "train_acc": 0.59205,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.4913529628753661,
      "train_acc": 0.60682,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.4317872640609741,
      "train_acc": 0.62106,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.3701615558624267,
      "train_acc": 0.63753,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.3200821252822876,
      "train_acc": 0.64943,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.2614348230743408,
      "train_acc": 0.66746,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.2144219416809081,
      "train_acc": 0.68,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.173725757484436,
      "train_acc": 0.69084,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.1361473770141601,
      "train_acc": 0.7016,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.0987684087753296,
      "train_acc": 0.71257,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.073851439819336,
      "train_acc": 0.72267,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.0549372817993163,
      "train_acc": 0.72547,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.033112858734131,
      "train_acc": 0.73398,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.0280247142028809,
      "train_acc": 0.73408,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3765,
    "test_loss": 2.895194016265869
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8060316233062936,
      "ECE": 0.15684270633012054,
      "ARC_area": 0.6274832857998718,
      "AvUC": 0.3941501877146702
    },
    "gradient": {
      "AUROC_error": 0.44616612938782163,
      "ECE": 0.15684270633012054,
      "ARC_area": 0.33967991343312165,
      "AvUC": 0.5636798217311269
    },
    "hybrid": {
      "AUROC_error": 0.7630777504789716,
      "ECE": 0.15684270633012054,
      "ARC_area": 0.5926068093832202,
      "AvUC": 0.478915004709363
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.40955555555555556,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.444625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.48114285714285715,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5265,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5814,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.365,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3595,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.35528571428571426,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3458333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.336,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4026666666666667,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4335,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4664285714285714,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5063333333333333,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5534,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\tinyimagenet-c_shufflenetv2_0_5_e50_bs64.pth"
}