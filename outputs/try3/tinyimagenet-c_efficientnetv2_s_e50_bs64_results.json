{
  "config": {
    "dataset": "tinyimagenet-c",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.9781797930908205,
      "train_acc": 0.02543,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.615858025817871,
      "train_acc": 0.05982,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.30553055557251,
      "train_acc": 0.09805,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 4.100904359588623,
      "train_acc": 0.12775,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 4.301017945556641,
      "train_acc": 0.10357,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.891716572265625,
      "train_acc": 0.15847,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.7953371588134766,
      "train_acc": 0.17319,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.581837329711914,
      "train_acc": 0.20687,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.610428745727539,
      "train_acc": 0.20207,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.4596080630493162,
      "train_acc": 0.22757,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.3415929730224607,
      "train_acc": 0.24623,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.1842614677429197,
      "train_acc": 0.27112,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.0984392014312743,
      "train_acc": 0.28653,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.0377274321746826,
      "train_acc": 0.29721,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.894909394683838,
      "train_acc": 0.32377,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.834407170944214,
      "train_acc": 0.33542,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.7471202062225344,
      "train_acc": 0.35197,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.675204507522583,
      "train_acc": 0.36336,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.591442456817627,
      "train_acc": 0.38016,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.522949443893433,
      "train_acc": 0.39265,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.4492093601989744,
      "train_acc": 0.40727,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.375980569076538,
      "train_acc": 0.42054,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.3057405168151854,
      "train_acc": 0.43455,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.2293303481292726,
      "train_acc": 0.44968,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.1515719997406006,
      "train_acc": 0.46594,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.0788270641326902,
      "train_acc": 0.48009,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.9944543200683593,
      "train_acc": 0.49562,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.906926194381714,
      "train_acc": 0.51447,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.8199232810974122,
      "train_acc": 0.5341,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.7337926665496826,
      "train_acc": 0.55125,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.6390660955047607,
      "train_acc": 0.57122,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.5442649214935302,
      "train_acc": 0.5913,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.436362900390625,
      "train_acc": 0.6162,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.3387235905456543,
      "train_acc": 0.63864,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.2286670017242431,
      "train_acc": 0.66521,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.1210946211242676,
      "train_acc": 0.69172,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.0107159407043458,
      "train_acc": 0.71958,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9074268947792054,
      "train_acc": 0.74695,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.8013719045448303,
      "train_acc": 0.77496,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7008504130744934,
      "train_acc": 0.80314,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.6000928503990174,
      "train_acc": 0.83211,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.519991876859665,
      "train_acc": 0.85647,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.4493696487236023,
      "train_acc": 0.87807,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.39390403186798095,
      "train_acc": 0.89445,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.3507270828294754,
      "train_acc": 0.90932,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.31128682320594786,
      "train_acc": 0.92206,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.28908507450580595,
      "train_acc": 0.92896,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.27287613213062284,
      "train_acc": 0.93459,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.2614868498086929,
      "train_acc": 0.93819,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.2567594670152664,
      "train_acc": 0.93969,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3435,
    "test_loss": 3.8896714309692384
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8011642171943094,
      "ECE": 0.3054567043885589,
      "ARC_area": 0.5852342509733759,
      "AvUC": 0.4500490027854301
    },
    "gradient": {
      "AUROC_error": 0.4424749925446021,
      "ECE": 0.3054567043885589,
      "ARC_area": 0.3087937108852092,
      "AvUC": 0.5939581343790371
    },
    "hybrid": {
      "AUROC_error": 0.7540343070249249,
      "ECE": 0.3054567043885589,
      "ARC_area": 0.53940210933431,
      "AvUC": 0.5220035686332732
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.373,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.40425,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.44485714285714284,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.4895,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.5362,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.3303333333333333,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.322375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.31485714285714284,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.31183333333333335,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.3098,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.36922222222222223,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.400375,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.4347142857142857,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.4698333333333333,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3435,
      "accuracy_after_rejection": 0.5128,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\tinyimagenet-c_efficientnetv2_s_e50_bs64.pth"
}