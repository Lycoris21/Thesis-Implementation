{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.66416278175354,
      "train_acc": 0.05247,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.9852968228912355,
      "train_acc": 0.12867,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.678619225845337,
      "train_acc": 0.17682,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.4898984792327883,
      "train_acc": 0.20945,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.354300179519653,
      "train_acc": 0.23115,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.2504974476623536,
      "train_acc": 0.25043,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.1531137298583984,
      "train_acc": 0.27012,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.0811607778930665,
      "train_acc": 0.27901,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.016709405670166,
      "train_acc": 0.29254,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.956035394592285,
      "train_acc": 0.30481,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.9065431748962403,
      "train_acc": 0.3141,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.8549879016876223,
      "train_acc": 0.32331,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.8025091830444335,
      "train_acc": 0.33234,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.760386121520996,
      "train_acc": 0.3405,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.7123891275787355,
      "train_acc": 0.35046,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.668240262832642,
      "train_acc": 0.35801,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.6262271557617187,
      "train_acc": 0.36706,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.582135674133301,
      "train_acc": 0.37439,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.539876701660156,
      "train_acc": 0.38317,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.498404757232666,
      "train_acc": 0.39178,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.4639970920562746,
      "train_acc": 0.39848,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.4182662655639646,
      "train_acc": 0.40613,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.3795752306365965,
      "train_acc": 0.41477,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.330001298828125,
      "train_acc": 0.42396,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.278661696243286,
      "train_acc": 0.43425,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.2355476171875,
      "train_acc": 0.44255,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.183095879974365,
      "train_acc": 0.45377,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.13038827835083,
      "train_acc": 0.46425,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.077811444129944,
      "train_acc": 0.47396,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.023292677345276,
      "train_acc": 0.48546,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.969112820892334,
      "train_acc": 0.49723,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.9100862763977051,
      "train_acc": 0.50955,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.8502111348724366,
      "train_acc": 0.52128,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.7860673915100098,
      "train_acc": 0.53617,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.723724974899292,
      "train_acc": 0.54945,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.661716677093506,
      "train_acc": 0.56274,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.590960676612854,
      "train_acc": 0.57852,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.5268231908798218,
      "train_acc": 0.59287,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.4620283406829835,
      "train_acc": 0.60656,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.3922701193237306,
      "train_acc": 0.62218,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.334191298980713,
      "train_acc": 0.63889,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.2708493353271484,
      "train_acc": 0.65389,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.208175841217041,
      "train_acc": 0.66769,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.1550394851684571,
      "train_acc": 0.68309,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.1142793188095093,
      "train_acc": 0.69374,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.0677730034637452,
      "train_acc": 0.70537,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.034582629776001,
      "train_acc": 0.71366,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.0104832690429688,
      "train_acc": 0.72021,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.9930946309280395,
      "train_acc": 0.72421,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.9792247889709472,
      "train_acc": 0.7299,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.4014,
    "test_loss": 2.9175116359710693
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8052847442904063,
      "ECE": 0.1916449978455901,
      "ARC_area": 0.6522711927444496,
      "AvUC": 0.40339771055332013
    },
    "gradient": {
      "AUROC_error": 0.37883106171500314,
      "ECE": 0.1916449978455901,
      "ARC_area": 0.31553115910317164,
      "AvUC": 0.570762167917844
    },
    "hybrid": {
      "AUROC_error": 0.7622004074945841,
      "ECE": 0.1916449978455901,
      "ARC_area": 0.6117137511599708,
      "AvUC": 0.48707993924729526
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.43366666666666664,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.469625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.5137142857142857,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.5605,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.6174,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.38022222222222224,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.363375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.34314285714285714,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.3318333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.3186,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.4291111111111111,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.462875,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.5001428571428571,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.5428333333333333,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4014,
      "accuracy_after_rejection": 0.5888,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\tinyimagenet_mobilenetv3_small_e50_bs64.pth"
}