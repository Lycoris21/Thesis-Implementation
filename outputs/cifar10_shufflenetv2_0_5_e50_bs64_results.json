{
  "config": {
    "dataset": "cifar10",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 2.0140482641220094,
      "train_acc": 0.29474,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.6742553880691529,
      "train_acc": 0.47382,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.5140114442062378,
      "train_acc": 0.54916,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.4164463100433349,
      "train_acc": 0.5966,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3519223665618896,
      "train_acc": 0.62346,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.2934019747924805,
      "train_acc": 0.64842,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.259602206363678,
      "train_acc": 0.66152,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.2292044142913818,
      "train_acc": 0.67762,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.2007728309631347,
      "train_acc": 0.68896,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1760311317443848,
      "train_acc": 0.69774,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1532797229766845,
      "train_acc": 0.70888,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1392925672149659,
      "train_acc": 0.71592,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.1271601264190674,
      "train_acc": 0.72076,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.1122320977783202,
      "train_acc": 0.728,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0931025028991699,
      "train_acc": 0.73808,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.0827471321487427,
      "train_acc": 0.74106,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0674523536682128,
      "train_acc": 0.74838,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0518134678268432,
      "train_acc": 0.75468,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.0426606935119629,
      "train_acc": 0.76034,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.0231924658203124,
      "train_acc": 0.76742,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0102628820037842,
      "train_acc": 0.77338,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.9977227262115479,
      "train_acc": 0.77914,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.9844766499710083,
      "train_acc": 0.78586,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.9704368399429322,
      "train_acc": 0.79284,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.9559638809585571,
      "train_acc": 0.79984,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.9387195952606201,
      "train_acc": 0.80624,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.9286259239768982,
      "train_acc": 0.81204,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.9119218274307251,
      "train_acc": 0.8204,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.8948202099609375,
      "train_acc": 0.82688,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.878502333984375,
      "train_acc": 0.83472,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.8626074269866943,
      "train_acc": 0.84226,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.8437545039367675,
      "train_acc": 0.852,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.8253987010192871,
      "train_acc": 0.86064,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.8091146515274048,
      "train_acc": 0.86618,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.7939050863647461,
      "train_acc": 0.87546,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.772857833442688,
      "train_acc": 0.88466,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.7566324966239929,
      "train_acc": 0.89136,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.74124158203125,
      "train_acc": 0.90012,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.7245176613616944,
      "train_acc": 0.9077,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7119551456832885,
      "train_acc": 0.91352,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.6992121756744385,
      "train_acc": 0.91886,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.685313988494873,
      "train_acc": 0.9262,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.6747159285736084,
      "train_acc": 0.93078,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.6663139790344238,
      "train_acc": 0.93506,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.657881178894043,
      "train_acc": 0.93946,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.6517420883560181,
      "train_acc": 0.94282,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.6459173570632935,
      "train_acc": 0.94498,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.6427694841384888,
      "train_acc": 0.94626,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.6401025423049926,
      "train_acc": 0.94724,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.6390399436569214,
      "train_acc": 0.94802,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.7219,
    "test_loss": 0.9772142937660218
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7557971968474457,
      "ECE": 0.08576544007956981,
      "ARC_area": 0.8391386723487778,
      "AvUC": 0.35574416202493014
    },
    "gradient": {
      "AUROC_error": 0.7988248080211442,
      "ECE": 0.08576544007956981,
      "ARC_area": 0.8881648051001565,
      "AvUC": 0.2847658125663525
    },
    "hybrid": {
      "AUROC_error": 0.7861938054613262,
      "ECE": 0.08576544007956981,
      "ARC_area": 0.8659118811326726,
      "AvUC": 0.3202549873545766
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.7647777777777778,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.8065,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.8418571428571429,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.865,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.881,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.7588888888888888,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.797875,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.8398571428571429,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.8826666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.912,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.7632222222222222,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.809125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.846,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.8785,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7219,
      "accuracy_after_rejection": 0.902,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      NaN,
      0.24752268195152283,
      0.30605778098106384,
      0.36876001954078674,
      0.43657100200653076,
      0.49764546751976013,
      0.5659382939338684,
      0.6337301135063171,
      0.7005010843276978,
      0.7689332365989685,
      0.8377638459205627,
      0.9069535732269287,
      0.9436981081962585
    ],
    "bin_acc": [
      NaN,
      NaN,
      NaN,
      0.10526315867900848,
      0.20618556439876556,
      0.3469387888908386,
      0.3667621910572052,
      0.3720930218696594,
      0.3978779911994934,
      0.4376417100429535,
      0.49898579716682434,
      0.5917065143585205,
      0.6877912282943726,
      0.8742914795875549,
      0.8601252436637878
    ],
    "bin_count": [
      0,
      0,
      0,
      19,
      97,
      196,
      349,
      430,
      377,
      441,
      493,
      627,
      1073,
      4940,
      958
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        1,
        25,
        149,
        608,
        1455,
        1666,
        940,
        501,
        325,
        231,
        221,
        189,
        166,
        146,
        115,
        115,
        94,
        73,
        67,
        51,
        41,
        26,
        9,
        5,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        7,
        45,
        88,
        182,
        207,
        168,
        155,
        140,
        119,
        144,
        164,
        153,
        170,
        172,
        149,
        152,
        138,
        122,
        94,
        90,
        52,
        37,
        20,
        13,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3221,
        1661,
        675,
        460,
        410,
        262,
        209,
        122,
        93,
        40,
        32,
        8,
        14,
        3,
        7,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        191,
        354,
        320,
        409,
        391,
        341,
        270,
        182,
        113,
        84,
        64,
        21,
        19,
        7,
        6,
        3,
        3,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        12,
        944,
        2818,
        1167,
        525,
        329,
        287,
        250,
        225,
        189,
        143,
        151,
        89,
        60,
        17,
        9,
        2,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        2,
        88,
        289,
        235,
        201,
        189,
        192,
        224,
        200,
        279,
        274,
        236,
        155,
        111,
        60,
        34,
        7,
        3,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_shufflenetv2_0_5_e50_bs64.pth"
}