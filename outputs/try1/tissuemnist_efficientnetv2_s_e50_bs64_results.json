{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.7745704302283987,
      "train_acc": 0.34826490034206425,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.4901181475809817,
      "train_acc": 0.4535554131966688,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.4177828793059826,
      "train_acc": 0.4772521243034823,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.413944606016872,
      "train_acc": 0.4770224698729648,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3544531823005725,
      "train_acc": 0.4961079617564938,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.3543582466566124,
      "train_acc": 0.4962348760470429,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.3043894381904853,
      "train_acc": 0.5153687162317334,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.3086942855901402,
      "train_acc": 0.5101954480074457,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.3869966693948281,
      "train_acc": 0.4841054959931345,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.2756670737444347,
      "train_acc": 0.521490819866317,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.301604763956312,
      "train_acc": 0.510116882018058,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.2038994333536648,
      "train_acc": 0.5472967256113038,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.148086730102744,
      "train_acc": 0.5710538720945693,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.1075518499937052,
      "train_acc": 0.5888158292338003,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.07245428225889,
      "train_acc": 0.6035983223139497,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.0478851451270104,
      "train_acc": 0.6145371254517544,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.027448907087313,
      "train_acc": 0.6229739040044481,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.009891579186974,
      "train_acc": 0.6309151124702356,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 0.9936557630190452,
      "train_acc": 0.6352906337253574,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 0.9785719180218642,
      "train_acc": 0.6411286910906168,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 0.9667790214690893,
      "train_acc": 0.645697605550385,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.9520967378073174,
      "train_acc": 0.6513543567862884,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.9415863248795091,
      "train_acc": 0.6559172277084114,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.9279411602587687,
      "train_acc": 0.6612778455997003,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.916787293400726,
      "train_acc": 0.6652061450690776,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.9047463718124653,
      "train_acc": 0.6704156745192366,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.8952084350324848,
      "train_acc": 0.6726638705232495,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.8821277084500209,
      "train_acc": 0.6778069210593113,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.8705039856597641,
      "train_acc": 0.6842372451137998,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.8589869099526252,
      "train_acc": 0.6872469268611074,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.8486054720058503,
      "train_acc": 0.6908488752976443,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.8342715708510005,
      "train_acc": 0.6979379449554591,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.822920442085706,
      "train_acc": 0.7000048348301161,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.8084276286749631,
      "train_acc": 0.7057824568189235,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.7951871860351946,
      "train_acc": 0.7111853794737287,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.7795139479557609,
      "train_acc": 0.7173377007965382,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.7645895382300474,
      "train_acc": 0.721985181245694,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.7467161191082838,
      "train_acc": 0.7281918944073102,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.7279788575857655,
      "train_acc": 0.73527492052748,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7087146383561332,
      "train_acc": 0.7431013017780088,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.689462946565659,
      "train_acc": 0.7507403333615366,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.66771016497358,
      "train_acc": 0.7589414139460675,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.645494186024332,
      "train_acc": 0.767777065983344,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.6209248497813975,
      "train_acc": 0.7765825003323946,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.5967599591124678,
      "train_acc": 0.7854967183590587,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.5762109254736842,
      "train_acc": 0.7937219730941704,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.5551056122318184,
      "train_acc": 0.8017296604740551,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.5367769074137704,
      "train_acc": 0.8093989097458089,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.5224443515185992,
      "train_acc": 0.8148380936264852,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.5155267122073304,
      "train_acc": 0.817454945426855,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6469754653130287,
    "test_loss": 1.1044894193433061
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7552717133805199,
      "ECE": 0.12888537580572865,
      "ARC_area": 0.8212837108597486,
      "AvUC": 0.35218587066141044
    },
    "gradient": {
      "AUROC_error": 0.5446535938793867,
      "ECE": 0.12888537580572865,
      "ARC_area": 0.6805229787419154,
      "AvUC": 0.42143886111508866
    },
    "hybrid": {
      "AUROC_error": 0.7432309777739212,
      "ECE": 0.12888537580572865,
      "ARC_area": 0.812993915786604,
      "AvUC": 0.38681236587014906
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6825061101710848,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7148900169204738,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7492144065748126,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7856739988719684,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.8239424703891709,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6507802218462116,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6555097292724196,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6614696640077351,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6695572476029329,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.67834179357022,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.6801560443692424,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7119818104906938,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7457698815566836,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.7783770445572477,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6469754653130287,
      "accuracy_after_rejection": 0.8150169204737733,
      "kept_count": 23640
    }
  ],
  "checkpoint_path": "./outputs\\tissuemnist_efficientnetv2_s_e50_bs64.pth"
}