{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 5.03208908782959,
      "train_acc": 0.02205,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.730707559814453,
      "train_acc": 0.04748,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.459536330871582,
      "train_acc": 0.07933,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 4.307629100189209,
      "train_acc": 0.10033,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 4.28231673828125,
      "train_acc": 0.1043,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 4.026264385375977,
      "train_acc": 0.13931,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 4.025262772827149,
      "train_acc": 0.14119,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.925375182800293,
      "train_acc": 0.15493,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.8650822715759277,
      "train_acc": 0.16604,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.6938817835235596,
      "train_acc": 0.19094,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.611606503829956,
      "train_acc": 0.20474,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.494818282318115,
      "train_acc": 0.22365,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.4209320973205566,
      "train_acc": 0.23484,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.2900457231140137,
      "train_acc": 0.2553,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.174888189468384,
      "train_acc": 0.27511,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.081516039581299,
      "train_acc": 0.29143,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.9781517721557615,
      "train_acc": 0.31139,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.8902484473419188,
      "train_acc": 0.32514,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.8066539923095704,
      "train_acc": 0.34178,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.723527397994995,
      "train_acc": 0.35629,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.64876285697937,
      "train_acc": 0.36944,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.57156532371521,
      "train_acc": 0.3849,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.4946839405059813,
      "train_acc": 0.4013,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.4206166862487795,
      "train_acc": 0.41407,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.342840707092285,
      "train_acc": 0.42667,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.267229547576904,
      "train_acc": 0.44203,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.187997508850098,
      "train_acc": 0.45717,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.107654970855713,
      "train_acc": 0.47289,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.0283197799682617,
      "train_acc": 0.4908,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.9424248918151856,
      "train_acc": 0.5094,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.8559270678710937,
      "train_acc": 0.52546,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.7672624921417237,
      "train_acc": 0.54452,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.6725306206512451,
      "train_acc": 0.56582,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.576843610610962,
      "train_acc": 0.58619,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.4833561862182618,
      "train_acc": 0.60907,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.3797523991012572,
      "train_acc": 0.63378,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.2837139963531494,
      "train_acc": 0.65388,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.171766556930542,
      "train_acc": 0.68274,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.0768726912689208,
      "train_acc": 0.70634,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9694403266906738,
      "train_acc": 0.73508,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.880209178237915,
      "train_acc": 0.75811,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.789012551612854,
      "train_acc": 0.78432,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.7093801684379578,
      "train_acc": 0.80662,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.6376751730537414,
      "train_acc": 0.82849,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.5759927640914917,
      "train_acc": 0.84633,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.5319350966548919,
      "train_acc": 0.86014,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.49826984780311584,
      "train_acc": 0.86972,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.46796503957748414,
      "train_acc": 0.87989,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.45261785329818727,
      "train_acc": 0.88413,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.4444932131004333,
      "train_acc": 0.88846,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.0045,
    "test_loss": 14.57273507385254
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.6442368435738601,
      "ECE": 0.5936738999955355,
      "ARC_area": 0.006921820268365473,
      "AvUC": 0.6332865617055191
    },
    "gradient": {
      "AUROC_error": 0.6627512696020984,
      "ECE": 0.5936738999955355,
      "ARC_area": 0.006722639741148297,
      "AvUC": 0.7004543594357557
    },
    "hybrid": {
      "AUROC_error": 0.6983693286455718,
      "ECE": 0.5936738999955355,
      "ARC_area": 0.008662219284511555,
      "AvUC": 0.6668704606290907
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.004666666666666667,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005125,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005571428571428572,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005666666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.0064,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.0047777777777777775,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.0054285714285714284,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.006166666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.0072,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.004888888888888889,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.005571428571428572,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.006,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.0045,
      "accuracy_after_rejection": 0.0068,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\tinyimagenet_efficientnetv2_s_e50_bs64.pth"
}