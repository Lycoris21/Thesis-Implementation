{
  "config": {
    "dataset": "cifar100-c",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [],
  "baseline": {
    "test_acc": 0.32236315789473685,
    "test_loss": 2.8730885762867175
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7617715984744577,
      "ECE": 0.0952499944531604,
      "ARC_area": 0.52982867807206,
      "AvUC": 0.41229352127650176
    },
    "gradient": {
      "AUROC_error": 0.5366299477466189,
      "ECE": 0.0952499944531604,
      "ARC_area": 0.3685648422634772,
      "AvUC": 0.5771883533953885
    },
    "hybrid": {
      "AUROC_error": 0.7347242378754308,
      "ECE": 0.0952499944531604,
      "ARC_area": 0.5145046388570845,
      "AvUC": 0.49474093731669216
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.3476783625730994,
      "kept_count": 171000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.3753157894736842,
      "kept_count": 152000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.40577443609022557,
      "kept_count": 133000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.4417456140350877,
      "kept_count": 114000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.48406315789473686,
      "kept_count": 95000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.32153216374269006,
      "kept_count": 171000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.32411842105263156,
      "kept_count": 152000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.32785714285714285,
      "kept_count": 133000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.33378070175438596,
      "kept_count": 114000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.34266315789473684,
      "kept_count": 95000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.34156140350877195,
      "kept_count": 171000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.36501973684210526,
      "kept_count": 152000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.3932706766917293,
      "kept_count": 133000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.42733333333333334,
      "kept_count": 114000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.32236315789473685,
      "accuracy_after_rejection": 0.4680526315789474,
      "kept_count": 95000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.06130613386631012,
      0.11041136831045151,
      0.16772900521755219,
      0.2326374351978302,
      0.29908981919288635,
      0.36549603939056396,
      0.43253397941589355,
      0.49865099787712097,
      0.565388560295105,
      0.6325714588165283,
      0.6993660926818848,
      0.7663137316703796,
      0.8333210349082947,
      0.9004130363464355,
      0.9626245498657227
    ],
    "bin_acc": [
      0.060975611209869385,
      0.07640887051820755,
      0.11830254644155502,
      0.16033333539962769,
      0.20965725183486938,
      0.26241061091423035,
      0.31203126907348633,
      0.3607952296733856,
      0.4215555191040039,
      0.4793083667755127,
      0.5543422698974609,
      0.6376770734786987,
      0.7027262449264526,
      0.8118712306022644,
      0.9044259190559387
    ],
    "bin_count": [
      164,
      11818,
      26204,
      27000,
      23195,
      19016,
      15601,
      12927,
      10466,
      8675,
      7784,
      7060,
      6896,
      6958,
      6236
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1151,
        2156,
        2596,
        2694,
        2700,
        2710,
        2852,
        2907,
        3092,
        3065,
        3081,
        3174,
        3146,
        3102,
        3079,
        3006,
        2833,
        2868,
        2634,
        2511,
        2052,
        1674,
        1179,
        650,
        267,
        64,
        6,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        67,
        233,
        394,
        561,
        810,
        1173,
        1492,
        1892,
        2318,
        3009,
        3626,
        4330,
        4890,
        5647,
        6545,
        7679,
        8681,
        9702,
        10916,
        11546,
        11821,
        11335,
        9215,
        6578,
        3173,
        1003,
        113,
        2,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        70,
        718,
        2266,
        3851,
        5482,
        6692,
        7544,
        7513,
        6884,
        5811,
        4549,
        3331,
        2354,
        1548,
        1036,
        593,
        429,
        240,
        130,
        81,
        43,
        36,
        22,
        8,
        9,
        3,
        6,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        46,
        492,
        1819,
        5008,
        9576,
        14221,
        17277,
        17965,
        16838,
        13833,
        10548,
        7748,
        5178,
        3354,
        2069,
        1252,
        715,
        378,
        193,
        107,
        46,
        33,
        20,
        18,
        11,
        4,
        0,
        1,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        14,
        292,
        1220,
        2337,
        3484,
        4269,
        4826,
        5266,
        5232,
        5471,
        5324,
        5295,
        5118,
        4565,
        3691,
        2430,
        1392,
        621,
        263,
        98,
        30,
        8,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        18,
        110,
        332,
        782,
        1522,
        2664,
        4073,
        5591,
        7620,
        9948,
        13555,
        16885,
        19441,
        18595,
        13715,
        7932,
        3791,
        1468,
        525,
        139,
        34,
        9,
        2,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100-c_mobilenetv3_small_e50_bs64.pth"
}