{
  "config": {
    "dataset": "cifar100",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.146646061096192,
      "train_acc": 0.06986,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.7135530078125,
      "train_acc": 0.15236,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.4909406619262695,
      "train_acc": 0.20288,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.33215651473999,
      "train_acc": 0.24322,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.203447063217163,
      "train_acc": 0.27504,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.113563892059326,
      "train_acc": 0.29332,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.0297541537475587,
      "train_acc": 0.31948,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.9646941175842283,
      "train_acc": 0.33444,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.902552066116333,
      "train_acc": 0.35026,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.849492844467163,
      "train_acc": 0.36458,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.7981949685668943,
      "train_acc": 0.37878,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.756387911682129,
      "train_acc": 0.38982,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.7129803953552245,
      "train_acc": 0.40324,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.6737178215789794,
      "train_acc": 0.41416,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.63970195602417,
      "train_acc": 0.4233,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.6017278950500486,
      "train_acc": 0.43554,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.5691751150512694,
      "train_acc": 0.44294,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.537088211517334,
      "train_acc": 0.45244,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.5019330857849122,
      "train_acc": 0.46136,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.471462082824707,
      "train_acc": 0.4711,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.445448151626587,
      "train_acc": 0.4785,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.4129589514923095,
      "train_acc": 0.48938,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.382822586517334,
      "train_acc": 0.49558,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.3530647326660157,
      "train_acc": 0.50628,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.322042042388916,
      "train_acc": 0.5158,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.297113544921875,
      "train_acc": 0.52404,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.260993266906738,
      "train_acc": 0.53718,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.2311611950683594,
      "train_acc": 0.54456,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.1949761225891113,
      "train_acc": 0.55772,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.167122933883667,
      "train_acc": 0.56318,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.1364074084472655,
      "train_acc": 0.57536,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.1106589465332033,
      "train_acc": 0.58596,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.07667161239624,
      "train_acc": 0.59474,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.0493270222473146,
      "train_acc": 0.6016,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 2.0201902024841307,
      "train_acc": 0.61424,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.993592651901245,
      "train_acc": 0.62452,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.9632800719451904,
      "train_acc": 0.63782,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.937149955368042,
      "train_acc": 0.64516,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.9101543490600585,
      "train_acc": 0.65276,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.8913932922363281,
      "train_acc": 0.66102,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.866754387817383,
      "train_acc": 0.67104,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.842963765182495,
      "train_acc": 0.68104,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.8254354498291017,
      "train_acc": 0.68492,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.8096920162200927,
      "train_acc": 0.69238,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.7990144791412352,
      "train_acc": 0.69544,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.7829323302459716,
      "train_acc": 0.70462,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.7726813718414307,
      "train_acc": 0.70528,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.7620627670288085,
      "train_acc": 0.7131,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.757192559890747,
      "train_acc": 0.71302,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.759083111038208,
      "train_acc": 0.7131,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.43,
    "test_loss": 2.318538468551636
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.777353488372093,
      "ECE": 0.04657407312318683,
      "ARC_area": 0.6563843427858884,
      "AvUC": 0.4050543163070455
    },
    "gradient": {
      "AUROC_error": 0.5310983068135454,
      "ECE": 0.04657407312318683,
      "ARC_area": 0.47560737800485403,
      "AvUC": 0.5316607991198893
    },
    "hybrid": {
      "AUROC_error": 0.7491812117503059,
      "ECE": 0.04657407312318683,
      "ARC_area": 0.6395628077022302,
      "AvUC": 0.46835755769032983
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.4633333333333333,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.4975,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.537,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.5783333333333334,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.6292,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.4281111111111111,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.429625,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.43314285714285716,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.44083333333333335,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.4486,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.4563333333333333,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.485625,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.5214285714285715,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.5643333333333334,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.43,
      "accuracy_after_rejection": 0.6126,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.0601465180516243,
      0.11141638457775116,
      0.16864468157291412,
      0.23262272775173187,
      0.2994737923145294,
      0.36503124237060547,
      0.43245112895965576,
      0.4982377588748932,
      0.5652751922607422,
      0.63246089220047,
      0.6997795104980469,
      0.767805278301239,
      0.8336299657821655,
      0.9002348184585571,
      0.9644295573234558
    ],
    "bin_acc": [
      0.0,
      0.08376963436603546,
      0.14388489723205566,
      0.1944209635257721,
      0.2594936788082123,
      0.3329969644546509,
      0.3848167657852173,
      0.4197348952293396,
      0.4860627055168152,
      0.5633803009986877,
      0.6007905006408691,
      0.7173447608947754,
      0.790224015712738,
      0.8664383292198181,
      0.9353741407394409
    ],
    "bin_count": [
      5,
      382,
      1112,
      1183,
      1106,
      991,
      764,
      679,
      574,
      568,
      506,
      467,
      491,
      584,
      588
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        124,
        222,
        224,
        243,
        237,
        238,
        228,
        233,
        239,
        218,
        225,
        205,
        191,
        200,
        199,
        169,
        177,
        154,
        150,
        125,
        120,
        90,
        54,
        25,
        7,
        3,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        7,
        16,
        18,
        35,
        52,
        73,
        83,
        126,
        123,
        177,
        199,
        227,
        264,
        283,
        299,
        366,
        378,
        440,
        473,
        484,
        490,
        433,
        336,
        202,
        78,
        37,
        1,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        23,
        142,
        244,
        347,
        435,
        504,
        556,
        496,
        446,
        337,
        256,
        159,
        117,
        87,
        69,
        35,
        15,
        8,
        10,
        8,
        3,
        0,
        1,
        0,
        0,
        1,
        0,
        0,
        0,
        1
      ],
      "incorrect_counts": [
        12,
        70,
        186,
        376,
        546,
        746,
        838,
        778,
        650,
        482,
        344,
        266,
        163,
        116,
        46,
        39,
        14,
        14,
        7,
        3,
        2,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3,
        57,
        151,
        239,
        342,
        395,
        382,
        389,
        391,
        342,
        375,
        312,
        295,
        256,
        196,
        90,
        45,
        23,
        11,
        3,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        3,
        8,
        33,
        59,
        109,
        174,
        254,
        329,
        432,
        538,
        654,
        838,
        862,
        684,
        412,
        191,
        84,
        19,
        13,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_mobilenetv3_small_e50_bs64.pth"
}