{
  "config": {
    "dataset": "cifar100",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.042611289596557,
      "train_acc": 0.06742,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.56107755569458,
      "train_acc": 0.1433,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.459268077850342,
      "train_acc": 0.16248,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.3073512655639647,
      "train_acc": 0.19434,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.6782060861206056,
      "train_acc": 0.13764,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.8161811357116697,
      "train_acc": 0.11072,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.721414797515869,
      "train_acc": 0.12534,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.6076839002990724,
      "train_acc": 0.14198,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.504404438781738,
      "train_acc": 0.15902,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.4255620246887206,
      "train_acc": 0.1739,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.3504297438812256,
      "train_acc": 0.1887,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.3720745473480225,
      "train_acc": 0.18376,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.264830657043457,
      "train_acc": 0.2015,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.2220712956237794,
      "train_acc": 0.21026,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.1597630055999755,
      "train_acc": 0.22286,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.0891806359863283,
      "train_acc": 0.23456,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 3.0220204598999025,
      "train_acc": 0.248,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.9396459545898437,
      "train_acc": 0.26108,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.8703917684173583,
      "train_acc": 0.27696,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.8089572787475587,
      "train_acc": 0.28814,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.757216705780029,
      "train_acc": 0.30144,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.70750230178833,
      "train_acc": 0.30854,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.6516603354644777,
      "train_acc": 0.32018,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.6088337369537355,
      "train_acc": 0.32984,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.5517617879486085,
      "train_acc": 0.34092,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.5011722833251953,
      "train_acc": 0.35188,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.482524951629639,
      "train_acc": 0.35378,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.4142126860046385,
      "train_acc": 0.368,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.3570172680664063,
      "train_acc": 0.38066,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.3148523739624025,
      "train_acc": 0.38962,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.2724608907318116,
      "train_acc": 0.3997,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.22711469329834,
      "train_acc": 0.40862,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.1792374224853517,
      "train_acc": 0.41752,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.133252820892334,
      "train_acc": 0.4272,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 2.088787829208374,
      "train_acc": 0.43876,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 2.0415803688812257,
      "train_acc": 0.45064,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.991224222946167,
      "train_acc": 0.45904,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.9437435753631591,
      "train_acc": 0.46808,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.8997883911514282,
      "train_acc": 0.47934,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.863452576828003,
      "train_acc": 0.48896,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.8124886944580079,
      "train_acc": 0.50038,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.766985537109375,
      "train_acc": 0.50942,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.7302658666992188,
      "train_acc": 0.52078,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.6909514405059813,
      "train_acc": 0.52982,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.658462911338806,
      "train_acc": 0.5387,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.6300685918045044,
      "train_acc": 0.54558,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.60726123336792,
      "train_acc": 0.55164,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.582648221511841,
      "train_acc": 0.55318,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.5715253895568848,
      "train_acc": 0.55806,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.5636349882888794,
      "train_acc": 0.56378,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3817,
    "test_loss": 2.570144652938843
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7833366828370792,
      "ECE": 0.10704217561036347,
      "ARC_area": 0.6171041706225364,
      "AvUC": 0.4271683948795184
    },
    "gradient": {
      "AUROC_error": 0.39871107028148667,
      "ECE": 0.10704217561036347,
      "ARC_area": 0.3143088512441413,
      "AvUC": 0.5904240455336404
    },
    "hybrid": {
      "AUROC_error": 0.7441239301979521,
      "ECE": 0.10704217561036347,
      "ARC_area": 0.5861856320085232,
      "AvUC": 0.5087962201103569
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.4118888888888889,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.4445,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.48,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.5206666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.5694,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.3601111111111111,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.347,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.334,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.32316666666666666,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.3172,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.4062222222222222,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.435125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.4672857142857143,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.5035,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3817,
      "accuracy_after_rejection": 0.5478,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.06324723362922668,
      0.11366480588912964,
      0.16879862546920776,
      0.2330847829580307,
      0.29856911301612854,
      0.36559027433395386,
      0.4329436719417572,
      0.4990815818309784,
      0.56537264585495,
      0.6338024139404297,
      0.6994293928146362,
      0.7670962810516357,
      0.8343226313591003,
      0.9016126990318298,
      0.9770195484161377
    ],
    "bin_acc": [
      0.0,
      0.06737588346004486,
      0.1100529134273529,
      0.16373801231384277,
      0.20088888704776764,
      0.300595223903656,
      0.28896471858024597,
      0.33243241906166077,
      0.3916666805744171,
      0.4457593560218811,
      0.5734597444534302,
      0.6477987170219421,
      0.6690140962600708,
      0.745843231678009,
      0.9288840293884277
    ],
    "bin_count": [
      2,
      282,
      945,
      1252,
      1125,
      1008,
      879,
      740,
      600,
      507,
      422,
      477,
      426,
      421,
      914
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        531,
        241,
        213,
        195,
        211,
        196,
        226,
        233,
        192,
        213,
        180,
        139,
        160,
        148,
        142,
        134,
        123,
        107,
        87,
        69,
        43,
        19,
        11,
        4,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        17,
        32,
        59,
        65,
        99,
        138,
        177,
        217,
        233,
        267,
        293,
        345,
        361,
        427,
        423,
        461,
        467,
        472,
        490,
        437,
        315,
        228,
        102,
        50,
        4,
        4,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        11,
        92,
        317,
        456,
        571,
        531,
        452,
        378,
        284,
        214,
        142,
        102,
        63,
        71,
        33,
        33,
        17,
        21,
        8,
        7,
        6,
        1,
        1,
        2,
        0,
        1,
        0,
        0,
        1,
        2
      ],
      "incorrect_counts": [
        33,
        287,
        751,
        1036,
        1085,
        910,
        672,
        488,
        337,
        223,
        119,
        92,
        59,
        30,
        22,
        12,
        13,
        8,
        4,
        0,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        41,
        177,
        320,
        429,
        463,
        445,
        414,
        388,
        366,
        320,
        239,
        113,
        63,
        25,
        9,
        3,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        18,
        54,
        156,
        237,
        407,
        565,
        714,
        881,
        1023,
        980,
        646,
        332,
        108,
        45,
        10,
        6,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_mobilenetv3_small_e50_bs64.pth"
}