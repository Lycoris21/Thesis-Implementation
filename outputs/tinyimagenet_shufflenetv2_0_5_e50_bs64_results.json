{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 5.005401710510254,
      "train_acc": 0.03613,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.340646046600342,
      "train_acc": 0.1188,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.029614176483154,
      "train_acc": 0.17257,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.8568853259277343,
      "train_acc": 0.20827,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.7318434762573243,
      "train_acc": 0.233,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.637214963684082,
      "train_acc": 0.2526,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.5584486515808105,
      "train_acc": 0.26886,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.493330589981079,
      "train_acc": 0.28423,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.434976003189087,
      "train_acc": 0.29637,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.387195621185303,
      "train_acc": 0.30824,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.3446078478240966,
      "train_acc": 0.3171,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.3026257119750975,
      "train_acc": 0.32668,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.2652401092529297,
      "train_acc": 0.33659,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.2280962404632567,
      "train_acc": 0.34358,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.197450263671875,
      "train_acc": 0.35146,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.160887841491699,
      "train_acc": 0.36083,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 3.132421260986328,
      "train_acc": 0.36608,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 3.0994244895935057,
      "train_acc": 0.37578,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 3.06935829208374,
      "train_acc": 0.38437,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 3.041458204040527,
      "train_acc": 0.38853,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 3.0155059452819826,
      "train_acc": 0.39529,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.98310682220459,
      "train_acc": 0.40363,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.9543375553894045,
      "train_acc": 0.41234,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.9253521239471434,
      "train_acc": 0.41972,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.8937441459655764,
      "train_acc": 0.42764,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.8642456189727783,
      "train_acc": 0.43553,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.834536009674072,
      "train_acc": 0.44219,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.801666791687012,
      "train_acc": 0.45244,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.769508985977173,
      "train_acc": 0.46068,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.7349093372344973,
      "train_acc": 0.46896,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.7001843672180175,
      "train_acc": 0.47846,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.668666035003662,
      "train_acc": 0.48782,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.6376358017730714,
      "train_acc": 0.49769,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.602996256637573,
      "train_acc": 0.50587,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 2.568202857131958,
      "train_acc": 0.51753,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 2.5346907608795166,
      "train_acc": 0.52795,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 2.5019891500854494,
      "train_acc": 0.53917,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 2.467454185028076,
      "train_acc": 0.54751,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 2.435372445755005,
      "train_acc": 0.55784,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 2.4092503620147707,
      "train_acc": 0.56594,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 2.3757793125152586,
      "train_acc": 0.57929,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 2.349278030395508,
      "train_acc": 0.58717,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 2.3268302017211915,
      "train_acc": 0.59544,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 2.303614080734253,
      "train_acc": 0.60195,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 2.288850047836304,
      "train_acc": 0.60782,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 2.2699465451812744,
      "train_acc": 0.61483,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 2.2538688779449463,
      "train_acc": 0.62008,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 2.243031181869507,
      "train_acc": 0.6233,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 2.242901338043213,
      "train_acc": 0.62404,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 2.235737807388306,
      "train_acc": 0.62699,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3331,
    "test_loss": 2.9568953720092774
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7689127553479969,
      "ECE": 0.03838897275663912,
      "ARC_area": 0.5500743632083169,
      "AvUC": 0.4034028907494736
    },
    "gradient": {
      "AUROC_error": 0.5184419917153883,
      "ECE": 0.03838897275663912,
      "ARC_area": 0.35690452741102147,
      "AvUC": 0.5614581570829265
    },
    "hybrid": {
      "AUROC_error": 0.7284008162438853,
      "ECE": 0.03838897275663912,
      "ARC_area": 0.5257217992288783,
      "AvUC": 0.48243052407149223
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.3601111111111111,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.388,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.42042857142857143,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.45966666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.5016,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.3323333333333333,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.33375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.3362857142857143,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.342,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.343,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.3527777777777778,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.373125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.4022857142857143,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.43616666666666665,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3331,
      "accuracy_after_rejection": 0.4774,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.05834943428635597,
      0.10575656592845917,
      0.16570784151554108,
      0.23221459984779358,
      0.29904836416244507,
      0.36573854088783264,
      0.4318191409111023,
      0.5001252293586731,
      0.5660074949264526,
      0.6321982145309448,
      0.6992084383964539,
      0.7662397027015686,
      0.8324026465415955,
      0.9006802439689636,
      0.9673888683319092
    ],
    "bin_acc": [
      0.03896103799343109,
      0.0898251160979271,
      0.14479105174541473,
      0.18920813500881195,
      0.2653985619544983,
      0.3201856017112732,
      0.40086206793785095,
      0.43050193786621094,
      0.5285714268684387,
      0.5577464699745178,
      0.5896656513214111,
      0.6969696879386902,
      0.7706093192100525,
      0.8656250238418579,
      0.9619377255439758
    ],
    "bin_count": [
      77,
      1258,
      1699,
      1427,
      1104,
      862,
      696,
      518,
      490,
      355,
      329,
      297,
      279,
      320,
      289
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        97,
        125,
        119,
        131,
        144,
        136,
        141,
        134,
        167,
        146,
        142,
        162,
        163,
        189,
        153,
        165,
        166,
        186,
        153,
        141,
        126,
        112,
        66,
        45,
        19,
        3,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        1,
        6,
        10,
        27,
        37,
        50,
        71,
        84,
        106,
        122,
        145,
        187,
        202,
        296,
        299,
        374,
        422,
        515,
        547,
        616,
        673,
        646,
        587,
        403,
        182,
        59,
        2,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        11,
        34,
        78,
        143,
        218,
        290,
        329,
        373,
        361,
        304,
        248,
        223,
        170,
        154,
        118,
        84,
        58,
        32,
        35,
        26,
        17,
        10,
        9,
        2,
        0,
        1,
        1,
        1,
        0,
        1
      ],
      "incorrect_counts": [
        10,
        30,
        113,
        235,
        365,
        546,
        715,
        770,
        731,
        622,
        579,
        485,
        422,
        267,
        257,
        177,
        100,
        76,
        52,
        39,
        28,
        21,
        8,
        8,
        3,
        2,
        4,
        2,
        1,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        2,
        20,
        42,
        81,
        147,
        196,
        229,
        249,
        264,
        280,
        308,
        300,
        302,
        264,
        212,
        164,
        140,
        56,
        27,
        20,
        14,
        10,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        2,
        8,
        25,
        48,
        83,
        151,
        211,
        342,
        410,
        604,
        818,
        953,
        902,
        799,
        555,
        344,
        189,
        116,
        62,
        22,
        15,
        4,
        4,
        2,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_shufflenetv2_0_5_e50_bs64.pth"
}