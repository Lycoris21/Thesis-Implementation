{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.984438923339844,
      "train_acc": 0.0238,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.556717684173584,
      "train_acc": 0.06433,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.3661312940979,
      "train_acc": 0.09114,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 4.164352486114502,
      "train_acc": 0.11744,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 4.120179146270752,
      "train_acc": 0.12587,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.9838902535247804,
      "train_acc": 0.14714,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.7507895069885255,
      "train_acc": 0.18125,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.5980782153320314,
      "train_acc": 0.20593,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.390875553588867,
      "train_acc": 0.23743,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.247261285934448,
      "train_acc": 0.26107,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.201223656463623,
      "train_acc": 0.26999,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.0642281714630126,
      "train_acc": 0.29386,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.969429396133423,
      "train_acc": 0.30648,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.8890098966979982,
      "train_acc": 0.32515,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.7711648670959472,
      "train_acc": 0.34529,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.681251952972412,
      "train_acc": 0.36006,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.58208279006958,
      "train_acc": 0.38048,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.4809121562194822,
      "train_acc": 0.39761,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.3896366748046876,
      "train_acc": 0.41677,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.292425390853882,
      "train_acc": 0.4351,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.195317461090088,
      "train_acc": 0.45263,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.08733208190918,
      "train_acc": 0.47536,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.9864761156463624,
      "train_acc": 0.49462,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.8743560245895385,
      "train_acc": 0.51894,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.755798170814514,
      "train_acc": 0.54412,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.6346423009490967,
      "train_acc": 0.56983,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.5175715585327147,
      "train_acc": 0.59465,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.382284439201355,
      "train_acc": 0.62451,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.2482088940238953,
      "train_acc": 0.65474,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.1153546435165405,
      "train_acc": 0.6886,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9745107495880126,
      "train_acc": 0.72457,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.8378594046211243,
      "train_acc": 0.76089,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.7001507918548584,
      "train_acc": 0.79662,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.5798906078433991,
      "train_acc": 0.82906,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.4613221144771576,
      "train_acc": 0.86598,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.35230590642929077,
      "train_acc": 0.89873,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.2722375237417221,
      "train_acc": 0.92383,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.19993995198249817,
      "train_acc": 0.94739,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.14786480349302292,
      "train_acc": 0.96339,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.11551186651229858,
      "train_acc": 0.97272,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.09104940719008446,
      "train_acc": 0.97995,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.07538392724394798,
      "train_acc": 0.98435,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.0618917599260807,
      "train_acc": 0.98869,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.05505216518640518,
      "train_acc": 0.98994,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.048561123440265655,
      "train_acc": 0.99177,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.04509802917122841,
      "train_acc": 0.99243,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.042115486133694646,
      "train_acc": 0.99364,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.040380499261021614,
      "train_acc": 0.99396,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.03974562185525894,
      "train_acc": 0.99384,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.038946785714626314,
      "train_acc": 0.99429,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3073,
    "test_loss": 5.019861902618408
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7892364193536885,
      "ECE": 0.3938497162654996,
      "ARC_area": 0.5357627544681713,
      "AvUC": 0.5680873971298559
    },
    "gradient": {
      "AUROC_error": 0.43471259550166397,
      "ECE": 0.3938497162654996,
      "ARC_area": 0.26933818575565505,
      "AvUC": 0.6112791909010732
    },
    "hybrid": {
      "AUROC_error": 0.6909998280144416,
      "ECE": 0.3938497162654996,
      "ARC_area": 0.4481886097271813,
      "AvUC": 0.5896832940086723
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.3343333333333333,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.364375,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.3952857142857143,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.4335,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.4788,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.293,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.285125,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.28214285714285714,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.2778333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.271,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.3268888888888889,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.3495,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.37042857142857144,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.3995,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3073,
      "accuracy_after_rejection": 0.4276,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11856347322463989,
      0.17743058502674103,
      0.2364586889743805,
      0.302926629781723,
      0.3682968020439148,
      0.4343693256378174,
      0.4999583661556244,
      0.5661998987197876,
      0.6324689984321594,
      0.6994563937187195,
      0.7664667963981628,
      0.834861695766449,
      0.9008171558380127,
      0.9820951223373413
    ],
    "bin_acc": [
      NaN,
      0.20000000298023224,
      0.05747126415371895,
      0.06640625,
      0.08365758508443832,
      0.09020217508077621,
      0.1443452388048172,
      0.15646257996559143,
      0.16223067045211792,
      0.20845481753349304,
      0.1997041404247284,
      0.24710983037948608,
      0.27299270033836365,
      0.3333333432674408,
      0.6243523359298706
    ],
    "bin_count": [
      0,
      5,
      87,
      256,
      514,
      643,
      672,
      735,
      789,
      686,
      676,
      692,
      685,
      858,
      2702
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1421,
        324,
        226,
        213,
        208,
        156,
        142,
        112,
        82,
        60,
        51,
        36,
        13,
        11,
        9,
        6,
        2,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        595,
        459,
        444,
        502,
        592,
        577,
        637,
        607,
        509,
        513,
        436,
        338,
        286,
        204,
        116,
        59,
        31,
        16,
        5,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        9,
        33,
        112,
        206,
        303,
        354,
        404,
        359,
        331,
        239,
        220,
        138,
        120,
        80,
        54,
        35,
        22,
        22,
        16,
        4,
        5,
        4,
        0,
        1,
        0,
        0,
        1,
        1,
        0,
        0
      ],
      "incorrect_counts": [
        22,
        113,
        357,
        615,
        833,
        912,
        956,
        832,
        690,
        544,
        361,
        253,
        158,
        119,
        63,
        35,
        24,
        12,
        14,
        8,
        2,
        1,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        9,
        122,
        325,
        502,
        562,
        520,
        394,
        277,
        186,
        90,
        54,
        22,
        6,
        4,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        1,
        53,
        222,
        523,
        803,
        1015,
        1159,
        1050,
        908,
        614,
        337,
        165,
        54,
        13,
        7,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_efficientnetv2_s_e50_bs64.pth"
}