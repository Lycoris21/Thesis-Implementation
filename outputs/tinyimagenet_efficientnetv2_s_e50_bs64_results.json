{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 5.298778789520264,
      "train_acc": 0.00762,
      "lr": 0.009990133642141357
    },
    {
      "epoch": 2,
      "train_loss": 5.161350339050293,
      "train_acc": 0.01601,
      "lr": 0.009960573506572389
    },
    {
      "epoch": 3,
      "train_loss": 4.860873147277832,
      "train_acc": 0.04308,
      "lr": 0.009911436253643442
    },
    {
      "epoch": 4,
      "train_loss": 4.536187303161621,
      "train_acc": 0.08511,
      "lr": 0.009842915805643154
    },
    {
      "epoch": 5,
      "train_loss": 4.294975918579102,
      "train_acc": 0.12651,
      "lr": 0.009755282581475767
    },
    {
      "epoch": 6,
      "train_loss": 4.105119509811401,
      "train_acc": 0.15812,
      "lr": 0.009648882429441256
    },
    {
      "epoch": 7,
      "train_loss": 3.9677710428619384,
      "train_acc": 0.18451,
      "lr": 0.009524135262330098
    },
    {
      "epoch": 8,
      "train_loss": 3.8437633416748045,
      "train_acc": 0.20938,
      "lr": 0.009381533400219317
    },
    {
      "epoch": 9,
      "train_loss": 3.732991354675293,
      "train_acc": 0.23161,
      "lr": 0.009221639627510075
    },
    {
      "epoch": 10,
      "train_loss": 3.635735345535278,
      "train_acc": 0.25378,
      "lr": 0.009045084971874737
    },
    {
      "epoch": 11,
      "train_loss": 3.5434567120361327,
      "train_acc": 0.27266,
      "lr": 0.008852566213878947
    },
    {
      "epoch": 12,
      "train_loss": 3.4611259124755858,
      "train_acc": 0.29237,
      "lr": 0.008644843137107058
    },
    {
      "epoch": 13,
      "train_loss": 3.3816380072784424,
      "train_acc": 0.3112,
      "lr": 0.008422735529643444
    },
    {
      "epoch": 14,
      "train_loss": 3.306240793457031,
      "train_acc": 0.32897,
      "lr": 0.00818711994874345
    },
    {
      "epoch": 15,
      "train_loss": 3.2358592102050783,
      "train_acc": 0.34674,
      "lr": 0.007938926261462368
    },
    {
      "epoch": 16,
      "train_loss": 3.161311443862915,
      "train_acc": 0.36446,
      "lr": 0.007679133974894984
    },
    {
      "epoch": 17,
      "train_loss": 3.0956848294067383,
      "train_acc": 0.37989,
      "lr": 0.007408768370508577
    },
    {
      "epoch": 18,
      "train_loss": 3.0244368828582764,
      "train_acc": 0.39802,
      "lr": 0.0071288964578253644
    },
    {
      "epoch": 19,
      "train_loss": 2.965353523864746,
      "train_acc": 0.41548,
      "lr": 0.0068406227634233915
    },
    {
      "epoch": 20,
      "train_loss": 2.898760419921875,
      "train_acc": 0.4311,
      "lr": 0.006545084971874738
    },
    {
      "epoch": 21,
      "train_loss": 2.836636765136719,
      "train_acc": 0.44944,
      "lr": 0.006243449435824274
    },
    {
      "epoch": 22,
      "train_loss": 2.7840670800018312,
      "train_acc": 0.46125,
      "lr": 0.005936906572928625
    },
    {
      "epoch": 23,
      "train_loss": 2.719221109008789,
      "train_acc": 0.48072,
      "lr": 0.005626666167821524
    },
    {
      "epoch": 24,
      "train_loss": 2.663436277923584,
      "train_acc": 0.4957,
      "lr": 0.005313952597646569
    },
    {
      "epoch": 25,
      "train_loss": 2.609056840209961,
      "train_acc": 0.51223,
      "lr": 0.005000000000000002
    },
    {
      "epoch": 26,
      "train_loss": 2.5574111000061035,
      "train_acc": 0.52856,
      "lr": 0.004686047402353435
    },
    {
      "epoch": 27,
      "train_loss": 2.5073303811645506,
      "train_acc": 0.54179,
      "lr": 0.004373333832178481
    },
    {
      "epoch": 28,
      "train_loss": 2.4630282237243653,
      "train_acc": 0.55476,
      "lr": 0.0040630934270713785
    },
    {
      "epoch": 29,
      "train_loss": 2.413042804336548,
      "train_acc": 0.57067,
      "lr": 0.0037565505641757274
    },
    {
      "epoch": 30,
      "train_loss": 2.372960761642456,
      "train_acc": 0.58354,
      "lr": 0.0034549150281252662
    },
    {
      "epoch": 31,
      "train_loss": 2.331956669921875,
      "train_acc": 0.59626,
      "lr": 0.0031593772365766134
    },
    {
      "epoch": 32,
      "train_loss": 2.290332341079712,
      "train_acc": 0.60884,
      "lr": 0.0028711035421746384
    },
    {
      "epoch": 33,
      "train_loss": 2.2608777651214598,
      "train_acc": 0.61929,
      "lr": 0.002591231629491424
    },
    {
      "epoch": 34,
      "train_loss": 2.2260218408203123,
      "train_acc": 0.63141,
      "lr": 0.0023208660251050166
    },
    {
      "epoch": 35,
      "train_loss": 2.1932220455932616,
      "train_acc": 0.64087,
      "lr": 0.0020610737385376356
    },
    {
      "epoch": 36,
      "train_loss": 2.1596375521850586,
      "train_acc": 0.65169,
      "lr": 0.001812880051256552
    },
    {
      "epoch": 37,
      "train_loss": 2.1370821865844727,
      "train_acc": 0.6609,
      "lr": 0.001577264470356557
    },
    {
      "epoch": 38,
      "train_loss": 2.110131061401367,
      "train_acc": 0.67008,
      "lr": 0.0013551568628929439
    },
    {
      "epoch": 39,
      "train_loss": 2.090521809158325,
      "train_acc": 0.67532,
      "lr": 0.0011474337861210548
    },
    {
      "epoch": 40,
      "train_loss": 2.072008558959961,
      "train_acc": 0.68267,
      "lr": 0.0009549150281252636
    },
    {
      "epoch": 41,
      "train_loss": 2.053864691390991,
      "train_acc": 0.68857,
      "lr": 0.000778360372489926
    },
    {
      "epoch": 42,
      "train_loss": 2.037325715637207,
      "train_acc": 0.69553,
      "lr": 0.0006184665997806823
    },
    {
      "epoch": 43,
      "train_loss": 2.025293467178345,
      "train_acc": 0.69908,
      "lr": 0.0004758647376699034
    },
    {
      "epoch": 44,
      "train_loss": 2.016769697418213,
      "train_acc": 0.70259,
      "lr": 0.0003511175705587434
    },
    {
      "epoch": 45,
      "train_loss": 2.0019775951385497,
      "train_acc": 0.70638,
      "lr": 0.00024471741852423245
    },
    {
      "epoch": 46,
      "train_loss": 1.9992347910690307,
      "train_acc": 0.70837,
      "lr": 0.00015708419435684522
    },
    {
      "epoch": 47,
      "train_loss": 1.9850308843231201,
      "train_acc": 0.71449,
      "lr": 8.856374635655642e-05
    },
    {
      "epoch": 48,
      "train_loss": 1.9839900495910645,
      "train_acc": 0.71314,
      "lr": 3.942649342761119e-05
    },
    {
      "epoch": 49,
      "train_loss": 1.9815694076538086,
      "train_acc": 0.71551,
      "lr": 9.866357858642208e-06
    },
    {
      "epoch": 50,
      "train_loss": 1.98166389503479,
      "train_acc": 0.71574,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.2758,
    "test_loss": 3.359251319885254
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7647847871542983,
      "ECE": 0.1392682358369231,
      "ARC_area": 0.4794314969254114,
      "AvUC": 0.4445723716309294
    },
    "gradient": {
      "AUROC_error": 0.6244722240079272,
      "ECE": 0.1392682358369231,
      "ARC_area": 0.3900439213718727,
      "AvUC": 0.5401820269905031
    },
    "hybrid": {
      "AUROC_error": 0.7346111355101846,
      "ECE": 0.1392682358369231,
      "ARC_area": 0.462776260037027,
      "AvUC": 0.492377199299261
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.298,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.321625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.34985714285714287,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.382,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.4196,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.28055555555555556,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.2915,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.30328571428571427,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.31916666666666665,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.342,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.2912222222222222,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.312375,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.3375714285714286,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.3705,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.2758,
      "accuracy_after_rejection": 0.4068,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.05593876913189888,
      0.10891078412532806,
      0.16890782117843628,
      0.2336934208869934,
      0.29957106709480286,
      0.36632052063941956,
      0.43101030588150024,
      0.49887362122535706,
      0.5654693245887756,
      0.6321706771850586,
      0.6998063325881958,
      0.764208972454071,
      0.8362099528312683,
      0.9007342457771301,
      0.9576409459114075
    ],
    "bin_acc": [
      0.0,
      0.06907378137111664,
      0.09278350323438644,
      0.13772894442081451,
      0.15806987881660461,
      0.2018691599369049,
      0.25564804673194885,
      0.2926829159259796,
      0.37272727489471436,
      0.4314928352832794,
      0.4624697268009186,
      0.5427807569503784,
      0.6393939256668091,
      0.8022283911705017,
      0.9268292784690857
    ],
    "bin_count": [
      28,
      637,
      1358,
      1365,
      1202,
      1070,
      841,
      697,
      550,
      489,
      413,
      374,
      330,
      359,
      287
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        27,
        130,
        168,
        154,
        159,
        148,
        144,
        155,
        163,
        173,
        169,
        153,
        141,
        138,
        120,
        143,
        101,
        98,
        95,
        66,
        53,
        42,
        11,
        4,
        3,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        10,
        24,
        41,
        68,
        90,
        116,
        173,
        206,
        271,
        324,
        334,
        453,
        467,
        527,
        551,
        565,
        591,
        645,
        590,
        482,
        369,
        197,
        99,
        32,
        16,
        1,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        13,
        37,
        84,
        139,
        150,
        193,
        213,
        249,
        252,
        227,
        222,
        201,
        188,
        160,
        109,
        102,
        74,
        44,
        40,
        14,
        13,
        14,
        9,
        4,
        2,
        3,
        2,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2,
        12,
        22,
        64,
        127,
        245,
        345,
        556,
        674,
        705,
        819,
        791,
        677,
        610,
        492,
        375,
        248,
        180,
        117,
        69,
        46,
        33,
        15,
        7,
        3,
        1,
        5,
        1,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3,
        29,
        114,
        139,
        148,
        183,
        195,
        190,
        217,
        224,
        199,
        223,
        213,
        174,
        142,
        120,
        89,
        69,
        46,
        22,
        10,
        6,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        1,
        3,
        2,
        23,
        55,
        79,
        146,
        216,
        270,
        424,
        512,
        672,
        743,
        812,
        886,
        755,
        635,
        465,
        310,
        118,
        68,
        27,
        12,
        6,
        1,
        1,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_efficientnetv2_s_e50_bs64.pth"
}