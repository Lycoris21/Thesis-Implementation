{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.7978306567499034,
      "train_acc": 0.35407274001909755,
      "lr": 0.009990133642141357
    },
    {
      "epoch": 2,
      "train_loss": 1.5229219537009375,
      "train_acc": 0.4916780486625651,
      "lr": 0.009960573506572389
    },
    {
      "epoch": 3,
      "train_loss": 1.4203574262592644,
      "train_acc": 0.5412652750413982,
      "lr": 0.009911436253643442
    },
    {
      "epoch": 4,
      "train_loss": 1.3526875910443648,
      "train_acc": 0.5773270641702827,
      "lr": 0.009842915805643154
    },
    {
      "epoch": 5,
      "train_loss": 1.3040651051206484,
      "train_acc": 0.6028851848718165,
      "lr": 0.009755282581475767
    },
    {
      "epoch": 6,
      "train_loss": 1.2629521491643318,
      "train_acc": 0.6239590006406149,
      "lr": 0.009648882429441256
    },
    {
      "epoch": 7,
      "train_loss": 1.2292630416350752,
      "train_acc": 0.6401133767662239,
      "lr": 0.009524135262330098
    },
    {
      "epoch": 8,
      "train_loss": 1.1956955144575188,
      "train_acc": 0.6562617093541876,
      "lr": 0.009381533400219317
    },
    {
      "epoch": 9,
      "train_loss": 1.1675742983929003,
      "train_acc": 0.6709475058320138,
      "lr": 0.009221639627510075
    },
    {
      "epoch": 10,
      "train_loss": 1.1406510186316696,
      "train_acc": 0.683965285919766,
      "lr": 0.009045084971874737
    },
    {
      "epoch": 11,
      "train_loss": 1.1110297399451734,
      "train_acc": 0.6994669599796937,
      "lr": 0.008852566213878947
    },
    {
      "epoch": 12,
      "train_loss": 1.0838326745098796,
      "train_acc": 0.7120979536581533,
      "lr": 0.008644843137107058
    },
    {
      "epoch": 13,
      "train_loss": 1.0546831957511482,
      "train_acc": 0.7280347624285352,
      "lr": 0.008422735529643444
    },
    {
      "epoch": 14,
      "train_loss": 1.0267113989007821,
      "train_acc": 0.7411008908174489,
      "lr": 0.00818711994874345
    },
    {
      "epoch": 15,
      "train_loss": 1.0008158234405975,
      "train_acc": 0.7545598491533003,
      "lr": 0.007938926261462368
    },
    {
      "epoch": 16,
      "train_loss": 0.9741953381551682,
      "train_acc": 0.7678556319727315,
      "lr": 0.007679133974894984
    },
    {
      "epoch": 17,
      "train_loss": 0.9489253951267698,
      "train_acc": 0.780480582113546,
      "lr": 0.007408768370508577
    },
    {
      "epoch": 18,
      "train_loss": 0.9227093291896762,
      "train_acc": 0.7946889391174018,
      "lr": 0.0071288964578253644
    },
    {
      "epoch": 19,
      "train_loss": 0.8994935491175742,
      "train_acc": 0.8047574728342983,
      "lr": 0.0068406227634233915
    },
    {
      "epoch": 20,
      "train_loss": 0.87646373753857,
      "train_acc": 0.8153940990898433,
      "lr": 0.006545084971874738
    },
    {
      "epoch": 21,
      "train_loss": 0.8572802644589006,
      "train_acc": 0.8237764858037301,
      "lr": 0.006243449435824274
    },
    {
      "epoch": 22,
      "train_loss": 0.8365541509009208,
      "train_acc": 0.83533777331899,
      "lr": 0.005936906572928625
    },
    {
      "epoch": 23,
      "train_loss": 0.8163132166298522,
      "train_acc": 0.8442701219585896,
      "lr": 0.005626666167821524
    },
    {
      "epoch": 24,
      "train_loss": 0.7965114216536902,
      "train_acc": 0.854671050245972,
      "lr": 0.005313952597646569
    },
    {
      "epoch": 25,
      "train_loss": 0.7801613030576534,
      "train_acc": 0.8618991212696264,
      "lr": 0.005000000000000002
    },
    {
      "epoch": 26,
      "train_loss": 0.7632622788103515,
      "train_acc": 0.8697859378966072,
      "lr": 0.004686047402353435
    },
    {
      "epoch": 27,
      "train_loss": 0.7462471594243697,
      "train_acc": 0.8775156225448129,
      "lr": 0.004373333832178481
    },
    {
      "epoch": 28,
      "train_loss": 0.7331601226838295,
      "train_acc": 0.8846953452673056,
      "lr": 0.0040630934270713785
    },
    {
      "epoch": 29,
      "train_loss": 0.7160803389605739,
      "train_acc": 0.8919959387427024,
      "lr": 0.0037565505641757274
    },
    {
      "epoch": 30,
      "train_loss": 0.7018578324712391,
      "train_acc": 0.8986800913782892,
      "lr": 0.0034549150281252662
    },
    {
      "epoch": 31,
      "train_loss": 0.6881896268855602,
      "train_acc": 0.9053279827880047,
      "lr": 0.0031593772365766134
    },
    {
      "epoch": 32,
      "train_loss": 0.6753319384703521,
      "train_acc": 0.9111720836909093,
      "lr": 0.0028711035421746384
    },
    {
      "epoch": 33,
      "train_loss": 0.6642273143772265,
      "train_acc": 0.9163997437540038,
      "lr": 0.002591231629491424
    },
    {
      "epoch": 34,
      "train_loss": 0.6520598225552473,
      "train_acc": 0.922014190226391,
      "lr": 0.0023208660251050166
    },
    {
      "epoch": 35,
      "train_loss": 0.6400336069594054,
      "train_acc": 0.9277011591505203,
      "lr": 0.0020610737385376356
    },
    {
      "epoch": 36,
      "train_loss": 0.6304881289609792,
      "train_acc": 0.9322398559220625,
      "lr": 0.001812880051256552
    },
    {
      "epoch": 37,
      "train_loss": 0.6204046434665261,
      "train_acc": 0.9369538152853154,
      "lr": 0.001577264470356557
    },
    {
      "epoch": 38,
      "train_loss": 0.6118086636979242,
      "train_acc": 0.9416859052615039,
      "lr": 0.0013551568628929439
    },
    {
      "epoch": 39,
      "train_loss": 0.6050230460149467,
      "train_acc": 0.9444780196535845,
      "lr": 0.0011474337861210548
    },
    {
      "epoch": 40,
      "train_loss": 0.5979877768871427,
      "train_acc": 0.9482673177571224,
      "lr": 0.0009549150281252636
    },
    {
      "epoch": 41,
      "train_loss": 0.5930651289113604,
      "train_acc": 0.9502979464059081,
      "lr": 0.000778360372489926
    },
    {
      "epoch": 42,
      "train_loss": 0.5865570149994532,
      "train_acc": 0.9527818403780837,
      "lr": 0.0006184665997806823
    },
    {
      "epoch": 43,
      "train_loss": 0.5785193221537909,
      "train_acc": 0.9562991792875878,
      "lr": 0.0004758647376699034
    },
    {
      "epoch": 44,
      "train_loss": 0.5784856999476481,
      "train_acc": 0.9560936990076511,
      "lr": 0.0003511175705587434
    },
    {
      "epoch": 45,
      "train_loss": 0.5738359238439666,
      "train_acc": 0.9587165943456661,
      "lr": 0.00024471741852423245
    },
    {
      "epoch": 46,
      "train_loss": 0.571592372482169,
      "train_acc": 0.9595868637665744,
      "lr": 0.00015708419435684522
    },
    {
      "epoch": 47,
      "train_loss": 0.5688529645957309,
      "train_acc": 0.9607049182309356,
      "lr": 8.856374635655642e-05
    },
    {
      "epoch": 48,
      "train_loss": 0.5686362506525355,
      "train_acc": 0.9610191821884858,
      "lr": 3.942649342761119e-05
    },
    {
      "epoch": 49,
      "train_loss": 0.5681676009858274,
      "train_acc": 0.9609768774249695,
      "lr": 9.866357858642208e-06
    },
    {
      "epoch": 50,
      "train_loss": 0.5659514821263164,
      "train_acc": 0.9619982352870076,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6045896785109983,
    "test_loss": 2.0776783559931515
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.6714729767869488,
      "ECE": 0.21528443118428114,
      "ARC_area": 0.6782548894240349,
      "AvUC": 0.4121447803197616
    },
    "gradient": {
      "AUROC_error": 0.7281866682996612,
      "ECE": 0.21528443118428114,
      "ARC_area": 0.7742902765368831,
      "AvUC": 0.3951045299841517
    },
    "hybrid": {
      "AUROC_error": 0.6717970104879508,
      "ECE": 0.21528443118428114,
      "ARC_area": 0.6789078606063339,
      "AvUC": 0.4036246551841327
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6375728520398571,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6654240693739425,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.695824268793812,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.727192611393119,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.751818950930626,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.63186219214138,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6627802453468697,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6976069615663524,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.7371333897349126,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.7722927241962775,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6375728520398571,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6654769458544839,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.6959451293207638,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.7272278623801467,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6045896785109983,
      "accuracy_after_rejection": 0.7518612521150593,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.1899385303258896,
      0.2469363957643509,
      0.30930083990097046,
      0.3693796396255493,
      0.4379982650279999,
      0.49973157048225403,
      0.5663020610809326,
      0.6340466141700745,
      0.7013649344444275,
      0.768886387348175,
      0.8368368148803711,
      0.915069580078125,
      0.9430466294288635
    ],
    "bin_acc": [
      NaN,
      NaN,
      1.0,
      0.23999999463558197,
      0.18840579688549042,
      0.27019089460372925,
      0.3187588155269623,
      0.35152730345726013,
      0.4020460247993469,
      0.4062347710132599,
      0.4189189076423645,
      0.4572135806083679,
      0.49495643377304077,
      0.7356525659561157,
      0.5772187113761902
    ],
    "bin_count": [
      0,
      0,
      1,
      50,
      276,
      681,
      1418,
      1997,
      1955,
      2053,
      2294,
      2828,
      4362,
      26503,
      2862
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        4,
        0,
        0,
        14,
        509,
        7499,
        9845,
        2053,
        1262,
        963,
        731,
        672,
        601,
        565,
        625,
        655,
        737,
        487,
        352,
        292,
        250,
        194,
        134,
        58,
        41,
        27,
        9,
        4,
        2,
        0
      ],
      "incorrect_counts": [
        202,
        8,
        7,
        19,
        391,
        2615,
        2666,
        1312,
        1037,
        860,
        772,
        761,
        742,
        687,
        791,
        852,
        1048,
        827,
        663,
        609,
        514,
        411,
        328,
        236,
        173,
        101,
        47,
        14,
        2,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        28584,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        18588,
        38,
        26,
        22,
        14,
        3,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3,
        15,
        7997,
        11898,
        2221,
        1411,
        1164,
        1270,
        1235,
        639,
        456,
        191,
        70,
        13,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        138,
        75,
        3015,
        3981,
        1893,
        1535,
        1427,
        1639,
        1879,
        1277,
        929,
        565,
        277,
        62,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_efficientnetv2_s_e50_bs64.pth"
}