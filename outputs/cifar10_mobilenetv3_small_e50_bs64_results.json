{
  "config": {
    "dataset": "cifar10",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.795409305496216,
      "train_acc": 0.38302,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.5468188499069213,
      "train_acc": 0.517,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.439811728553772,
      "train_acc": 0.5726,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.364166994781494,
      "train_acc": 0.607,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3027372913169861,
      "train_acc": 0.6378,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.2561952363967896,
      "train_acc": 0.66132,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.2174356675338744,
      "train_acc": 0.67862,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.1883073006439209,
      "train_acc": 0.69336,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1622851585388183,
      "train_acc": 0.70534,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1339817484283448,
      "train_acc": 0.71864,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1119796525955201,
      "train_acc": 0.72748,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.0942333173370362,
      "train_acc": 0.73752,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.0731622438812256,
      "train_acc": 0.74416,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.056758035697937,
      "train_acc": 0.75484,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0407782396697998,
      "train_acc": 0.76316,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.020322278289795,
      "train_acc": 0.7698,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0042085206222535,
      "train_acc": 0.77794,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 0.9877653943252563,
      "train_acc": 0.7864,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 0.9721476188659668,
      "train_acc": 0.79178,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 0.9587688343048095,
      "train_acc": 0.7991,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 0.9438459831237793,
      "train_acc": 0.80482,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.9279731670188904,
      "train_acc": 0.81368,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.9120619497680664,
      "train_acc": 0.82008,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.8956226972961426,
      "train_acc": 0.827,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.8822293214416503,
      "train_acc": 0.83462,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.8618094675064087,
      "train_acc": 0.84402,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.8476267754364014,
      "train_acc": 0.84984,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.8300800326538086,
      "train_acc": 0.85712,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.8141133332824707,
      "train_acc": 0.8652,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.7980225302124023,
      "train_acc": 0.8719,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.7800586258697509,
      "train_acc": 0.88346,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.7634874991989136,
      "train_acc": 0.88898,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.7450178923034668,
      "train_acc": 0.89784,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.7279882891082764,
      "train_acc": 0.9064,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.712775171585083,
      "train_acc": 0.9136,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.6966082371520996,
      "train_acc": 0.92074,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.6808671870422364,
      "train_acc": 0.92862,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.6665323182296753,
      "train_acc": 0.93536,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.6522865240097045,
      "train_acc": 0.94176,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.6433576065826416,
      "train_acc": 0.9459,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.6291224848747253,
      "train_acc": 0.95302,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.6177731907272339,
      "train_acc": 0.95874,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.6123501236724853,
      "train_acc": 0.9613,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.6014617112350464,
      "train_acc": 0.96604,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.5973769582748413,
      "train_acc": 0.96792,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.5882646181106568,
      "train_acc": 0.97326,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.585559101524353,
      "train_acc": 0.97358,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.5845989568710327,
      "train_acc": 0.9744,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.5810908796691895,
      "train_acc": 0.97676,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.5809504150581359,
      "train_acc": 0.9758,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.7179,
    "test_loss": 1.0294189929008484
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7404147914777034,
      "ECE": 0.0931285274475813,
      "ARC_area": 0.8282031156849458,
      "AvUC": 0.3520425964627415
    },
    "gradient": {
      "AUROC_error": 0.7754286140911109,
      "ECE": 0.0931285274475813,
      "ARC_area": 0.8765355440896057,
      "AvUC": 0.3073006542715477
    },
    "hybrid": {
      "AUROC_error": 0.7750133703114845,
      "ECE": 0.0931285274475813,
      "ARC_area": 0.862315001858125,
      "AvUC": 0.32967162526100874
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.7566666666666667,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.793375,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8297142857142857,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8583333333333333,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8722,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.7448888888888889,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.78225,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8208571428571428,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8645,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.9014,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.7551111111111111,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.792375,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8331428571428572,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8656666666666667,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.7179,
      "accuracy_after_rejection": 0.8978,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.18821722269058228,
      0.24188610911369324,
      0.3034874498844147,
      0.3704645335674286,
      0.434940367937088,
      0.49956798553466797,
      0.566318154335022,
      0.6325581669807434,
      0.7012896537780762,
      0.7693488597869873,
      0.8379032611846924,
      0.9114512205123901,
      0.9439296126365662
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.0,
      0.3142857253551483,
      0.26271185278892517,
      0.3136363625526428,
      0.4390243887901306,
      0.4193548262119293,
      0.4267989993095398,
      0.4597156345844269,
      0.5334773063659668,
      0.5592948794364929,
      0.666292130947113,
      0.8572497963905334,
      0.8609731793403625
    ],
    "bin_count": [
      0,
      0,
      1,
      35,
      118,
      220,
      369,
      434,
      403,
      422,
      463,
      624,
      890,
      4007,
      2014
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        0,
        29,
        314,
        1266,
        1742,
        1110,
        540,
        305,
        237,
        197,
        170,
        147,
        163,
        151,
        151,
        130,
        118,
        77,
        102,
        79,
        49,
        38,
        32,
        19,
        9,
        4,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        1,
        6,
        92,
        174,
        211,
        167,
        137,
        138,
        114,
        101,
        139,
        114,
        124,
        151,
        146,
        169,
        136,
        130,
        129,
        122,
        98,
        65,
        65,
        53,
        26,
        9,
        3,
        1,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1447,
        1559,
        845,
        482,
        355,
        339,
        310,
        320,
        307,
        277,
        219,
        203,
        163,
        103,
        87,
        47,
        41,
        23,
        20,
        10,
        6,
        5,
        3,
        2,
        2,
        2,
        0,
        0,
        1,
        1
      ],
      "incorrect_counts": [
        49,
        132,
        135,
        128,
        126,
        156,
        175,
        277,
        257,
        291,
        266,
        248,
        184,
        124,
        99,
        62,
        45,
        19,
        18,
        10,
        9,
        7,
        1,
        1,
        0,
        0,
        0,
        0,
        1,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        10,
        1014,
        2274,
        888,
        479,
        342,
        281,
        273,
        222,
        217,
        201,
        199,
        209,
        187,
        116,
        116,
        52,
        49,
        28,
        11,
        6,
        2,
        2,
        0,
        0,
        0,
        1,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        3,
        90,
        198,
        160,
        113,
        152,
        149,
        115,
        144,
        189,
        189,
        235,
        231,
        238,
        214,
        180,
        97,
        77,
        24,
        16,
        3,
        1,
        2,
        0,
        0,
        1,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_mobilenetv3_small_e50_bs64.pth"
}