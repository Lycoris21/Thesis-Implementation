{
  "config": {
    "dataset": "cifar100",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.593630390014648,
      "train_acc": 0.02316,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.300413488464356,
      "train_acc": 0.03794,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.122295005493164,
      "train_acc": 0.05644,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.9614409327697753,
      "train_acc": 0.08078,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.823056621398926,
      "train_acc": 0.0998,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.8876880869293213,
      "train_acc": 0.09358,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.814317374420166,
      "train_acc": 0.10658,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.7359720698547365,
      "train_acc": 0.11874,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.7392071643066407,
      "train_acc": 0.11954,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.655957044067383,
      "train_acc": 0.13082,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.5310645670318603,
      "train_acc": 0.15538,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.511340905303955,
      "train_acc": 0.1582,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.5456599244689944,
      "train_acc": 0.15206,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.434125140686035,
      "train_acc": 0.17346,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.402422404785156,
      "train_acc": 0.17848,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.3710727796936033,
      "train_acc": 0.1812,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 3.276013593597412,
      "train_acc": 0.20298,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 3.1770479776000977,
      "train_acc": 0.21638,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 3.1064322882843016,
      "train_acc": 0.23522,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 3.515802600860596,
      "train_acc": 0.16644,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 3.689015238342285,
      "train_acc": 0.12854,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 3.3626809171295164,
      "train_acc": 0.18602,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 3.176710982513428,
      "train_acc": 0.22086,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 3.079449828338623,
      "train_acc": 0.23734,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 3.0090378594207765,
      "train_acc": 0.25034,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.949234125366211,
      "train_acc": 0.26312,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.957036738586426,
      "train_acc": 0.26186,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.8728348445129392,
      "train_acc": 0.27792,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.8356888298034666,
      "train_acc": 0.28684,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.7757026330566408,
      "train_acc": 0.29764,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.722972953414917,
      "train_acc": 0.30792,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.6984263079833983,
      "train_acc": 0.3134,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.648403168182373,
      "train_acc": 0.32266,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.603770213699341,
      "train_acc": 0.33322,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 2.5517150256347656,
      "train_acc": 0.34326,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 2.515041410140991,
      "train_acc": 0.35064,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 2.468671645278931,
      "train_acc": 0.35682,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 2.420471637878418,
      "train_acc": 0.3709,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 2.374588550491333,
      "train_acc": 0.38078,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 2.329697615509033,
      "train_acc": 0.3894,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 2.285959340438843,
      "train_acc": 0.39706,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 2.2509289083099366,
      "train_acc": 0.40624,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 2.2059383307647704,
      "train_acc": 0.41592,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 2.1838135502624514,
      "train_acc": 0.4237,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 2.1428507119750977,
      "train_acc": 0.43214,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 2.1238940506744384,
      "train_acc": 0.43706,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 2.101035145187378,
      "train_acc": 0.44128,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 2.0879752172851562,
      "train_acc": 0.44332,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 2.0631870722961425,
      "train_acc": 0.44882,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 2.061302539978027,
      "train_acc": 0.4505,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3765,
    "test_loss": 7.999509912872314
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7634920036507272,
      "ECE": 0.023233892598748203,
      "ARC_area": 0.5720514456051362,
      "AvUC": 0.3778701284939372
    },
    "gradient": {
      "AUROC_error": 0.4193662772060648,
      "ECE": 0.023233892598748203,
      "ARC_area": 0.33510220681440184,
      "AvUC": 0.6182579730586909
    },
    "hybrid": {
      "AUROC_error": 0.7710495840748206,
      "ECE": 0.023233892598748203,
      "ARC_area": 0.6055348906257292,
      "AvUC": 0.49806405073457866
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4057777777777778,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.436125,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.47114285714285714,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5108333333333334,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5556,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3581111111111111,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3445,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.33214285714285713,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3233333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.3174,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4056666666666667,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.435875,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.4715714285714286,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5106666666666667,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3765,
      "accuracy_after_rejection": 0.5572,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\cifar100_efficientnetv2_s_e50_bs64.pth"
}