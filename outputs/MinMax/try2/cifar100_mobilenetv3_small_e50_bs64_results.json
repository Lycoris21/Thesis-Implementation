{
  "config": {
    "dataset": "cifar100",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 3.9842044215393067,
      "train_acc": 0.07778,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.4957728693389893,
      "train_acc": 0.1506,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.2438552559661864,
      "train_acc": 0.19846,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.077071111679077,
      "train_acc": 0.22996,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 2.9601703229522704,
      "train_acc": 0.2528,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 2.8295666541290285,
      "train_acc": 0.27738,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 2.7290009230041505,
      "train_acc": 0.29902,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.6460982277679443,
      "train_acc": 0.3164,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.6140503955078125,
      "train_acc": 0.32474,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.539326932525635,
      "train_acc": 0.33956,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.4752711531829834,
      "train_acc": 0.3504,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.469461961669922,
      "train_acc": 0.35446,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.43789063873291,
      "train_acc": 0.36102,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.371198935317993,
      "train_acc": 0.3745,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.3200425188446046,
      "train_acc": 0.38462,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.289012851867676,
      "train_acc": 0.38918,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.252254261779785,
      "train_acc": 0.39826,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.2104347573089598,
      "train_acc": 0.40892,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.172611274032593,
      "train_acc": 0.4162,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.1322377475738525,
      "train_acc": 0.42462,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.097523889541626,
      "train_acc": 0.43296,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.081318902435303,
      "train_acc": 0.43656,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.0350440468978883,
      "train_acc": 0.44824,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.9982402060699462,
      "train_acc": 0.4551,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.9589922334289551,
      "train_acc": 0.46658,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.9252752626037597,
      "train_acc": 0.46974,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.887992074279785,
      "train_acc": 0.47712,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.844555926208496,
      "train_acc": 0.49132,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.8162081019592284,
      "train_acc": 0.4954,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.7723428144073485,
      "train_acc": 0.50706,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.739389310760498,
      "train_acc": 0.51462,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.6947259143447877,
      "train_acc": 0.52378,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.6539417540740966,
      "train_acc": 0.53444,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.6237827618408203,
      "train_acc": 0.54396,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.578483030166626,
      "train_acc": 0.55476,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.52905656375885,
      "train_acc": 0.56514,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.4859594873809814,
      "train_acc": 0.5742,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.44262770111084,
      "train_acc": 0.58712,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.405706547164917,
      "train_acc": 0.59558,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.3689031442642212,
      "train_acc": 0.60516,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.3167264816284179,
      "train_acc": 0.62012,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.2798505516815186,
      "train_acc": 0.62696,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.2362577084732056,
      "train_acc": 0.6396,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.212977686958313,
      "train_acc": 0.64474,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.1721106455230712,
      "train_acc": 0.65582,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.143679210510254,
      "train_acc": 0.66372,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.1261044684219361,
      "train_acc": 0.67044,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.1071638939285278,
      "train_acc": 0.67554,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.0920391947174073,
      "train_acc": 0.68,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.0894422673034667,
      "train_acc": 0.67914,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.4609,
    "test_loss": 2.2347293796539307
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8020899928076168,
      "ECE": 0.13986421242132782,
      "ARC_area": 0.7076578998191629,
      "AvUC": 0.3825282747862399
    },
    "gradient": {
      "AUROC_error": 0.3854767025505049,
      "ECE": 0.13986421242132782,
      "ARC_area": 0.37940987277854854,
      "AvUC": 0.5424334676263854
    },
    "hybrid": {
      "AUROC_error": 0.7750601186399115,
      "ECE": 0.13986421242132782,
      "ARC_area": 0.6794904179350953,
      "AvUC": 0.46248087125793097
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.496,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.5375,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.5774285714285714,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.6233333333333333,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.6806,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.4381111111111111,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.421375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.4085714285714286,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.394,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.3806,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.49433333333333335,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.532625,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.5728571428571428,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.6148333333333333,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4609,
      "accuracy_after_rejection": 0.6626,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\cifar100_mobilenetv3_small_e50_bs64.pth"
}