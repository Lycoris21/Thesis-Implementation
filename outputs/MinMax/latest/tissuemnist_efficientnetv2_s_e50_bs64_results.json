{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.7130255984411036,
      "train_acc": 0.3975741239892183,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.354316153470025,
      "train_acc": 0.49194396431895376,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.2757785856120771,
      "train_acc": 0.5228445722988408,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.2278812976703235,
      "train_acc": 0.5405279634486844,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.268444900794649,
      "train_acc": 0.5229775301270352,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.171039472164253,
      "train_acc": 0.56275005137007,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.1217187592115627,
      "train_acc": 0.5871901176072426,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.0836683222402963,
      "train_acc": 0.6009693834382894,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.0607817694909518,
      "train_acc": 0.6109291334775724,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.0314472104033,
      "train_acc": 0.6214932372813751,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.010391470698881,
      "train_acc": 0.6294707069730338,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 0.992227760630318,
      "train_acc": 0.6369949113413027,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 0.9761535951516099,
      "train_acc": 0.6425912272007542,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 0.9621390821965936,
      "train_acc": 0.6479155838661719,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 0.9465786552771555,
      "train_acc": 0.6538624249090448,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 0.9340407593147424,
      "train_acc": 0.6594587407684962,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 0.9215850557432606,
      "train_acc": 0.6632057341085178,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 0.9115655350324608,
      "train_acc": 0.6677383873424148,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 0.8980742518044754,
      "train_acc": 0.6721139085975366,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 0.8864495115480262,
      "train_acc": 0.6764048203256258,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 0.8774342678926143,
      "train_acc": 0.6803089456444225,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.8644055950997964,
      "train_acc": 0.6871079254952679,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.8541983384600076,
      "train_acc": 0.6893500779616356,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.8415347146948723,
      "train_acc": 0.6941244727013405,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.8291257239743364,
      "train_acc": 0.6983609925906229,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.8155070515033299,
      "train_acc": 0.7044528785369804,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.802406009911854,
      "train_acc": 0.7074565167466428,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.7874393958830314,
      "train_acc": 0.7143340625868758,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.7692764731313588,
      "train_acc": 0.7202446424038775,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.7546225014489147,
      "train_acc": 0.7253091269505518,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.7396118001655279,
      "train_acc": 0.731824060532073,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.7175208322777054,
      "train_acc": 0.7394026567391488,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.6985275494698311,
      "train_acc": 0.7475191277966471,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.6774949919434968,
      "train_acc": 0.7543724994862993,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.6545359498778749,
      "train_acc": 0.7635888943952232,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.6299827739899134,
      "train_acc": 0.7721042389373043,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.6059807455335241,
      "train_acc": 0.7804443208876748,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.5763872603434661,
      "train_acc": 0.7912018178961236,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.5481454025776463,
      "train_acc": 0.8032828496488704,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.5162154399635278,
      "train_acc": 0.8138711276032539,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.486026788867216,
      "train_acc": 0.8258856804419035,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.451222257412238,
      "train_acc": 0.8386435884109122,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.4163514862581948,
      "train_acc": 0.8516794991116,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.38100110196082265,
      "train_acc": 0.8649027594792889,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.3494643917090426,
      "train_acc": 0.8773282728778118,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.31660740671232995,
      "train_acc": 0.889330738641171,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.2875690961811884,
      "train_acc": 0.901327160866885,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.2699324473353772,
      "train_acc": 0.908664015568153,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.2551643174811345,
      "train_acc": 0.914616900148671,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.24701475410882281,
      "train_acc": 0.9184787207039513,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6243866328257192,
    "test_loss": 1.5901017165627778
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7340766518719609,
      "ECE": 0.22437680810784477,
      "ARC_area": 0.7897466819182515,
      "AvUC": 0.3529694161359976
    },
    "gradient": {
      "AUROC_error": 0.6295469184911062,
      "ECE": 0.22437680810784477,
      "ARC_area": 0.7333250287169104,
      "AvUC": 0.4164289857735408
    },
    "hybrid": {
      "AUROC_error": 0.737662898518468,
      "ECE": 0.22437680810784477,
      "ARC_area": 0.792939903457499,
      "AvUC": 0.38469920098379157
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6577834179357022,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6900909475465313,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7210236886632826,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7538071065989848,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7885363790186125,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6393354013912389,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6544786379018612,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6708363548465072,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6893683023124647,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7104483925549916,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6570078962210942,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.6894828680203046,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7230178873579889,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.755922165820643,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6243866328257192,
      "accuracy_after_rejection": 0.7923857868020304,
      "kept_count": 23640
    }
  ],
  "checkpoint_path": "./outputs\\tissuemnist_efficientnetv2_s_e50_bs64.pth"
}