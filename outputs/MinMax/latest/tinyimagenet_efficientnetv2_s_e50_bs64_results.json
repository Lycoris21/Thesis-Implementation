{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 5.01077227722168,
      "train_acc": 0.02359,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.5724954103088375,
      "train_acc": 0.0625,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 4.500751937866211,
      "train_acc": 0.07593,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 4.1390607862854,
      "train_acc": 0.1208,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 4.089782785339356,
      "train_acc": 0.12946,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.8003963914489747,
      "train_acc": 0.17296,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.8444179724121095,
      "train_acc": 0.16675,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.6688715840148927,
      "train_acc": 0.19349,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.478835653381348,
      "train_acc": 0.22252,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.4596988459014892,
      "train_acc": 0.2273,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.6434804668426515,
      "train_acc": 0.19858,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.33199903175354,
      "train_acc": 0.24722,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.130244340209961,
      "train_acc": 0.28068,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.0038439556121825,
      "train_acc": 0.3039,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.9219737549591063,
      "train_acc": 0.31965,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.8314051612091062,
      "train_acc": 0.33628,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.7437782287597656,
      "train_acc": 0.35288,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.672100307159424,
      "train_acc": 0.36215,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.5841051518249514,
      "train_acc": 0.38107,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.4963015637207033,
      "train_acc": 0.39874,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.418875726699829,
      "train_acc": 0.41222,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.3426196015167235,
      "train_acc": 0.42697,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.2580858360290526,
      "train_acc": 0.44397,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.180933988723755,
      "train_acc": 0.45891,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.1029017155456544,
      "train_acc": 0.47517,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.016581062011719,
      "train_acc": 0.495,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.9356000186920166,
      "train_acc": 0.51173,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.852014086303711,
      "train_acc": 0.52725,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.7742059827041625,
      "train_acc": 0.54381,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.687023881225586,
      "train_acc": 0.56329,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.5958565351486207,
      "train_acc": 0.58273,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.5009477787017822,
      "train_acc": 0.60346,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.4126240407943726,
      "train_acc": 0.62385,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.315687080116272,
      "train_acc": 0.64668,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.2110332621765136,
      "train_acc": 0.67119,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.1189646422195434,
      "train_acc": 0.69291,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.0132717672348022,
      "train_acc": 0.72027,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9195815677070618,
      "train_acc": 0.74477,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.8193651722335815,
      "train_acc": 0.77057,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7320916686630249,
      "train_acc": 0.79577,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.6419480167007446,
      "train_acc": 0.82191,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.5669152270030975,
      "train_acc": 0.84302,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.4943359977817535,
      "train_acc": 0.86591,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.4383188788223267,
      "train_acc": 0.88293,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.3893991505050659,
      "train_acc": 0.89838,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.3581013451385498,
      "train_acc": 0.90941,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.32762500522613525,
      "train_acc": 0.91845,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.3104604978847504,
      "train_acc": 0.92381,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.29953529691219327,
      "train_acc": 0.92744,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.2930273449754715,
      "train_acc": 0.93112,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.4052,
    "test_loss": 3.2881210243225096
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8119376650948564,
      "ECE": 0.24978531435877083,
      "ARC_area": 0.6573765581082561,
      "AvUC": 0.41476484226267346
    },
    "gradient": {
      "AUROC_error": 0.4357225852086958,
      "ECE": 0.24978531435877083,
      "ARC_area": 0.3661228222878075,
      "AvUC": 0.5616220761699602
    },
    "hybrid": {
      "AUROC_error": 0.7796829888318039,
      "ECE": 0.24978531435877083,
      "ARC_area": 0.6255855704453157,
      "AvUC": 0.48819345922023055
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.442,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.48075,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.5251428571428571,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.5686666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.625,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.3907777777777778,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.383625,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.37585714285714283,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.36733333333333335,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.3582,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.43944444444444447,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.476625,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.5118571428571429,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.5541666666666667,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4052,
      "accuracy_after_rejection": 0.601,
      "kept_count": 5000
    }
  ],
  "checkpoint_path": "./outputs\\tinyimagenet_efficientnetv2_s_e50_bs64.pth"
}