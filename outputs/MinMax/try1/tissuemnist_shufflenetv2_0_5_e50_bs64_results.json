{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.4160895979627932,
      "train_acc": 0.49421029093590224,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.2863239677160456,
      "train_acc": 0.5212309477475735,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.231318799785956,
      "train_acc": 0.53869677154219,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.2038244118309576,
      "train_acc": 0.5511464590912937,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.1914508646612563,
      "train_acc": 0.5562049001003228,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.171042232074071,
      "train_acc": 0.563862062296786,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.1644238828135818,
      "train_acc": 0.5684491073694898,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.1476394941948203,
      "train_acc": 0.574190468132426,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1358921938667965,
      "train_acc": 0.5795631730990052,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.124310462658652,
      "train_acc": 0.5837936494506424,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1172766376198446,
      "train_acc": 0.5864709366274643,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1074239749396528,
      "train_acc": 0.5904234102474224,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.0991631294875166,
      "train_acc": 0.5934572661453108,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.0929661740888768,
      "train_acc": 0.5969383438289437,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.085665450145063,
      "train_acc": 0.6006369888678037,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.0793529758066287,
      "train_acc": 0.6014286922993244,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0722657094794779,
      "train_acc": 0.6051635985640554,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0691314624494832,
      "train_acc": 0.6059794761461569,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.060994336190614,
      "train_acc": 0.6088259823770442,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.0565933197567074,
      "train_acc": 0.6091583769475301,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0529835159354712,
      "train_acc": 0.6117027062961575,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.045628125798434,
      "train_acc": 0.6143981240859149,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.0405137750807438,
      "train_acc": 0.6160419663254082,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.0336106279242059,
      "train_acc": 0.6194021732561372,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.0271495191329882,
      "train_acc": 0.6220371556694426,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.0223118290587012,
      "train_acc": 0.6225145951434131,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.014163801999837,
      "train_acc": 0.6251979258578801,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.008589216462347,
      "train_acc": 0.6277785164323788,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.003882994672889,
      "train_acc": 0.630467890684491,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9996453783803262,
      "train_acc": 0.6310662009113654,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9907869902470113,
      "train_acc": 0.6345170609067724,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9843058410620001,
      "train_acc": 0.6370855644059806,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.979074131871449,
      "train_acc": 0.6402886393579346,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.9694902674407432,
      "train_acc": 0.643509844922824,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.9632669234153919,
      "train_acc": 0.6462656980890334,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.9542062525900039,
      "train_acc": 0.6482842396625289,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.9477689516177923,
      "train_acc": 0.6494385553527613,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9362457126947085,
      "train_acc": 0.6550469582875031,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9279886906248125,
      "train_acc": 0.656890237269288,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9186010461724279,
      "train_acc": 0.6609696251797953,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.907150328103858,
      "train_acc": 0.6657258893065645,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.8950806852358646,
      "train_acc": 0.6702404119275259,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.8866824822295989,
      "train_acc": 0.6736791848476424,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.874428507840305,
      "train_acc": 0.6777948339840209,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.8629499194285822,
      "train_acc": 0.6818983960451089,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.8522614194725145,
      "train_acc": 0.6862618302249405,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.841713594248125,
      "train_acc": 0.6886127663689217,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.8330058911459003,
      "train_acc": 0.6927465461182357,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.8243296624250132,
      "train_acc": 0.6969105435557759,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.8200981373247053,
      "train_acc": 0.6986269082470115,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6343274111675127,
    "test_loss": 1.0095573723820461
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7509713090918426,
      "ECE": 0.0487839808016259,
      "ARC_area": 0.8129890888530034,
      "AvUC": 0.3868362167007046
    },
    "gradient": {
      "AUROC_error": 0.4702975982350685,
      "ECE": 0.0487839808016259,
      "ARC_area": 0.6106112696650411,
      "AvUC": 0.43576832352619865
    },
    "hybrid": {
      "AUROC_error": 0.7178297598250496,
      "ECE": 0.0487839808016259,
      "ARC_area": 0.7941109315294755,
      "AvUC": 0.4113022700768806
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6684762173340854,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6993178934010152,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.7336536137297559,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.7698815566835872,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.807994923857868,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.629653130287648,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.626163282571912,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6230662315687696,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6186548223350253,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6158629441624366,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6611205113743185,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.6885046531302876,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.7172770123277737,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.7496474901297236,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6343274111675127,
      "accuracy_after_rejection": 0.7847292724196278,
      "kept_count": 23640
    }
  ],
  "checkpoint_path": "./outputs\\tissuemnist_shufflenetv2_0_5_e50_bs64.pth"
}