{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.3350824618355965,
      "train_acc": 0.5050040491702222,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.3053544380954358,
      "train_acc": 0.5149396250589245,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.3609626765737202,
      "train_acc": 0.49407128957006274,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.3458342078650425,
      "train_acc": 0.5052337036007397,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3185828105666162,
      "train_acc": 0.5141600087026942,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.3266253983251273,
      "train_acc": 0.5112711977082905,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.2851768662778442,
      "train_acc": 0.5253224227333712,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.2303266956815606,
      "train_acc": 0.5462391065233946,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.198785097716347,
      "train_acc": 0.5574861300811043,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1715419845838801,
      "train_acc": 0.5676271862497432,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1551503652216997,
      "train_acc": 0.5741239892183289,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1365182577973645,
      "train_acc": 0.5818778480171153,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.1232077008515116,
      "train_acc": 0.5861929338957852,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.111483066660634,
      "train_acc": 0.5916623354646876,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0999067721146656,
      "train_acc": 0.5950164988577714,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.089801169780505,
      "train_acc": 0.5990596255424075,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0814284630495423,
      "train_acc": 0.6025830079895568,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0731974226488428,
      "train_acc": 0.604595506025407,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.064047907947386,
      "train_acc": 0.6104577375412471,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.057299613490831,
      "train_acc": 0.611781272285545,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0523855333572738,
      "train_acc": 0.6138783798484281,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.0435322750316862,
      "train_acc": 0.6172144126285762,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.037290725798438,
      "train_acc": 0.6201213542359155,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.0304948877153135,
      "train_acc": 0.6219404590671195,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.0252368812455388,
      "train_acc": 0.6237837380489043,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.0174670824610292,
      "train_acc": 0.626612113666856,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.0141127253544708,
      "train_acc": 0.6286850470791583,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.0077184470808511,
      "train_acc": 0.6298635369199714,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.00274473764526,
      "train_acc": 0.6314892485465292,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9953122454179305,
      "train_acc": 0.6338945765293172,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9895117357548846,
      "train_acc": 0.6364268188026543,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9843645203344531,
      "train_acc": 0.6379195726010177,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.9790262260284911,
      "train_acc": 0.6413583455211342,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.9715746989854839,
      "train_acc": 0.6425066176737215,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.9649485693783306,
      "train_acc": 0.6452443402269953,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.9588066965502587,
      "train_acc": 0.647982062780269,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.9524437420970459,
      "train_acc": 0.6497769934608922,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9459854687378211,
      "train_acc": 0.6525449337023921,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9397060010234729,
      "train_acc": 0.6553853963956342,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9314799599145343,
      "train_acc": 0.658896691767493,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.9245998897682804,
      "train_acc": 0.6609756687174404,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.9171405829304707,
      "train_acc": 0.663489780377842,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.9106216748935416,
      "train_acc": 0.6667714213191834,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.9040693276026449,
      "train_acc": 0.6688503982691308,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.8960677869541842,
      "train_acc": 0.6714853806824362,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.8903633981218002,
      "train_acc": 0.6736912719229328,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.884822464333775,
      "train_acc": 0.675546637980008,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.881644699101279,
      "train_acc": 0.6758911196257842,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.8765284546384144,
      "train_acc": 0.6765377781538201,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.8743515545026248,
      "train_acc": 0.6790216721259956,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6449027072758037,
    "test_loss": 0.9736690415545365
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7531809301205651,
      "ECE": 0.02552932024651322,
      "ARC_area": 0.8221109246275967,
      "AvUC": 0.3914133133876772
    },
    "gradient": {
      "AUROC_error": 0.43711607361150556,
      "ECE": 0.02552932024651322,
      "ARC_area": 0.5979729254494727,
      "AvUC": 0.4071097381216101
    },
    "hybrid": {
      "AUROC_error": 0.7412265174953937,
      "ECE": 0.02552932024651322,
      "ARC_area": 0.8144861951612892,
      "AvUC": 0.39926152573922075
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6786285015980448,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7117438663282571,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7451353637901861,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7784827975183305,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.8173011844331641,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6349407783417935,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6278288917089678,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6203770848440899,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6120276367738297,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6060067681895093,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.6766309456664786,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7074344331641286,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7389110466521635,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.7727016356457981,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6449027072758037,
      "accuracy_after_rejection": 0.8103637901861253,
      "kept_count": 23640
    }
  ],
  "checkpoint_path": "./outputs\\tissuemnist_mobilenetv3_small_e50_bs64.pth"
}