{
  "config": {
    "dataset": "cifar10",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 2.472268450469971,
      "train_acc": 0.15068,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.951715301437378,
      "train_acc": 0.25774,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.762549956588745,
      "train_acc": 0.33642,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.5883858138275146,
      "train_acc": 0.41404,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.4632470858764648,
      "train_acc": 0.4697,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.4249599494934082,
      "train_acc": 0.48536,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.3719830756759643,
      "train_acc": 0.50422,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.2810338535308838,
      "train_acc": 0.53802,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1984583865356446,
      "train_acc": 0.5744,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1360510333633422,
      "train_acc": 0.59662,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.247263175354004,
      "train_acc": 0.55716,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.148921125869751,
      "train_acc": 0.5895,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.3366346457672118,
      "train_acc": 0.5249,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.3719316868972777,
      "train_acc": 0.50886,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.2101860800933837,
      "train_acc": 0.56638,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.3435296532058716,
      "train_acc": 0.51972,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.218418730659485,
      "train_acc": 0.56606,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.2652030870437623,
      "train_acc": 0.5498,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.067706767692566,
      "train_acc": 0.62312,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.0306672050094605,
      "train_acc": 0.63426,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.1812102725601197,
      "train_acc": 0.58112,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.080427427406311,
      "train_acc": 0.6178,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.0997587160491944,
      "train_acc": 0.60898,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.1380668324279786,
      "train_acc": 0.5961,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.9716726223754882,
      "train_acc": 0.65628,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.030594592819214,
      "train_acc": 0.63496,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.9881845146942139,
      "train_acc": 0.64824,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.9106998577880859,
      "train_acc": 0.67634,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.9092613796043396,
      "train_acc": 0.6769,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.8588449983215332,
      "train_acc": 0.6955,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9436242634773254,
      "train_acc": 0.66574,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.803740244846344,
      "train_acc": 0.71504,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.7936816138076782,
      "train_acc": 0.71964,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.7371562265777588,
      "train_acc": 0.73646,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.6809393138885498,
      "train_acc": 0.75782,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.6430009534072876,
      "train_acc": 0.7699,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.6371435933494568,
      "train_acc": 0.77334,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.5818176554298401,
      "train_acc": 0.79316,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.5399803663253784,
      "train_acc": 0.8076,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.5128363214111328,
      "train_acc": 0.81708,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.4900552819442749,
      "train_acc": 0.82558,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.44827214975357055,
      "train_acc": 0.84126,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.41815955963134765,
      "train_acc": 0.85186,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.37993267481803894,
      "train_acc": 0.86524,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.35279870955467224,
      "train_acc": 0.87498,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.3237253746414185,
      "train_acc": 0.88714,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.3041277062320709,
      "train_acc": 0.89096,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.29124968814849855,
      "train_acc": 0.89706,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.2764579326534271,
      "train_acc": 0.9039,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.2737612176132202,
      "train_acc": 0.90488,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6926,
    "test_loss": 53.38194701480865
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.772426643890963,
      "ECE": 0.1490351249650121,
      "ARC_area": 0.8133893070821161,
      "AvUC": 0.29826377869581294
    },
    "gradient": {
      "AUROC_error": 0.44195948394694273,
      "ECE": 0.1490351249650121,
      "ARC_area": 0.6437243048907557,
      "AvUC": 0.29765046153906216
    },
    "hybrid": {
      "AUROC_error": 0.8193555499150702,
      "ECE": 0.1490351249650121,
      "ARC_area": 0.8824458519205031,
      "AvUC": 0.29795712009165
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.7343333333333333,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.771125,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.8088571428571428,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.8453333333333334,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.8794,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.6934444444444444,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.684375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.673,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.6623333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.6548,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.7397777777777778,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.78025,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.8207142857142857,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.8611666666666666,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6926,
      "accuracy_after_rejection": 0.9008,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      NaN,
      0.250196635723114,
      0.30686983466148376,
      0.3705025017261505,
      0.435355544090271,
      0.5028257369995117,
      0.5649535655975342,
      0.6330440640449524,
      0.6990864276885986,
      0.76634281873703,
      0.8342660069465637,
      0.9026597142219543,
      0.9878734946250916
    ],
    "bin_acc": [
      NaN,
      NaN,
      NaN,
      0.0,
      0.23076923191547394,
      0.3372093141078949,
      0.27828747034072876,
      0.3861788511276245,
      0.4088291823863983,
      0.4422735273838043,
      0.5272045135498047,
      0.5769230723381042,
      0.5787106156349182,
      0.6719077825546265,
      0.8729259967803955
    ],
    "bin_count": [
      0,
      0,
      0,
      11,
      65,
      172,
      327,
      492,
      521,
      563,
      533,
      572,
      667,
      954,
      5123
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3239,
        617,
        384,
        311,
        272,
        241,
        226,
        197,
        246,
        237,
        174,
        159,
        135,
        102,
        103,
        84,
        61,
        42,
        44,
        18,
        10,
        14,
        8,
        2,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        298,
        130,
        119,
        123,
        117,
        136,
        140,
        142,
        176,
        235,
        180,
        157,
        166,
        186,
        145,
        170,
        131,
        91,
        82,
        57,
        50,
        23,
        8,
        5,
        4,
        1,
        2,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        6926,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2927,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        5,
        6,
        2,
        9,
        9,
        12,
        17,
        16,
        7,
        12,
        12,
        6,
        11,
        7,
        5,
        4,
        4,
        3
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3841,
        706,
        513,
        424,
        481,
        335,
        239,
        188,
        100,
        65,
        24,
        10,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        281,
        239,
        254,
        282,
        408,
        336,
        365,
        325,
        245,
        173,
        94,
        31,
        23,
        11,
        6,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_efficientnetv2_s_e50_bs64.pth"
}