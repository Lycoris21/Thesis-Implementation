{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.666751691741943,
      "train_acc": 0.0522,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.9766724697875975,
      "train_acc": 0.13059,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.640899151535034,
      "train_acc": 0.18107,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.4487056089782713,
      "train_acc": 0.21306,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.3076998472595216,
      "train_acc": 0.2393,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.2053620600891115,
      "train_acc": 0.25779,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.116258548965454,
      "train_acc": 0.27291,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.042663620605469,
      "train_acc": 0.288,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.9753506173706055,
      "train_acc": 0.29858,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.9109766596984863,
      "train_acc": 0.31082,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.8532325318908693,
      "train_acc": 0.32193,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.8027212197875975,
      "train_acc": 0.33066,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.7480511862182615,
      "train_acc": 0.34214,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.710905337677002,
      "train_acc": 0.34888,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.662969231262207,
      "train_acc": 0.35767,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.610980425186157,
      "train_acc": 0.36753,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.56331433555603,
      "train_acc": 0.37834,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.5176385874938965,
      "train_acc": 0.38612,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.471546300201416,
      "train_acc": 0.39491,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.423141142654419,
      "train_acc": 0.4042,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.371211398162842,
      "train_acc": 0.415,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.321419814453125,
      "train_acc": 0.42506,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.2679804299163817,
      "train_acc": 0.43505,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.2088083490753174,
      "train_acc": 0.44584,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.1619694452667235,
      "train_acc": 0.45579,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.1016495822143555,
      "train_acc": 0.46819,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.0584093675994874,
      "train_acc": 0.47547,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.9872828578948976,
      "train_acc": 0.49046,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.9221977923202516,
      "train_acc": 0.50373,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.854910681991577,
      "train_acc": 0.51828,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.7815507273101807,
      "train_acc": 0.53262,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.7050483832931518,
      "train_acc": 0.54856,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.6313312183380126,
      "train_acc": 0.56567,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.5493783905410767,
      "train_acc": 0.58518,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.4699629413986206,
      "train_acc": 0.60159,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.3824164730072022,
      "train_acc": 0.62146,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.3001195903396607,
      "train_acc": 0.64137,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.2076050288581848,
      "train_acc": 0.66374,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.119575669555664,
      "train_acc": 0.68497,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.0287978226089478,
      "train_acc": 0.70843,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.9519935026931763,
      "train_acc": 0.7278,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.8677185986328125,
      "train_acc": 0.75049,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.7874111289787292,
      "train_acc": 0.77258,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.7231639505958557,
      "train_acc": 0.78988,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.6592118954467774,
      "train_acc": 0.80937,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.6120998865890503,
      "train_acc": 0.82227,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.568943873500824,
      "train_acc": 0.83561,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.5409218495655059,
      "train_acc": 0.84484,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.5207131176185608,
      "train_acc": 0.85121,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.5104405669307709,
      "train_acc": 0.85475,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3431,
    "test_loss": 3.932926936340332
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7928887212528006,
      "ECE": 0.309866628819704,
      "ARC_area": 0.5803888228780045,
      "AvUC": 0.5216491181424759
    },
    "gradient": {
      "AUROC_error": 0.39547359933489035,
      "ECE": 0.309866628819704,
      "ARC_area": 0.2773743172620829,
      "AvUC": 0.5950360769301652
    },
    "hybrid": {
      "AUROC_error": 0.7034081278488526,
      "ECE": 0.309866628819704,
      "ARC_area": 0.4987605583175214,
      "AvUC": 0.5583425974911079
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.37155555555555553,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.402625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.43942857142857145,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.4811666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.5296,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.3211111111111111,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.305,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.2924285714285714,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.2856666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.2784,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.36466666666666664,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.390875,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.41614285714285715,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.44566666666666666,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3431,
      "accuracy_after_rejection": 0.4818,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11744886636734009,
      0.17415684461593628,
      0.23663589358329773,
      0.301482230424881,
      0.3670533001422882,
      0.4318169355392456,
      0.5007049441337585,
      0.5663033723831177,
      0.633551836013794,
      0.6994850635528564,
      0.7663845419883728,
      0.8341093063354492,
      0.9028519988059998,
      0.9813266396522522
    ],
    "bin_acc": [
      NaN,
      0.05263157933950424,
      0.08484848588705063,
      0.09388646483421326,
      0.10252366214990616,
      0.1398252248764038,
      0.1729598045349121,
      0.19235365092754364,
      0.23771581053733826,
      0.24143069982528687,
      0.25,
      0.3492063581943512,
      0.3571428656578064,
      0.4399999976158142,
      0.7413713932037354
    ],
    "bin_count": [
      0,
      19,
      165,
      458,
      634,
      801,
      821,
      837,
      753,
      671,
      644,
      630,
      644,
      750,
      2173
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1296,
        361,
        267,
        242,
        237,
        202,
        171,
        155,
        126,
        102,
        79,
        63,
        44,
        40,
        17,
        12,
        12,
        3,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        291,
        298,
        337,
        337,
        441,
        508,
        560,
        555,
        510,
        531,
        483,
        424,
        390,
        328,
        256,
        151,
        86,
        58,
        19,
        2,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1,
        13,
        54,
        170,
        265,
        382,
        406,
        423,
        369,
        332,
        297,
        221,
        164,
        119,
        76,
        50,
        34,
        23,
        9,
        7,
        5,
        3,
        1,
        2,
        3,
        0,
        1,
        0,
        0,
        1
      ],
      "incorrect_counts": [
        6,
        62,
        206,
        476,
        729,
        946,
        979,
        881,
        720,
        520,
        370,
        261,
        155,
        104,
        63,
        40,
        18,
        12,
        4,
        5,
        5,
        3,
        1,
        0,
        1,
        0,
        1,
        1,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        2,
        34,
        204,
        418,
        592,
        603,
        563,
        386,
        278,
        181,
        89,
        52,
        20,
        5,
        2,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        5,
        78,
        246,
        506,
        804,
        976,
        1101,
        998,
        858,
        583,
        257,
        100,
        40,
        14,
        1,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_mobilenetv3_small_e50_bs64.pth"
}