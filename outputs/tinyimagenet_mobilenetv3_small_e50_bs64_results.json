{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.77466921661377,
      "train_acc": 0.05398,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.215882224731446,
      "train_acc": 0.1358,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.9660644609832763,
      "train_acc": 0.18344,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.8142098641204836,
      "train_acc": 0.21419,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.702500397186279,
      "train_acc": 0.23909,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.6086713787841798,
      "train_acc": 0.2588,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.5342070823669434,
      "train_acc": 0.27532,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.4709968812561036,
      "train_acc": 0.28818,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.4106070877075196,
      "train_acc": 0.30161,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.3576582922363283,
      "train_acc": 0.31479,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.3088498065185545,
      "train_acc": 0.32622,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.270674628753662,
      "train_acc": 0.33484,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.2290038105773924,
      "train_acc": 0.34564,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.19320603805542,
      "train_acc": 0.3525,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.1564609328460693,
      "train_acc": 0.361,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.1229673624420164,
      "train_acc": 0.37199,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 3.0840045225524904,
      "train_acc": 0.38152,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 3.055634579162598,
      "train_acc": 0.38869,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 3.0242947750854494,
      "train_acc": 0.39451,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.995395725479126,
      "train_acc": 0.40229,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.961848045883179,
      "train_acc": 0.41066,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.9329494439697266,
      "train_acc": 0.41797,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.9001731309509275,
      "train_acc": 0.42558,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.869954270019531,
      "train_acc": 0.43467,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.842016233825684,
      "train_acc": 0.44167,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.8073033010864257,
      "train_acc": 0.45056,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.7793272311401367,
      "train_acc": 0.45916,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.7439116944885256,
      "train_acc": 0.46864,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.7172619914245604,
      "train_acc": 0.47545,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.6854130187988283,
      "train_acc": 0.48362,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.6520179370117187,
      "train_acc": 0.49404,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.621633243560791,
      "train_acc": 0.50174,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.5912075998687745,
      "train_acc": 0.50903,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.560045225067139,
      "train_acc": 0.52069,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 2.5283209967041014,
      "train_acc": 0.52845,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 2.4965652435302736,
      "train_acc": 0.5383,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 2.4654514785003663,
      "train_acc": 0.54812,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 2.4362203931427002,
      "train_acc": 0.55681,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 2.4076392209625244,
      "train_acc": 0.56594,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 2.3744493180847166,
      "train_acc": 0.57786,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 2.3509398369598387,
      "train_acc": 0.58383,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 2.3253985263061523,
      "train_acc": 0.59172,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 2.3036922296142577,
      "train_acc": 0.59932,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 2.283230520248413,
      "train_acc": 0.60699,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 2.2638853533935546,
      "train_acc": 0.61096,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 2.247061862335205,
      "train_acc": 0.61887,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 2.23221649230957,
      "train_acc": 0.62415,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 2.223644289855957,
      "train_acc": 0.62675,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 2.2178331475067137,
      "train_acc": 0.62885,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 2.2111776976394655,
      "train_acc": 0.63136,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3651,
    "test_loss": 2.7360401012420654
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7709250684172299,
      "ECE": 0.032611150393262504,
      "ARC_area": 0.5903252397149891,
      "AvUC": 0.4035647254784999
    },
    "gradient": {
      "AUROC_error": 0.46521067398946836,
      "ECE": 0.032611150393262504,
      "ARC_area": 0.3454848721226828,
      "AvUC": 0.5578795480931178
    },
    "hybrid": {
      "AUROC_error": 0.7338286440077585,
      "ECE": 0.032611150393262504,
      "ARC_area": 0.5613157250029769,
      "AvUC": 0.48072213670499625
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.3933333333333333,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.423375,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.45914285714285713,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.49666666666666665,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.5414,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.35133333333333333,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.34875,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.3467142857142857,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.3446666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.3422,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.3868888888888889,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.414125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.44485714285714284,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.4781666666666667,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3651,
      "accuracy_after_rejection": 0.5222,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.05706107243895531,
      0.10461599379777908,
      0.1666460931301117,
      0.23275625705718994,
      0.29834628105163574,
      0.36497217416763306,
      0.4314834773540497,
      0.4978354573249817,
      0.5658922791481018,
      0.6331746578216553,
      0.6985719203948975,
      0.7668624520301819,
      0.8346112370491028,
      0.9002552032470703,
      0.969224750995636
    ],
    "bin_acc": [
      0.05376344174146652,
      0.09408602118492126,
      0.14257293939590454,
      0.2132943719625473,
      0.28305235505104065,
      0.3325415551662445,
      0.3604135811328888,
      0.43942132592201233,
      0.4947807788848877,
      0.5810810923576355,
      0.6368421316146851,
      0.7196531891822815,
      0.8108974099159241,
      0.8476454019546509,
      0.9550321102142334
    ],
    "bin_count": [
      93,
      1116,
      1508,
      1369,
      1127,
      842,
      677,
      553,
      479,
      370,
      380,
      346,
      312,
      361,
      467
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        183,
        174,
        188,
        146,
        182,
        154,
        157,
        174,
        165,
        164,
        161,
        159,
        148,
        183,
        171,
        159,
        174,
        180,
        149,
        137,
        119,
        94,
        75,
        32,
        18,
        5,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        3,
        9,
        25,
        27,
        41,
        46,
        94,
        110,
        115,
        160,
        183,
        209,
        202,
        271,
        360,
        344,
        453,
        499,
        479,
        577,
        571,
        543,
        449,
        319,
        174,
        72,
        13,
        1,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1,
        9,
        28,
        68,
        165,
        247,
        373,
        421,
        385,
        371,
        341,
        276,
        224,
        187,
        136,
        137,
        91,
        59,
        42,
        35,
        19,
        8,
        6,
        5,
        7,
        1,
        4,
        2,
        2,
        1
      ],
      "incorrect_counts": [
        2,
        18,
        64,
        144,
        318,
        497,
        634,
        711,
        847,
        694,
        608,
        500,
        427,
        275,
        193,
        138,
        103,
        58,
        42,
        31,
        22,
        7,
        8,
        2,
        1,
        2,
        1,
        1,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        4,
        27,
        77,
        149,
        193,
        231,
        316,
        301,
        341,
        366,
        365,
        353,
        315,
        236,
        184,
        97,
        51,
        23,
        14,
        4,
        2,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        1,
        6,
        13,
        43,
        79,
        142,
        219,
        316,
        462,
        598,
        788,
        935,
        975,
        767,
        529,
        294,
        103,
        55,
        20,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_mobilenetv3_small_e50_bs64.pth"
}