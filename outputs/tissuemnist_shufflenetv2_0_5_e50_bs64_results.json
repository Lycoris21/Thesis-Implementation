{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.5377863744931886,
      "train_acc": 0.49421029093590224,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.3983403155146432,
      "train_acc": 0.5503426685844827,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.3659136967436927,
      "train_acc": 0.5654273385468918,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.3466110170862307,
      "train_acc": 0.5758645280601453,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3299661481393286,
      "train_acc": 0.5861083243687525,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.3264702680633025,
      "train_acc": 0.5852440984854894,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.3167998748738976,
      "train_acc": 0.593245742327729,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.3050456564021216,
      "train_acc": 0.5987091003589862,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.296347306234996,
      "train_acc": 0.6033142760446255,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.289446763346041,
      "train_acc": 0.606354175480159,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.2848542775701803,
      "train_acc": 0.6087957646888182,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.2799689436553086,
      "train_acc": 0.6111587879080899,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.2749127335067891,
      "train_acc": 0.6143497757847534,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.2723539527799443,
      "train_acc": 0.6153711336467915,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.2674401108668436,
      "train_acc": 0.617577024887288,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.265371850088959,
      "train_acc": 0.6190576916103611,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.2608816911505853,
      "train_acc": 0.6207377950757256,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.2569551140611377,
      "train_acc": 0.6217289352495377,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.2539451794186125,
      "train_acc": 0.6242551339852296,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.2522442094472765,
      "train_acc": 0.6260379775905625,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.2477833451821052,
      "train_acc": 0.6269868130008582,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.2437525442031496,
      "train_acc": 0.6289267885849661,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.2406631768763454,
      "train_acc": 0.6301717573398765,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.235455457534805,
      "train_acc": 0.6329517846566666,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.2329089779896645,
      "train_acc": 0.6335742690341218,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.2274280947519516,
      "train_acc": 0.6354235915535518,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.2220126238947395,
      "train_acc": 0.6400831590779978,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.2168423735834484,
      "train_acc": 0.6423132244690752,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.2114933923720945,
      "train_acc": 0.6450388599470586,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.207404551333366,
      "train_acc": 0.6468156600147462,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.201208622003762,
      "train_acc": 0.6497890805361827,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.1930881050853086,
      "train_acc": 0.6524421935624237,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.1879463570547883,
      "train_acc": 0.655905140633121,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.1819634131227468,
      "train_acc": 0.6597186128872397,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.1738757098533619,
      "train_acc": 0.6628189476992252,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.1658893622878632,
      "train_acc": 0.667683995503608,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.1588310422392796,
      "train_acc": 0.6701134976369768,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.1504096394659649,
      "train_acc": 0.6749120665272624,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.1429102138348892,
      "train_acc": 0.6780063578016028,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.1333517820525927,
      "train_acc": 0.6841707661997026,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.126594583997959,
      "train_acc": 0.6879661078408857,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.1178641369259434,
      "train_acc": 0.6921301052784258,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.1099870219507362,
      "train_acc": 0.6962215802642234,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.1014912639604801,
      "train_acc": 0.7001619668088912,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.0951575835829233,
      "train_acc": 0.7038424812348156,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.088882856173749,
      "train_acc": 0.7067433793045097,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.084200551854432,
      "train_acc": 0.7096019726106874,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.0814694186788223,
      "train_acc": 0.7105387209456928,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.077032599407026,
      "train_acc": 0.713784100661163,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.0749603851725682,
      "train_acc": 0.713814318349389,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6389805414551607,
    "test_loss": 1.0232623963993415
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7498412628182195,
      "ECE": 0.02190091162321178,
      "ARC_area": 0.811123723388669,
      "AvUC": 0.4354353623073895
    },
    "gradient": {
      "AUROC_error": 0.6741997719909157,
      "ECE": 0.02190091162321178,
      "ARC_area": 0.7752145034102665,
      "AvUC": 0.3835335113418451
    },
    "hybrid": {
      "AUROC_error": 0.7423615445117073,
      "ECE": 0.02190091162321178,
      "ARC_area": 0.8112184743362607,
      "AvUC": 0.40948443682612173
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.6747273923669863,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7072229272419628,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7388204012569495,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7746756909193457,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.8114636209813875,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.6589819514946419,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.679251269035533,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7014442832970752,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.725747320924986,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7546108291032149,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.6696277495769881,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7011421319796954,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7335629683345419,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.7701283135927806,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6389805414551607,
      "accuracy_after_rejection": 0.8069796954314721,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.19035211205482483,
      0.2460269331932068,
      0.30523228645324707,
      0.3687762916088104,
      0.43486425280570984,
      0.49924081563949585,
      0.566654622554779,
      0.6337347626686096,
      0.6999587416648865,
      0.7675063014030457,
      0.8354743719100952,
      0.8942522406578064,
      0.9448034763336182
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.3333333432674408,
      0.20554272830486298,
      0.299401193857193,
      0.377218097448349,
      0.4189050793647766,
      0.4832535982131958,
      0.5456762909889221,
      0.601425051689148,
      0.6786949038505554,
      0.7485213279724121,
      0.8459311723709106,
      0.9412364959716797,
      0.9330143332481384
    ],
    "bin_count": [
      0,
      0,
      15,
      433,
      1837,
      3494,
      4877,
      4807,
      4510,
      4491,
      4628,
      4903,
      6218,
      6858,
      209
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        0,
        8,
        28,
        108,
        302,
        1352,
        2257,
        2332,
        2087,
        1864,
        1713,
        1595,
        1658,
        1671,
        1810,
        1864,
        1733,
        1622,
        1560,
        1345,
        1072,
        823,
        533,
        369,
        285,
        168,
        41,
        11,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        1,
        2,
        7,
        22,
        56,
        120,
        195,
        282,
        338,
        407,
        501,
        617,
        741,
        941,
        1172,
        1304,
        1498,
        1548,
        1568,
        1449,
        1239,
        1016,
        806,
        611,
        396,
        183,
        48,
        1
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1891,
        4025,
        4197,
        4270,
        3962,
        3432,
        2668,
        1953,
        1311,
        877,
        591,
        363,
        227,
        156,
        100,
        65,
        41,
        28,
        21,
        14,
        5,
        5,
        3,
        1,
        1,
        2,
        0,
        0,
        0,
        2
      ],
      "incorrect_counts": [
        79,
        511,
        1188,
        2006,
        2365,
        2532,
        2242,
        1895,
        1367,
        950,
        666,
        455,
        286,
        187,
        111,
        84,
        66,
        29,
        17,
        10,
        10,
        9,
        2,
        1,
        1,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        0,
        60,
        1388,
        2904,
        2754,
        2493,
        2456,
        2383,
        2562,
        2562,
        2599,
        2392,
        2037,
        1459,
        966,
        572,
        311,
        157,
        76,
        38,
        23,
        10,
        5,
        2,
        0,
        2,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        2,
        36,
        127,
        296,
        414,
        554,
        806,
        1144,
        1495,
        1922,
        2283,
        2311,
        2015,
        1509,
        937,
        592,
        315,
        175,
        79,
        33,
        16,
        6,
        2,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_shufflenetv2_0_5_e50_bs64.pth"
}