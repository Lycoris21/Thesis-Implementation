{
  "config": {
    "dataset": "cifar100",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.310755050354004,
      "train_acc": 0.05946,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.7849049240112307,
      "train_acc": 0.14512,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.5356958477783205,
      "train_acc": 0.19546,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.3588264264678953,
      "train_acc": 0.23578,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.2140757537841798,
      "train_acc": 0.27126,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.102004451904297,
      "train_acc": 0.29832,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.007951100311279,
      "train_acc": 0.32044,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.9287198153686522,
      "train_acc": 0.34496,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.861954000091553,
      "train_acc": 0.35994,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.8019984825134276,
      "train_acc": 0.37374,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.7405024659729005,
      "train_acc": 0.3925,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.6875953226470948,
      "train_acc": 0.40576,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.6411284006500244,
      "train_acc": 0.41782,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.5868356684875486,
      "train_acc": 0.43502,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.54441501701355,
      "train_acc": 0.4465,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.5040261602783205,
      "train_acc": 0.45732,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.4640519157409666,
      "train_acc": 0.46616,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.425221132659912,
      "train_acc": 0.47954,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.388160427093506,
      "train_acc": 0.49126,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.3514838328552248,
      "train_acc": 0.5003,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.3145289181518556,
      "train_acc": 0.51236,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.279983922729492,
      "train_acc": 0.52362,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.242908544845581,
      "train_acc": 0.53584,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.2065393127441406,
      "train_acc": 0.54728,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.17358395401001,
      "train_acc": 0.55782,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.138754466781616,
      "train_acc": 0.57016,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.1053303926849365,
      "train_acc": 0.57798,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.0703920545959473,
      "train_acc": 0.5908,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.0393108282470704,
      "train_acc": 0.6041,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.9981027262878417,
      "train_acc": 0.6157,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.9665968203735351,
      "train_acc": 0.62554,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.9332962413787842,
      "train_acc": 0.63626,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.8982510633087157,
      "train_acc": 0.65064,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.8667195299530028,
      "train_acc": 0.6613,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.8342672910308837,
      "train_acc": 0.67462,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.8023978603363038,
      "train_acc": 0.6852,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.7768284033203126,
      "train_acc": 0.69424,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.7451684436798096,
      "train_acc": 0.70606,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.7208933113861085,
      "train_acc": 0.71632,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.6929347854614258,
      "train_acc": 0.72738,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.6731952587890624,
      "train_acc": 0.73438,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.65223005607605,
      "train_acc": 0.7448,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.6348814585876466,
      "train_acc": 0.75038,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.6157711847686766,
      "train_acc": 0.75982,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.6029436728668214,
      "train_acc": 0.763,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.5942464303588868,
      "train_acc": 0.76776,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.5829400047302247,
      "train_acc": 0.77242,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.578129970703125,
      "train_acc": 0.77638,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.571040330505371,
      "train_acc": 0.77764,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.5707921267700196,
      "train_acc": 0.7799,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.4329,
    "test_loss": 2.323670304107666
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.773941385738247,
      "ECE": 0.0541560914773494,
      "ARC_area": 0.660712323989173,
      "AvUC": 0.4071003836374497
    },
    "gradient": {
      "AUROC_error": 0.5961297216807708,
      "ECE": 0.0541560914773494,
      "ARC_area": 0.5249392385354252,
      "AvUC": 0.5133621647652239
    },
    "hybrid": {
      "AUROC_error": 0.7569570234884995,
      "ECE": 0.0541560914773494,
      "ARC_area": 0.6509138501398457,
      "AvUC": 0.46023127431087196
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.4656666666666667,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.500875,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.5374285714285715,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.5791666666666667,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.6262,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.44355555555555554,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.455375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.4664285714285714,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.4846666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.497,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.46266666666666667,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.49325,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.5257142857142857,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.5658333333333333,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.4329,
      "accuracy_after_rejection": 0.6188,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.06247079744935036,
      0.11286396533250809,
      0.16860297322273254,
      0.23309190571308136,
      0.2992703318595886,
      0.3663395941257477,
      0.4329544007778168,
      0.4991726279258728,
      0.5658228397369385,
      0.6321438550949097,
      0.6986902952194214,
      0.7669371366500854,
      0.8335217237472534,
      0.899513840675354,
      0.9635034799575806
    ],
    "bin_acc": [
      0.0,
      0.10030394792556763,
      0.14911365509033203,
      0.20119352638721466,
      0.2542372941970825,
      0.2913978397846222,
      0.35977011919021606,
      0.4349540174007416,
      0.5138888955116272,
      0.5315315127372742,
      0.5972762703895569,
      0.6535087823867798,
      0.778761088848114,
      0.8568872809410095,
      0.9570747017860413
    ],
    "bin_count": [
      3,
      329,
      959,
      1173,
      1121,
      930,
      870,
      761,
      576,
      555,
      514,
      456,
      565,
      559,
      629
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        125,
        235,
        242,
        211,
        238,
        253,
        235,
        226,
        222,
        225,
        215,
        210,
        196,
        197,
        185,
        195,
        179,
        170,
        163,
        130,
        109,
        79,
        49,
        26,
        13,
        1,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        8,
        29,
        30,
        52,
        71,
        95,
        103,
        135,
        166,
        204,
        244,
        249,
        311,
        359,
        349,
        402,
        424,
        502,
        498,
        439,
        395,
        320,
        188,
        75,
        22,
        1,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        25,
        121,
        283,
        377,
        445,
        527,
        492,
        500,
        371,
        294,
        264,
        203,
        135,
        82,
        66,
        55,
        38,
        20,
        11,
        8,
        2,
        4,
        2,
        0,
        1,
        1,
        0,
        1,
        0,
        1
      ],
      "incorrect_counts": [
        4,
        41,
        142,
        277,
        484,
        580,
        697,
        655,
        634,
        508,
        451,
        364,
        270,
        175,
        117,
        101,
        55,
        38,
        35,
        17,
        8,
        5,
        6,
        2,
        2,
        1,
        2,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        4,
        74,
        182,
        258,
        344,
        380,
        351,
        367,
        351,
        373,
        351,
        299,
        269,
        277,
        211,
        104,
        59,
        46,
        15,
        8,
        1,
        3,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        6,
        23,
        63,
        101,
        163,
        218,
        335,
        378,
        496,
        630,
        723,
        753,
        636,
        499,
        330,
        162,
        90,
        36,
        16,
        6,
        2,
        4,
        1,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_shufflenetv2_0_5_e50_bs64.pth"
}