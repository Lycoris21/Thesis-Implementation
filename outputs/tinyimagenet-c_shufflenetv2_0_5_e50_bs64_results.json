{
  "config": {
    "dataset": "tinyimagenet-c",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [],
  "baseline": {
    "test_acc": 0.09590666666666667,
    "test_loss": 4.963702599756877
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7096975751014816,
      "ECE": 0.18594013434012732,
      "ARC_area": 0.17746864581256078,
      "AvUC": 0.3878984972222513
    },
    "gradient": {
      "AUROC_error": 0.546022684812375,
      "ECE": 0.18594013434012732,
      "ARC_area": 0.111739831784889,
      "AvUC": 0.7202042750182419
    },
    "hybrid": {
      "AUROC_error": 0.6972406788876135,
      "ECE": 0.18594013434012732,
      "ARC_area": 0.17473246085543107,
      "AvUC": 0.5540513861200884
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.1032,
      "kept_count": 675000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.11062333333333334,
      "kept_count": 600000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.11934095238095238,
      "kept_count": 525000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.13007777777777776,
      "kept_count": 450000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.14333866666666667,
      "kept_count": 375000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.09833333333333333,
      "kept_count": 675000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.09989333333333333,
      "kept_count": 600000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.10171809523809523,
      "kept_count": 525000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.10378888888888889,
      "kept_count": 450000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.106464,
      "kept_count": 375000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.10222518518518518,
      "kept_count": 675000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.109385,
      "kept_count": 600000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.11749333333333334,
      "kept_count": 525000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.12754222222222222,
      "kept_count": 450000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.09590666666666667,
      "accuracy_after_rejection": 0.140456,
      "kept_count": 375000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.05860967934131622,
      0.10438421368598938,
      0.16546492278575897,
      0.23128627240657806,
      0.29797807335853577,
      0.3647138476371765,
      0.4315441846847534,
      0.49840307235717773,
      0.5649407505989075,
      0.6317659020423889,
      0.6987634301185608,
      0.7651613354682922,
      0.8317953944206238,
      0.8982357978820801,
      0.9596337676048279
    ],
    "bin_acc": [
      0.020935101434588432,
      0.03640951216220856,
      0.05397840216755867,
      0.07093262672424316,
      0.09066998213529587,
      0.10995562374591827,
      0.13786929845809937,
      0.16370481252670288,
      0.19294197857379913,
      0.21603462100028992,
      0.2531156539916992,
      0.303696870803833,
      0.37044262886047363,
      0.4552871584892273,
      0.6428958773612976
    ],
    "bin_count": [
      11464,
      144660,
      168271,
      123286,
      85166,
      59715,
      42446,
      31343,
      23406,
      17562,
      13721,
      10820,
      8201,
      6251,
      3688
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        502,
        1063,
        1314,
        1364,
        1628,
        1896,
        2086,
        2298,
        2450,
        2673,
        2925,
        3156,
        3442,
        3775,
        3913,
        4307,
        4306,
        4623,
        4673,
        4630,
        4556,
        4087,
        3217,
        2012,
        830,
        189,
        15,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        127,
        579,
        1052,
        1590,
        2202,
        3019,
        4018,
        5430,
        6939,
        8933,
        10706,
        13535,
        17110,
        21327,
        26604,
        32884,
        39513,
        48226,
        58159,
        66900,
        74531,
        75878,
        68259,
        52157,
        29574,
        8251,
        561,
        6,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        95,
        976,
        3627,
        7647,
        10930,
        11905,
        10898,
        8857,
        6475,
        4405,
        2651,
        1584,
        904,
        484,
        247,
        131,
        55,
        31,
        15,
        7,
        3,
        1,
        0,
        2,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        213,
        4567,
        23179,
        57025,
        91983,
        111365,
        108934,
        90788,
        67613,
        46686,
        30523,
        19123,
        11583,
        6767,
        3720,
        1953,
        987,
        527,
        276,
        122,
        58,
        37,
        20,
        13,
        4,
        2,
        0,
        1,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        4,
        250,
        873,
        1694,
        2593,
        3385,
        4074,
        4852,
        5760,
        6628,
        7424,
        8120,
        8273,
        7245,
        5409,
        3103,
        1409,
        567,
        176,
        71,
        16,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        37,
        343,
        1320,
        3031,
        5888,
        9774,
        15693,
        24575,
        37979,
        56407,
        80476,
        104778,
        114413,
        99845,
        66900,
        34215,
        14534,
        5371,
        1761,
        534,
        135,
        43,
        15,
        3,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet-c_shufflenetv2_0_5_e50_bs64.pth"
}