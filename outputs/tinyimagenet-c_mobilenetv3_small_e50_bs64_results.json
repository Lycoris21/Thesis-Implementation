{
  "config": {
    "dataset": "tinyimagenet-c",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [],
  "baseline": {
    "test_acc": 0.12689733333333333,
    "test_loss": 4.574265942123413
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7262641681117497,
      "ECE": 0.15609783234022806,
      "ARC_area": 0.23640330546476668,
      "AvUC": 0.3838335535423906
    },
    "gradient": {
      "AUROC_error": 0.45170575210666714,
      "ECE": 0.15609783234022806,
      "ARC_area": 0.1136498741650978,
      "AvUC": 0.6604143034071246
    },
    "hybrid": {
      "AUROC_error": 0.6799759345433699,
      "ECE": 0.15609783234022806,
      "ARC_area": 0.2205213472067684,
      "AvUC": 0.5221239284706066
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.1370311111111111,
      "kept_count": 675000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.147945,
      "kept_count": 600000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.16034666666666667,
      "kept_count": 525000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.17512444444444444,
      "kept_count": 450000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.193112,
      "kept_count": 375000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.12087111111111111,
      "kept_count": 675000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.11767,
      "kept_count": 600000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.11528952380952381,
      "kept_count": 525000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.11344888888888889,
      "kept_count": 450000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.11171733333333334,
      "kept_count": 375000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.13341777777777777,
      "kept_count": 675000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.14121166666666668,
      "kept_count": 600000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.15072761904761905,
      "kept_count": 525000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.1627377777777778,
      "kept_count": 450000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.12689733333333333,
      "accuracy_after_rejection": 0.17811466666666667,
      "kept_count": 375000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.057829197496175766,
      0.10338325053453445,
      0.16506585478782654,
      0.23139046132564545,
      0.29814180731773376,
      0.3648267090320587,
      0.43173936009407043,
      0.4985736310482025,
      0.5650823712348938,
      0.6319008469581604,
      0.6989231705665588,
      0.7654796838760376,
      0.8318677544593811,
      0.8989442586898804,
      0.9627991318702698
    ],
    "bin_acc": [
      0.027483420446515083,
      0.044550832360982895,
      0.06889746338129044,
      0.09724067896604538,
      0.1212088093161583,
      0.14936167001724243,
      0.1794111430644989,
      0.21048882603645325,
      0.24866321682929993,
      0.287687748670578,
      0.32460224628448486,
      0.3932887017726898,
      0.47317343950271606,
      0.5846808552742004,
      0.7789252400398254
    ],
    "bin_count": [
      14627,
      155822,
      161138,
      115898,
      82362,
      58355,
      42149,
      30890,
      23377,
      18242,
      14393,
      11503,
      8965,
      7050,
      5229
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1090,
        1863,
        2060,
        2103,
        2317,
        2663,
        2920,
        3163,
        3430,
        3647,
        3960,
        4319,
        4602,
        4671,
        5142,
        5255,
        5617,
        5584,
        5808,
        5767,
        5486,
        4913,
        4004,
        2818,
        1424,
        472,
        72,
        3,
        0,
        0
      ],
      "incorrect_counts": [
        217,
        484,
        896,
        1517,
        2115,
        3063,
        4070,
        5548,
        7046,
        8839,
        10989,
        13478,
        16794,
        20530,
        25125,
        30182,
        36327,
        43590,
        50738,
        57942,
        63916,
        68534,
        68151,
        58409,
        38442,
        15194,
        2603,
        88,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3,
        69,
        693,
        2129,
        4519,
        7450,
        10035,
        11864,
        12238,
        11205,
        9409,
        7747,
        5822,
        4302,
        2852,
        1866,
        1138,
        742,
        453,
        254,
        164,
        93,
        41,
        25,
        19,
        14,
        8,
        7,
        8,
        4
      ],
      "incorrect_counts": [
        150,
        1416,
        6818,
        14689,
        33620,
        60615,
        83561,
        93641,
        90225,
        77705,
        60972,
        46381,
        32553,
        21434,
        13682,
        7897,
        4411,
        2408,
        1305,
        651,
        358,
        168,
        76,
        44,
        27,
        7,
        4,
        4,
        2,
        3
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        11,
        320,
        974,
        1794,
        2815,
        3931,
        5427,
        6445,
        7234,
        8625,
        9519,
        10488,
        10812,
        10151,
        7991,
        5065,
        2341,
        866,
        268,
        76,
        16,
        4,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        9,
        219,
        779,
        2164,
        4651,
        8528,
        14225,
        22676,
        35113,
        53059,
        79897,
        103272,
        113797,
        101075,
        66164,
        32533,
        12113,
        3536,
        848,
        149,
        18,
        2,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet-c_mobilenetv3_small_e50_bs64.pth"
}