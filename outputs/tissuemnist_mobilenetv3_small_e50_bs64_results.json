{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.4610395637623697,
      "train_acc": 0.522693483857711,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.3733208501614025,
      "train_acc": 0.5657839072679584,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.3416968385793977,
      "train_acc": 0.5827178997497976,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.3194406522782416,
      "train_acc": 0.5927743463914037,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3022609950711328,
      "train_acc": 0.6009452092877087,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.292310817164754,
      "train_acc": 0.6073997074927779,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.2858911624158862,
      "train_acc": 0.6101797348095681,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.2764743016697622,
      "train_acc": 0.6141624261177523,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.2706404763589192,
      "train_acc": 0.618652774588133,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.2637419461434543,
      "train_acc": 0.6204537488064014,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.2597325273771218,
      "train_acc": 0.6225206386810583,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.2549676653331163,
      "train_acc": 0.6249199231262011,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.2517312344698093,
      "train_acc": 0.6268175939467927,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.2476368747021997,
      "train_acc": 0.6280806933146387,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.2427526935928717,
      "train_acc": 0.6303228457810064,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.240121048621815,
      "train_acc": 0.6322023859886623,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.2357676837257363,
      "train_acc": 0.6336830527117353,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.233384718106272,
      "train_acc": 0.6358466391887155,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.2286579323202829,
      "train_acc": 0.637647613406984,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.2263759464342854,
      "train_acc": 0.6382036188703419,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.2214602725989074,
      "train_acc": 0.640796296520131,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.2167844628811648,
      "train_acc": 0.645298732065802,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.2138344721932282,
      "train_acc": 0.6454498205069319,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.2099524575701772,
      "train_acc": 0.645576734797481,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.206059471764617,
      "train_acc": 0.6487375049859185,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.2026251894323434,
      "train_acc": 0.6505868275053486,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.19749905050767,
      "train_acc": 0.6533608112844935,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.1928228393373388,
      "train_acc": 0.6560743596871865,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.1876549663546352,
      "train_acc": 0.6580505964971656,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.1824544200138385,
      "train_acc": 0.6610481911691828,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.178076091312442,
      "train_acc": 0.6627887300109992,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.1707081547063902,
      "train_acc": 0.6663483736840197,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.166747597564636,
      "train_acc": 0.6680647383752554,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.1604451719916575,
      "train_acc": 0.6708085044661743,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.15487639012946,
      "train_acc": 0.6741747549345485,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.1483535749397316,
      "train_acc": 0.6776074843170198,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.1424385347878483,
      "train_acc": 0.6807199062042958,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.1359200693373623,
      "train_acc": 0.6838927634680236,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.1294703554603094,
      "train_acc": 0.6881836751961128,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.124103530637143,
      "train_acc": 0.689422600413378,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.1176703570587412,
      "train_acc": 0.6932481597427871,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.1125705799263332,
      "train_acc": 0.6954963557467999,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 1.1072621215004053,
      "train_acc": 0.6978231177402004,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 1.1018412974950975,
      "train_acc": 0.7014431967896728,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 1.0965689750476948,
      "train_acc": 0.703576565578427,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 1.0917498311611107,
      "train_acc": 0.7058187180447947,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 1.089294143810265,
      "train_acc": 0.7073839942949005,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 1.0869625248866404,
      "train_acc": 0.7091728814378785,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 1.0843454803403547,
      "train_acc": 0.7101579780740455,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 1.0832160569475895,
      "train_acc": 0.7105326774080476,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6549280879864636,
    "test_loss": 0.9806892114242322
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.75433440293899,
      "ECE": 0.016201017999331362,
      "ARC_area": 0.8253242190693284,
      "AvUC": 0.4346117154598179
    },
    "gradient": {
      "AUROC_error": 0.6671271336915686,
      "ECE": 0.016201017999331362,
      "ARC_area": 0.7850585691476983,
      "AvUC": 0.37203137603694375
    },
    "hybrid": {
      "AUROC_error": 0.7484802862108559,
      "ECE": 0.016201017999331362,
      "ARC_area": 0.8254159766818739,
      "AvUC": 0.4033215457264668
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.6897443128407595,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7216582064297801,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7557710901619531,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7913494077834179,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.8294416243654822,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.6717663094566648,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.6905668358714044,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7109318346627991,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7351945854483926,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7661167512690356,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.6870417371686407,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7182476734348562,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7525682861977279,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.7863437676254935,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6549280879864636,
      "accuracy_after_rejection": 0.8240693739424704,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.18941515684127808,
      0.24407406151294708,
      0.3057905435562134,
      0.3681490123271942,
      0.4349629580974579,
      0.49941152334213257,
      0.5666335225105286,
      0.6332843899726868,
      0.7000652551651001,
      0.7673690915107727,
      0.8354219198226929,
      0.8953129649162292,
      0.9436678290367126
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.1666666716337204,
      0.2312925159931183,
      0.3166322410106659,
      0.3668803870677948,
      0.45095542073249817,
      0.5016778707504272,
      0.5657519102096558,
      0.6286721229553223,
      0.6906077265739441,
      0.7757551670074463,
      0.8622440695762634,
      0.9484727382659912,
      0.9517543911933899
    ],
    "bin_count": [
      0,
      0,
      18,
      588,
      1936,
      3587,
      4710,
      4768,
      4555,
      4255,
      4525,
      4999,
      6105,
      7006,
      228
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        2,
        10,
        20,
        106,
        500,
        1478,
        2255,
        2356,
        2100,
        1791,
        1788,
        1665,
        1762,
        1737,
        1830,
        1725,
        1762,
        1582,
        1547,
        1334,
        1100,
        770,
        658,
        461,
        327,
        184,
        94,
        21,
        0
      ],
      "incorrect_counts": [
        1,
        0,
        1,
        1,
        3,
        21,
        60,
        116,
        164,
        263,
        295,
        370,
        447,
        596,
        692,
        847,
        1194,
        1166,
        1363,
        1457,
        1530,
        1260,
        1141,
        967,
        847,
        662,
        507,
        263,
        77,
        4
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        2042,
        4672,
        4846,
        4965,
        4513,
        3560,
        2561,
        1591,
        958,
        559,
        332,
        175,
        100,
        44,
        21,
        10,
        5,
        6,
        3,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        78,
        610,
        1445,
        2438,
        3098,
        2799,
        2156,
        1487,
        938,
        534,
        327,
        163,
        112,
        59,
        35,
        13,
        9,
        5,
        1,
        2,
        1,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        1,
        75,
        1464,
        3118,
        2999,
        2662,
        2579,
        2574,
        2606,
        2673,
        2800,
        2463,
        2062,
        1353,
        838,
        419,
        195,
        62,
        17,
        4,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        2,
        32,
        132,
        293,
        426,
        566,
        783,
        1154,
        1563,
        2008,
        2356,
        2380,
        1948,
        1357,
        726,
        358,
        156,
        49,
        20,
        2,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_mobilenetv3_small_e50_bs64.pth"
}