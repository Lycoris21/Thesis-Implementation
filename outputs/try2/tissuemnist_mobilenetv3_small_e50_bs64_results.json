{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 2,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "input_size": 224,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.3276034331397508,
      "train_acc": 0.5083400819503705,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.2999945432133222,
      "train_acc": 0.5158763733939299,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.2534057059392403,
      "train_acc": 0.5350343877292012,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.230980779109902,
      "train_acc": 0.5440332152828979,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.2417803664858338,
      "train_acc": 0.540703226040395,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.2452859050423581,
      "train_acc": 0.5363095741723375,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.1928647099515532,
      "train_acc": 0.5593173219875986,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.1487669551097173,
      "train_acc": 0.5784995104734507,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1314902787754193,
      "train_acc": 0.5842287841610966,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1167740217384328,
      "train_acc": 0.5899943190746135,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.107871293082145,
      "train_acc": 0.5942247954262507,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1010602376442384,
      "train_acc": 0.5964729914302637,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.089404921156008,
      "train_acc": 0.6000386786409293,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.0813108579190833,
      "train_acc": 0.6031934052917216,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0727316744818918,
      "train_acc": 0.6075145347080367,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.0613405827586462,
      "train_acc": 0.6100649075943094,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0535262857693464,
      "train_acc": 0.6138723363107829,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0448479644379018,
      "train_acc": 0.6164891881111527,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.037789212335073,
      "train_acc": 0.6195593052349123,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.031505078867285,
      "train_acc": 0.6214388454425682,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0253712170185985,
      "train_acc": 0.6234573870160637,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.0186504837503638,
      "train_acc": 0.625252317696687,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.0130048400816878,
      "train_acc": 0.6289993110367085,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.0083885179369938,
      "train_acc": 0.6303772376198131,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.0005684258053618,
      "train_acc": 0.6327281737637944,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.9948174037111235,
      "train_acc": 0.6354840269300037,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.987748261057574,
      "train_acc": 0.637436089589402,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.9811373305087604,
      "train_acc": 0.6406512516166463,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.9762152606561745,
      "train_acc": 0.6419083074468471,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9693511357981253,
      "train_acc": 0.6446520735377661,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9644406940291148,
      "train_acc": 0.6458366069162245,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9575424553168391,
      "train_acc": 0.6483869798024972,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.9494733973706647,
      "train_acc": 0.6521279296048735,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.9464166247537642,
      "train_acc": 0.6524361500247785,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.9385917953421103,
      "train_acc": 0.656612234537609,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.9313762893101323,
      "train_acc": 0.6571319787750958,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.9250351439697184,
      "train_acc": 0.6601356169847582,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.917714494342937,
      "train_acc": 0.663489780377842,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9102356009136774,
      "train_acc": 0.6650611001655929,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9023256874915291,
      "train_acc": 0.6685361343115807,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.8963198732271006,
      "train_acc": 0.6707299384767867,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.8884360009692857,
      "train_acc": 0.6745011059673891,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.881303107232886,
      "train_acc": 0.6768218244231443,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.8732133286443641,
      "train_acc": 0.6795837211269989,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.8663538824602297,
      "train_acc": 0.6826780124013393,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.8596093612025402,
      "train_acc": 0.6851558628358696,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.8531561193555752,
      "train_acc": 0.688159501045532,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.8502818816489095,
      "train_acc": 0.6882924588737264,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.8460851296792039,
      "train_acc": 0.6902928698342862,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.842803920313732,
      "train_acc": 0.6922026277301682,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6493866328257191,
    "test_loss": 0.9635272755437293
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7579605791125771,
      "ECE": 0.03338314580515203,
      "ARC_area": 0.8274580673278963,
      "AvUC": 0.3845215201303473
    },
    "gradient": {
      "AUROC_error": 0.44972389982026045,
      "ECE": 0.03338314580515203,
      "ARC_area": 0.6118249209390375,
      "AvUC": 0.41143081058146685
    },
    "hybrid": {
      "AUROC_error": 0.7409139023530742,
      "ECE": 0.03338314580515203,
      "ARC_area": 0.8168829633095732,
      "AvUC": 0.397976165407695
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.6842686595224666,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7162648054145516,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7512992506647329,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7853919909757473,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.8244500846023689,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.6423434856175972,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.6361304991539763,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.6299250664732898,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.6224971799210378,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.616751269035533,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.682294604248919,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7132772842639594,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7438361131254533,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.7760504794134235,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6493866328257191,
      "accuracy_after_rejection": 0.8118020304568528,
      "kept_count": 23640
    }
  ],
  "checkpoint_path": "./outputs\\tissuemnist_mobilenetv3_small_e50_bs64.pth"
}