{
  "config": {
    "dataset": "cifar100",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.425397373504639,
      "train_acc": 0.03508,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 4.082321430358887,
      "train_acc": 0.0624,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.9829944548034666,
      "train_acc": 0.077,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.829845387878418,
      "train_acc": 0.09996,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.8459087770843507,
      "train_acc": 0.10192,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.684875991516113,
      "train_acc": 0.12842,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.773570871429443,
      "train_acc": 0.11594,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 3.5838192734527587,
      "train_acc": 0.14572,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 3.674716128387451,
      "train_acc": 0.13774,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 3.6046576206207277,
      "train_acc": 0.14794,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 3.3844564608764647,
      "train_acc": 0.18204,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 3.3333252363586428,
      "train_acc": 0.19188,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 3.2964964499664307,
      "train_acc": 0.20092,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 3.223244245223999,
      "train_acc": 0.21542,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 3.2178420767211913,
      "train_acc": 0.21388,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 3.0784055066680907,
      "train_acc": 0.23796,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 3.0763173193359377,
      "train_acc": 0.23868,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.9629558871459962,
      "train_acc": 0.26002,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.910152145690918,
      "train_acc": 0.2719,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.816187711105347,
      "train_acc": 0.29038,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.7886320526885986,
      "train_acc": 0.2958,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.718884698867798,
      "train_acc": 0.30914,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.6950639918518067,
      "train_acc": 0.31452,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.590078188934326,
      "train_acc": 0.33692,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.544089631652832,
      "train_acc": 0.34764,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.469620204696655,
      "train_acc": 0.35894,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 2.4150971434021,
      "train_acc": 0.3732,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 2.3432094621276853,
      "train_acc": 0.38674,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 2.3350918158340455,
      "train_acc": 0.39104,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 2.2528226155853273,
      "train_acc": 0.40546,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 2.5426688957977297,
      "train_acc": 0.34984,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 2.227068800125122,
      "train_acc": 0.41322,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 2.1966194115447997,
      "train_acc": 0.42178,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 2.035046606903076,
      "train_acc": 0.45314,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.8807354711151123,
      "train_acc": 0.48804,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.7630719931793213,
      "train_acc": 0.51594,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.6522415880584718,
      "train_acc": 0.54116,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.5301746759796142,
      "train_acc": 0.57002,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.425535478286743,
      "train_acc": 0.59822,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.3087175733947753,
      "train_acc": 0.6277,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.1950756831359863,
      "train_acc": 0.65808,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 1.0672096856689453,
      "train_acc": 0.6915,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.9675855184173584,
      "train_acc": 0.71954,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.8718860285568237,
      "train_acc": 0.74792,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.774049591178894,
      "train_acc": 0.7765,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.7041446100616455,
      "train_acc": 0.79932,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.6551440106201172,
      "train_acc": 0.81338,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.612166890258789,
      "train_acc": 0.82812,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.5813512624740601,
      "train_acc": 0.838,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.5717211603164672,
      "train_acc": 0.84168,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3174,
    "test_loss": 40.22765617027283
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7642646975471488,
      "ECE": 0.28185931695774197,
      "ARC_area": 0.4966429907596006,
      "AvUC": 0.5042372994226313
    },
    "gradient": {
      "AUROC_error": 0.5049551771267833,
      "ECE": 0.28185931695774197,
      "ARC_area": 0.3316244503073284,
      "AvUC": 0.6758217884864325
    },
    "hybrid": {
      "AUROC_error": 0.780581738233165,
      "ECE": 0.28185931695774197,
      "ARC_area": 0.5412229901589233,
      "AvUC": 0.5900295440119313
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.3428888888888889,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.370625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.40085714285714286,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.43783333333333335,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.485,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.31377777777777777,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.31375,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.3127142857142857,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.31516666666666665,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.3158,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.343,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.3725,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.4025714285714286,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.442,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3174,
      "accuracy_after_rejection": 0.4884,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11615502089262009,
      0.17383551597595215,
      0.2358274608850479,
      0.30113497376441956,
      0.36699920892715454,
      0.4331943988800049,
      0.49978381395339966,
      0.566423773765564,
      0.6317031979560852,
      0.7001031637191772,
      0.7676405310630798,
      0.8332288861274719,
      0.9006384611129761,
      0.9807161688804626
    ],
    "bin_acc": [
      NaN,
      0.06896551698446274,
      0.08996539562940598,
      0.10294117778539658,
      0.11556603759527206,
      0.14146868884563446,
      0.1846153885126114,
      0.2108362764120102,
      0.2583547532558441,
      0.25525525212287903,
      0.329738050699234,
      0.3863636255264282,
      0.4375,
      0.5087719559669495,
      0.7068196535110474
    ],
    "bin_count": [
      0,
      29,
      289,
      680,
      848,
      926,
      910,
      849,
      778,
      666,
      649,
      572,
      608,
      627,
      1569
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        800,
        253,
        204,
        223,
        204,
        219,
        193,
        180,
        151,
        133,
        129,
        98,
        112,
        83,
        66,
        43,
        34,
        25,
        14,
        7,
        2,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        247,
        161,
        167,
        204,
        273,
        329,
        348,
        409,
        455,
        471,
        503,
        517,
        528,
        489,
        475,
        394,
        317,
        235,
        152,
        93,
        42,
        9,
        5,
        3,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3174,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        6702,
        0,
        0,
        0,
        1,
        0,
        3,
        2,
        11,
        9,
        7,
        8,
        7,
        10,
        10,
        14,
        6,
        9,
        8,
        1,
        1,
        4,
        3,
        4,
        4,
        0,
        1,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1041,
        426,
        423,
        378,
        288,
        224,
        197,
        110,
        63,
        20,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        274,
        371,
        591,
        765,
        935,
        1031,
        1042,
        900,
        578,
        258,
        60,
        15,
        4,
        1,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_efficientnetv2_s_e50_bs64.pth"
}