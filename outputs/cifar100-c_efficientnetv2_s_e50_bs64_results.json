{
  "config": {
    "dataset": "cifar100-c",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "label_smoothing": 0.1,
    "max_grad_norm": 1.0,
    "lr_efficientnet": 0.01,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [],
  "baseline": {
    "test_acc": 0.25682105263157895,
    "test_loss": 3.376700360408582
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.75638853755075,
      "ECE": 0.18669336853493987,
      "ARC_area": 0.44757569803206104,
      "AvUC": 0.44524778637258644
    },
    "gradient": {
      "AUROC_error": 0.6557273150959134,
      "ECE": 0.18669336853493987,
      "ARC_area": 0.38981035798106056,
      "AvUC": 0.7072891535052374
    },
    "hybrid": {
      "AUROC_error": 0.755576581684771,
      "ECE": 0.18669336853493987,
      "ARC_area": 0.44915580878954603,
      "AvUC": 0.576268469935832
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.2769941520467836,
      "kept_count": 171000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.29925,
      "kept_count": 152000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.3248045112781955,
      "kept_count": 133000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.35418421052631577,
      "kept_count": 114000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.3913473684210526,
      "kept_count": 95000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.26600584795321636,
      "kept_count": 171000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.27745394736842105,
      "kept_count": 152000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.2921127819548872,
      "kept_count": 133000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.3107017543859649,
      "kept_count": 114000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.33508421052631576,
      "kept_count": 95000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.2761929824561403,
      "kept_count": 171000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.29844736842105263,
      "kept_count": 152000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.32417293233082706,
      "kept_count": 133000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.35385087719298247,
      "kept_count": 114000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.25682105263157895,
      "accuracy_after_rejection": 0.3902421052631579,
      "kept_count": 95000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      0.06034144014120102,
      0.11311271041631699,
      0.16949020326137543,
      0.23357424139976501,
      0.29920706152915955,
      0.36560848355293274,
      0.43221190571784973,
      0.4988063871860504,
      0.5657944679260254,
      0.6322731375694275,
      0.6995431184768677,
      0.7662286758422852,
      0.8332509398460388,
      0.9006511569023132,
      0.9573550820350647
    ],
    "bin_acc": [
      0.02631578966975212,
      0.06251002103090286,
      0.08339451253414154,
      0.10986891388893127,
      0.1435958445072174,
      0.1815752387046814,
      0.21342289447784424,
      0.2529467046260834,
      0.2982514798641205,
      0.34231457114219666,
      0.3970588147640228,
      0.4646490514278412,
      0.5565500259399414,
      0.7084895372390747,
      0.8917425274848938
    ],
    "bin_count": [
      38,
      6239,
      20433,
      25403,
      24367,
      21330,
      17716,
      14932,
      11953,
      10058,
      8772,
      7765,
      7374,
      7468,
      6152
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        214,
        2253,
        3167,
        2695,
        2577,
        2471,
        2579,
        2645,
        2766,
        2743,
        2695,
        2714,
        2593,
        2571,
        2405,
        2250,
        2107,
        2017,
        1672,
        1353,
        997,
        675,
        358,
        182,
        68,
        26,
        3,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        35,
        174,
        541,
        936,
        1361,
        1833,
        2454,
        3129,
        3911,
        4898,
        5726,
        6579,
        7744,
        8504,
        9571,
        10722,
        11460,
        11949,
        12150,
        11429,
        9915,
        7492,
        4845,
        2504,
        985,
        319,
        38,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        11292,
        23617,
        12077,
        1621,
        142,
        29,
        8,
        7,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        7290,
        69019,
        56388,
        7431,
        538,
        105,
        51,
        72,
        57,
        55,
        36,
        27,
        20,
        18,
        5,
        8,
        9,
        10,
        13,
        15,
        11,
        7,
        6,
        8,
        3,
        0,
        0,
        0,
        1,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1067,
        4806,
        4529,
        4589,
        5024,
        4954,
        5045,
        4793,
        4351,
        3965,
        2940,
        1834,
        692,
        187,
        16,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        44,
        673,
        1892,
        3603,
        6014,
        8791,
        11879,
        15578,
        19155,
        22318,
        22757,
        17465,
        8547,
        2200,
        224,
        50,
        10,
        2,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100-c_efficientnetv2_s_e50_bs64.pth"
}