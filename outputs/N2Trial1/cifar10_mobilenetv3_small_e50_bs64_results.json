{
  "config": {
    "dataset": "cifar10",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.6627457175827027,
      "train_acc": 0.38408,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.4720260411071777,
      "train_acc": 0.46846,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.463798542251587,
      "train_acc": 0.47222,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.6020063621902465,
      "train_acc": 0.4157,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.5182226781463624,
      "train_acc": 0.44954,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.3915113745880128,
      "train_acc": 0.49896,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.4278868217468261,
      "train_acc": 0.48194,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.366139796333313,
      "train_acc": 0.50676,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.36642304397583,
      "train_acc": 0.50658,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.397006629447937,
      "train_acc": 0.496,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.3276656829071045,
      "train_acc": 0.52118,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.3180327926635742,
      "train_acc": 0.5244,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.2988344931411744,
      "train_acc": 0.53246,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.2734191411590576,
      "train_acc": 0.54464,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.2558110456085205,
      "train_acc": 0.54992,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.245530541305542,
      "train_acc": 0.55214,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.4073243384170533,
      "train_acc": 0.49414,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.4613333034896852,
      "train_acc": 0.46854,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.434694965133667,
      "train_acc": 0.48156,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.359344093132019,
      "train_acc": 0.50712,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.3274263792800904,
      "train_acc": 0.51814,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.2809947720336914,
      "train_acc": 0.5392,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.2171682413101197,
      "train_acc": 0.56192,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.141970626373291,
      "train_acc": 0.59094,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.109606791229248,
      "train_acc": 0.60408,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.069254178237915,
      "train_acc": 0.61878,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.0407536029052735,
      "train_acc": 0.63032,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.0135482711029054,
      "train_acc": 0.6405,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.9889374652481079,
      "train_acc": 0.64804,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9710213496017456,
      "train_acc": 0.65368,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9513821660995483,
      "train_acc": 0.66194,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9265187125015258,
      "train_acc": 0.67196,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.9092951020812988,
      "train_acc": 0.67662,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.8870247974586487,
      "train_acc": 0.6839,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.871561637802124,
      "train_acc": 0.6896,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.853633275680542,
      "train_acc": 0.69712,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.8338725886535645,
      "train_acc": 0.70356,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.8189685916519165,
      "train_acc": 0.70988,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.7994849706459045,
      "train_acc": 0.71684,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7888793189620972,
      "train_acc": 0.71992,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.7696743969726563,
      "train_acc": 0.72596,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.7556673988723754,
      "train_acc": 0.73228,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.7422456359100342,
      "train_acc": 0.73718,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.7243133046150207,
      "train_acc": 0.7447,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.7126676795196534,
      "train_acc": 0.7456,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.7024339416313171,
      "train_acc": 0.75156,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.692228306980133,
      "train_acc": 0.7529,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.6856264736557007,
      "train_acc": 0.75778,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.6754171414756774,
      "train_acc": 0.76012,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.677062190208435,
      "train_acc": 0.76082,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6603,
    "test_loss": 0.9973233168601989
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7784545307302044,
      "ECE": 0.07633191435486078,
      "ARC_area": 0.8443402476580937,
      "AvUC": 0.3455032392479705
    },
    "gradient": {
      "AUROC_error": 0.41262874106831215,
      "ECE": 0.07633191435486078,
      "ARC_area": 0.606537012577792,
      "AvUC": 0.3760288125909312
    },
    "hybrid": {
      "AUROC_error": 0.7710396577571921,
      "ECE": 0.07633191435486078,
      "ARC_area": 0.8403733434164798,
      "AvUC": 0.3607660257772775
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6993333333333334,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.735625,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.7725714285714286,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.8078333333333333,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.8458,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6484444444444445,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.637125,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6234285714285714,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6106666666666667,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6002,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.6981111111111111,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.732125,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.7688571428571429,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.8051666666666667,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6603,
      "accuracy_after_rejection": 0.8408,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.18898867070674896,
      0.24287724494934082,
      0.3056171238422394,
      0.36819469928741455,
      0.4350084364414215,
      0.5000156760215759,
      0.5661892294883728,
      0.6323040723800659,
      0.7003450989723206,
      0.7669182419776917,
      0.8329891562461853,
      0.9023181200027466,
      0.9783230423927307
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.5,
      0.29870128631591797,
      0.24904213845729828,
      0.2975206673145294,
      0.3757961690425873,
      0.46347305178642273,
      0.48191213607788086,
      0.5181818008422852,
      0.6061415076255798,
      0.6461336612701416,
      0.7273809313774109,
      0.7893231511116028,
      0.9356471300125122
    ],
    "bin_count": [
      0,
      0,
      4,
      77,
      261,
      484,
      628,
      835,
      774,
      770,
      749,
      763,
      840,
      1049,
      2766
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1204,
        571,
        431,
        396,
        345,
        277,
        292,
        297,
        293,
        334,
        283,
        249,
        250,
        226,
        207,
        207,
        207,
        117,
        126,
        89,
        65,
        41,
        36,
        29,
        16,
        5,
        7,
        2,
        1,
        0
      ],
      "incorrect_counts": [
        25,
        48,
        46,
        63,
        74,
        79,
        95,
        126,
        138,
        195,
        188,
        172,
        177,
        208,
        229,
        228,
        229,
        210,
        202,
        182,
        136,
        112,
        91,
        65,
        42,
        21,
        12,
        3,
        1,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        165,
        1378,
        2041,
        1814,
        859,
        247,
        51,
        8,
        5,
        6,
        7,
        4,
        2,
        3,
        0,
        4,
        3,
        0,
        1,
        0,
        0,
        0,
        2,
        2,
        0,
        0,
        0,
        0,
        0,
        1
      ],
      "incorrect_counts": [
        120,
        995,
        1195,
        703,
        293,
        70,
        18,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        106,
        833,
        1119,
        774,
        666,
        646,
        611,
        499,
        471,
        386,
        234,
        139,
        70,
        31,
        15,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        1,
        26,
        83,
        156,
        188,
        312,
        355,
        391,
        455,
        473,
        379,
        300,
        174,
        79,
        19,
        6,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_mobilenetv3_small_e50_bs64.pth"
}