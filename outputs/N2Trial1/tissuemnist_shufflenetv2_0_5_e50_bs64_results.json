{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.42373042163803,
      "train_acc": 0.4895990717126177,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.2652482591689107,
      "train_acc": 0.5299215548813654,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.217442595632924,
      "train_acc": 0.5459369296411347,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.2038206143782835,
      "train_acc": 0.5522222087921386,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.1615987957448228,
      "train_acc": 0.5653245984069235,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.1383551231139002,
      "train_acc": 0.5773935430843798,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.124990176997772,
      "train_acc": 0.5840353909564503,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.1146696595677454,
      "train_acc": 0.5874741638765668,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1080275229892567,
      "train_acc": 0.5896740115794181,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.104441466097827,
      "train_acc": 0.5918919898952051,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.093329386362252,
      "train_acc": 0.5965032091184896,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.0835817223548625,
      "train_acc": 0.6007699466959979,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.0759525982919447,
      "train_acc": 0.6024863113872336,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.0706880439241746,
      "train_acc": 0.605242164553443,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.064245415957492,
      "train_acc": 0.6075145347080367,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.058182209020149,
      "train_acc": 0.6099621674543411,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0527924098509496,
      "train_acc": 0.611811489973771,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0486676300348488,
      "train_acc": 0.6129960233522295,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.0434988040809838,
      "train_acc": 0.6145431689893996,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.0390139781304701,
      "train_acc": 0.6160298792501179,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0335926045417072,
      "train_acc": 0.6198493950418817,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.030115570097327,
      "train_acc": 0.6201999202253031,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.026816462235759,
      "train_acc": 0.6214932372813751,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.019108053599977,
      "train_acc": 0.6250226632661695,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.01702101745913,
      "train_acc": 0.6266725490433079,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.0104278855619866,
      "train_acc": 0.6273735994101507,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.0042394261490253,
      "train_acc": 0.6304799777597815,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.9966506306595103,
      "train_acc": 0.6338522717658008,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.9914796493377723,
      "train_acc": 0.6344626690679657,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9854735412495987,
      "train_acc": 0.6371218256318518,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9803730114551857,
      "train_acc": 0.6386145794302153,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9720430890157629,
      "train_acc": 0.6417270013174912,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.9660693596420697,
      "train_acc": 0.6446399864624757,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.9586255360777588,
      "train_acc": 0.6462052627125814,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.9515337190012157,
      "train_acc": 0.649305597524567,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.9413598561451765,
      "train_acc": 0.6529317201116845,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.9342924812445146,
      "train_acc": 0.6560683161495413,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9253391442715537,
      "train_acc": 0.6585824278099428,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9150593034738372,
      "train_acc": 0.6625409449675462,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9046041779321417,
      "train_acc": 0.6671884254167019,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.8942174033059425,
      "train_acc": 0.6708447656920455,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.8839524225161131,
      "train_acc": 0.6741445372463225,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.8709490801908726,
      "train_acc": 0.6786771904802195,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.8586485230465792,
      "train_acc": 0.6838685893174429,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.8473013031955742,
      "train_acc": 0.6872711010116882,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.8345050929711765,
      "train_acc": 0.692444369235976,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.8230046877573364,
      "train_acc": 0.6974423748685531,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.8121667972463512,
      "train_acc": 0.7010443233050899,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.8047499728426446,
      "train_acc": 0.704779229569821,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.8009760684993726,
      "train_acc": 0.7048215343333374,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6355118443316413,
    "test_loss": 1.0165663857145357
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7516635126139671,
      "ECE": 0.05674650534394932,
      "ARC_area": 0.813554958589449,
      "AvUC": 0.3838159139261329
    },
    "gradient": {
      "AUROC_error": 0.4713704723776615,
      "ECE": 0.05674650534394932,
      "ARC_area": 0.6074749282622129,
      "AvUC": 0.4299312228512538
    },
    "hybrid": {
      "AUROC_error": 0.7240717023551823,
      "ECE": 0.05674650534394932,
      "ARC_area": 0.7977208191036531,
      "AvUC": 0.406873568445649
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6697687535250987,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7023847292724196,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7357082426879381,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7722081218274112,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.8085871404399323,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6324497085918406,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6303140862944162,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6274776408025139,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6238014664410604,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6188240270727581,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6636585824403083,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.6918358714043993,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7232898235436307,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7554991539763113,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6355118443316413,
      "accuracy_after_rejection": 0.7923434856175973,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      NaN,
      0.2440180480480194,
      0.30571284890174866,
      0.3694995641708374,
      0.43525218963623047,
      0.5000805258750916,
      0.5663087964057922,
      0.6328734755516052,
      0.6999296545982361,
      0.7670426964759827,
      0.8339119553565979,
      0.9013051986694336,
      0.9728090763092041
    ],
    "bin_acc": [
      NaN,
      NaN,
      NaN,
      0.2631579041481018,
      0.28450268507003784,
      0.3302273452281952,
      0.39163970947265625,
      0.4511791467666626,
      0.5060948133468628,
      0.5691948533058167,
      0.6241610646247864,
      0.6839795112609863,
      0.7536670565605164,
      0.8346555233001709,
      0.9383345246315002
    ],
    "bin_count": [
      0,
      0,
      0,
      285,
      1297,
      2683,
      4019,
      4834,
      4430,
      4285,
      4023,
      4101,
      4295,
      4790,
      8238
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        2187,
        1840,
        1620,
        1431,
        1400,
        1350,
        1297,
        1350,
        1363,
        1430,
        1558,
        1496,
        1537,
        1463,
        1461,
        1412,
        1278,
        1043,
        853,
        709,
        545,
        416,
        365,
        250,
        158,
        135,
        63,
        25,
        12,
        0
      ],
      "incorrect_counts": [
        51,
        88,
        113,
        175,
        203,
        222,
        304,
        362,
        444,
        511,
        664,
        921,
        983,
        1017,
        1165,
        1341,
        1303,
        1325,
        1167,
        1039,
        878,
        791,
        635,
        551,
        416,
        289,
        188,
        75,
        12,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        117,
        775,
        2019,
        3038,
        3777,
        3885,
        3766,
        3286,
        2629,
        2067,
        1456,
        1031,
        726,
        493,
        322,
        227,
        173,
        92,
        55,
        38,
        20,
        22,
        10,
        11,
        6,
        3,
        2,
        0,
        0,
        1
      ],
      "incorrect_counts": [
        97,
        694,
        1452,
        1952,
        2112,
        2164,
        2010,
        1791,
        1425,
        1133,
        762,
        531,
        357,
        277,
        158,
        112,
        65,
        45,
        28,
        21,
        19,
        12,
        7,
        5,
        1,
        1,
        1,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        9,
        339,
        1343,
        2019,
        2432,
        2484,
        2620,
        2823,
        2658,
        2918,
        2844,
        2542,
        1979,
        1350,
        818,
        473,
        234,
        98,
        42,
        13,
        5,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        12,
        55,
        125,
        253,
        451,
        649,
        920,
        1335,
        1732,
        2244,
        2570,
        2356,
        1814,
        1320,
        746,
        375,
        180,
        63,
        19,
        9,
        4,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_shufflenetv2_0_5_e50_bs64.pth"
}