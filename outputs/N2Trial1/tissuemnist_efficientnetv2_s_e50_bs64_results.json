{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "efficientnetv2_s",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.6545377982681029,
      "train_acc": 0.4273264598165182,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.3968460245600909,
      "train_acc": 0.48616029879250117,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.3749432425946042,
      "train_acc": 0.48771348796731656,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.3406171470009849,
      "train_acc": 0.4976369767807284,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3458064440643005,
      "train_acc": 0.5013537524325239,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.2876136200183605,
      "train_acc": 0.5181970918496851,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.380893550414161,
      "train_acc": 0.48345883746509855,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.374685308646607,
      "train_acc": 0.48991333567016787,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.3062829631911446,
      "train_acc": 0.5124013392479422,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.2538952440401296,
      "train_acc": 0.5299699031825269,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.2300547868265177,
      "train_acc": 0.5380863742400251,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1751186319282978,
      "train_acc": 0.5584349654914,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.1367187780858603,
      "train_acc": 0.5759853988130492,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.10536501521252,
      "train_acc": 0.5896921421923537,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0744168702269603,
      "train_acc": 0.6029516637859137,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.0521480652090416,
      "train_acc": 0.6128811961369708,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0325049712331624,
      "train_acc": 0.6192450412773621,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0139582775464846,
      "train_acc": 0.6274279912489575,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 0.9964779372150891,
      "train_acc": 0.6351999806606795,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 0.9832135490517397,
      "train_acc": 0.6392068461194444,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 0.9695872164584669,
      "train_acc": 0.6446883347636373,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.9557378030158454,
      "train_acc": 0.649245162148115,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.9415344695150532,
      "train_acc": 0.6546239106523395,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.9300380196828174,
      "train_acc": 0.659325782940302,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.9185821179142905,
      "train_acc": 0.664571573616332,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.9058167399746057,
      "train_acc": 0.6690014867102607,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.8938658964466366,
      "train_acc": 0.6727061752867659,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.8840031180218608,
      "train_acc": 0.6767553455090471,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.8701293076898625,
      "train_acc": 0.681312172893525,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.859728742455306,
      "train_acc": 0.6861228288591009,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.8460393855980758,
      "train_acc": 0.6904862630389325,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.8339711766507067,
      "train_acc": 0.6964572782323861,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.8206696066491493,
      "train_acc": 0.7001680103465364,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.8057871523867168,
      "train_acc": 0.7081031752746788,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.7917599271398311,
      "train_acc": 0.7115177740442146,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.777888511982584,
      "train_acc": 0.7163465606227262,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.760739884267825,
      "train_acc": 0.7231455404735716,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.743682371641095,
      "train_acc": 0.729509385613963,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.725435660362284,
      "train_acc": 0.7371061124339744,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.7056399396406955,
      "train_acc": 0.7438809181342391,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.6865364160002054,
      "train_acc": 0.7507645075121173,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.663065917380993,
      "train_acc": 0.7602407745397846,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.6403609877643736,
      "train_acc": 0.7690039041253188,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.6175350811384561,
      "train_acc": 0.7776582500332394,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.5930736341403589,
      "train_acc": 0.7877630449760071,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.5685788992518013,
      "train_acc": 0.7962844330557335,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.549017109222423,
      "train_acc": 0.8037784197357766,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.5299390453140621,
      "train_acc": 0.8120036744708883,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.5160498941760072,
      "train_acc": 0.8164819358659785,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.5085670621580151,
      "train_acc": 0.8206761509917445,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6466159052453468,
    "test_loss": 1.1110046905511124
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7574361511098686,
      "ECE": 0.13636241414774897,
      "ARC_area": 0.8229186910476238,
      "AvUC": 0.3496481416064677
    },
    "gradient": {
      "AUROC_error": 0.5546064910533065,
      "ECE": 0.13636241414774897,
      "ARC_area": 0.6927349376315717,
      "AvUC": 0.42334346162203307
    },
    "hybrid": {
      "AUROC_error": 0.7389384045609542,
      "ECE": 0.13636241414774897,
      "ARC_area": 0.8110534263216663,
      "AvUC": 0.3864958016191783
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6830936266215454,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.7174016497461929,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.7512992506647329,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.785815002820079,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.8230964467005076,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6512502350065802,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6570695854483926,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6634336475707034,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6729060913705583,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6835448392554991,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.6802030456852792,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.7103162013536379,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.7434735315445975,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.7765087422447828,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6466159052453468,
      "accuracy_after_rejection": 0.8110406091370559,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.19094432890415192,
      0.24614888429641724,
      0.3048895299434662,
      0.3702322244644165,
      0.43587976694107056,
      0.5016733407974243,
      0.5659118890762329,
      0.6339597702026367,
      0.7000043392181396,
      0.7677493095397949,
      0.8347201943397522,
      0.9023879766464233,
      0.979736328125
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.0,
      0.23595505952835083,
      0.24593496322631836,
      0.30519479513168335,
      0.3296296298503876,
      0.39173048734664917,
      0.4495834410190582,
      0.474266916513443,
      0.5199069976806641,
      0.5910058617591858,
      0.6443612575531006,
      0.7092880606651306,
      0.8793910145759583
    ],
    "bin_count": [
      0,
      0,
      2,
      89,
      492,
      1232,
      2160,
      3265,
      3481,
      3342,
      3441,
      3758,
      4274,
      5717,
      16027
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        6871,
        2821,
        2197,
        1761,
        1626,
        1448,
        1411,
        1247,
        1241,
        1357,
        1476,
        1194,
        1079,
        911,
        798,
        707,
        655,
        472,
        352,
        282,
        213,
        160,
        99,
        78,
        54,
        30,
        20,
        11,
        1,
        0
      ],
      "incorrect_counts": [
        391,
        423,
        464,
        494,
        523,
        576,
        620,
        654,
        770,
        899,
        1164,
        1050,
        1075,
        1004,
        1029,
        990,
        920,
        797,
        671,
        521,
        467,
        365,
        293,
        231,
        141,
        94,
        58,
        17,
        7,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        23,
        177,
        816,
        1815,
        2925,
        3853,
        4117,
        4027,
        3408,
        2791,
        2076,
        1438,
        994,
        731,
        466,
        322,
        233,
        140,
        88,
        43,
        33,
        22,
        12,
        9,
        9,
        1,
        1,
        1,
        1,
        0
      ],
      "incorrect_counts": [
        3,
        54,
        246,
        573,
        1189,
        1817,
        2267,
        2285,
        2183,
        1769,
        1292,
        1009,
        685,
        465,
        334,
        207,
        116,
        84,
        47,
        30,
        22,
        8,
        10,
        4,
        5,
        1,
        0,
        1,
        1,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        99,
        1008,
        2371,
        3237,
        3355,
        3147,
        2914,
        2726,
        2498,
        2324,
        1989,
        1662,
        1264,
        840,
        502,
        304,
        190,
        73,
        45,
        16,
        6,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2,
        32,
        152,
        365,
        593,
        804,
        1009,
        1329,
        1595,
        1814,
        1921,
        1895,
        1559,
        1317,
        944,
        651,
        372,
        204,
        99,
        33,
        9,
        7,
        0,
        1,
        1,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_efficientnetv2_s_e50_bs64.pth"
}