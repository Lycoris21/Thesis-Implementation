{
  "config": {
    "dataset": "tinyimagenet",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 4.63839451133728,
      "train_acc": 0.059,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.921801488265991,
      "train_acc": 0.14197,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.6058429662323,
      "train_acc": 0.18948,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.419937195663452,
      "train_acc": 0.22108,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.2754518114471436,
      "train_acc": 0.24731,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.1647961138916014,
      "train_acc": 0.2666,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 3.070716122817993,
      "train_acc": 0.28169,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.993027309036255,
      "train_acc": 0.29694,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.9223498766326905,
      "train_acc": 0.30986,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.862791389541626,
      "train_acc": 0.32088,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.801136196746826,
      "train_acc": 0.33246,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.7461980061340334,
      "train_acc": 0.34276,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.691663675842285,
      "train_acc": 0.35495,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.6384880073547365,
      "train_acc": 0.36372,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.596562105026245,
      "train_acc": 0.36991,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.5421040328216553,
      "train_acc": 0.38299,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.497874184875488,
      "train_acc": 0.388,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.447471995010376,
      "train_acc": 0.39716,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.3978488238525393,
      "train_acc": 0.41002,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.349930223312378,
      "train_acc": 0.41806,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.3013055239105227,
      "train_acc": 0.4281,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 2.2507101364135744,
      "train_acc": 0.43766,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 2.196741905441284,
      "train_acc": 0.44904,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 2.1470409938812254,
      "train_acc": 0.45849,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 2.0925535207366943,
      "train_acc": 0.47026,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 2.0401717348098756,
      "train_acc": 0.48047,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.9848564185333253,
      "train_acc": 0.49213,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.9251715196228028,
      "train_acc": 0.50444,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.8644817595672607,
      "train_acc": 0.51909,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.8007820513916015,
      "train_acc": 0.5316,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.7356567168426513,
      "train_acc": 0.54613,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.6692144938659668,
      "train_acc": 0.56213,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.6010278695297242,
      "train_acc": 0.57788,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.5306978106307982,
      "train_acc": 0.59372,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.4560348406982422,
      "train_acc": 0.6133,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.3814561988067626,
      "train_acc": 0.63122,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.3074003456497192,
      "train_acc": 0.65062,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.2330490560913085,
      "train_acc": 0.66914,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 1.1574787244796754,
      "train_acc": 0.68975,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 1.0814001514053344,
      "train_acc": 0.7119,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 1.0159667128562928,
      "train_acc": 0.7304,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.9479131170654297,
      "train_acc": 0.75175,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.8941356524658203,
      "train_acc": 0.76587,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.8368980136489869,
      "train_acc": 0.78524,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.7973962545394897,
      "train_acc": 0.79993,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.7556256891441345,
      "train_acc": 0.81189,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.7218524401855468,
      "train_acc": 0.82331,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.7009789930152893,
      "train_acc": 0.83059,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.6915069344711303,
      "train_acc": 0.83339,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.6775002516746521,
      "train_acc": 0.83828,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.3339,
    "test_loss": 3.4298886009216307
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7893586457743349,
      "ECE": 0.22183117804825303,
      "ARC_area": 0.5675757170409435,
      "AvUC": 0.48571432690348354
    },
    "gradient": {
      "AUROC_error": 0.4427266770645435,
      "ECE": 0.22183117804825303,
      "ARC_area": 0.2986578419520328,
      "AvUC": 0.5655123134516645
    },
    "hybrid": {
      "AUROC_error": 0.7059148524224028,
      "ECE": 0.22183117804825303,
      "ARC_area": 0.4978913655948418,
      "AvUC": 0.5256133201487362
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.3615555555555556,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.3925,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.4277142857142857,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.4665,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.5142,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.323,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.31475,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.30885714285714283,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.30233333333333334,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.2926,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.3526666666666667,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.374375,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.4002857142857143,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.43016666666666664,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.3339,
      "accuracy_after_rejection": 0.4658,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11653345823287964,
      0.16983245313167572,
      0.2341993898153305,
      0.29992398619651794,
      0.36683937907218933,
      0.431972473859787,
      0.4995363652706146,
      0.5657212734222412,
      0.6327290534973145,
      0.6997307538986206,
      0.7673379778862,
      0.8335965275764465,
      0.9025470614433289,
      0.9775602221488953
    ],
    "bin_acc": [
      NaN,
      0.04672897234559059,
      0.07547169923782349,
      0.09856035560369492,
      0.14541833102703094,
      0.16099999845027924,
      0.23595505952835083,
      0.27272728085517883,
      0.2675250470638275,
      0.31410256028175354,
      0.3721804618835449,
      0.40229883790016174,
      0.4835766553878784,
      0.5827465057373047,
      0.8372985124588013
    ],
    "bin_count": [
      0,
      107,
      530,
      903,
      1004,
      1000,
      890,
      770,
      699,
      624,
      532,
      522,
      548,
      568,
      1303
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        749,
        331,
        251,
        215,
        208,
        199,
        201,
        164,
        174,
        165,
        142,
        125,
        126,
        84,
        62,
        65,
        40,
        21,
        13,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        76,
        129,
        156,
        191,
        229,
        282,
        331,
        399,
        429,
        468,
        513,
        496,
        571,
        511,
        525,
        475,
        352,
        246,
        165,
        85,
        24,
        7,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        2,
        13,
        31,
        60,
        122,
        183,
        264,
        275,
        316,
        290,
        333,
        261,
        243,
        211,
        173,
        138,
        107,
        80,
        77,
        51,
        36,
        21,
        20,
        11,
        6,
        8,
        3,
        3,
        1,
        0
      ],
      "incorrect_counts": [
        8,
        27,
        79,
        175,
        321,
        457,
        597,
        670,
        704,
        658,
        598,
        505,
        453,
        360,
        284,
        210,
        165,
        118,
        66,
        72,
        44,
        27,
        20,
        18,
        8,
        6,
        6,
        1,
        1,
        3
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        7,
        78,
        163,
        280,
        361,
        399,
        408,
        389,
        344,
        283,
        216,
        167,
        109,
        71,
        36,
        16,
        5,
        4,
        2,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2,
        2,
        15,
        49,
        127,
        225,
        361,
        561,
        749,
        848,
        904,
        854,
        727,
        551,
        324,
        171,
        91,
        59,
        26,
        6,
        6,
        2,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tinyimagenet_shufflenetv2_0_5_e50_bs64.pth"
}