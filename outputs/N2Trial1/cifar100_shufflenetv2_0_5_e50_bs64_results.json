{
  "config": {
    "dataset": "cifar100",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 3.9952875631713867,
      "train_acc": 0.08446,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 3.5404945558166503,
      "train_acc": 0.14794,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 3.5192976863098147,
      "train_acc": 0.15572,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 3.354705891189575,
      "train_acc": 0.18242,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 3.2022856981658934,
      "train_acc": 0.20848,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 3.059665764389038,
      "train_acc": 0.23578,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 2.965767581253052,
      "train_acc": 0.25394,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 2.8391353831481934,
      "train_acc": 0.27916,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 2.7487799380493163,
      "train_acc": 0.29534,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 2.667140856781006,
      "train_acc": 0.31094,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 2.5820040798950195,
      "train_acc": 0.32792,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 2.515924341659546,
      "train_acc": 0.34394,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 2.454754959716797,
      "train_acc": 0.35452,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 2.3944988088989256,
      "train_acc": 0.36966,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 2.3315915074539184,
      "train_acc": 0.38264,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 2.283298459472656,
      "train_acc": 0.39058,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 2.2376190042877195,
      "train_acc": 0.40252,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 2.1818913988494875,
      "train_acc": 0.41188,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 2.1314704399871824,
      "train_acc": 0.42326,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 2.0812002178192137,
      "train_acc": 0.43452,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 2.0261757494354247,
      "train_acc": 0.44702,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.9773658041381836,
      "train_acc": 0.45762,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.9211149256134032,
      "train_acc": 0.4714,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.876633533859253,
      "train_acc": 0.4814,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.8167750455474854,
      "train_acc": 0.4973,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 1.7632196129608155,
      "train_acc": 0.50818,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 1.7124612120056153,
      "train_acc": 0.51828,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 1.6525923272705079,
      "train_acc": 0.53272,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 1.600377091293335,
      "train_acc": 0.54516,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 1.5379469174194336,
      "train_acc": 0.56092,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 1.4760419689559936,
      "train_acc": 0.5756,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 1.4154151235961914,
      "train_acc": 0.59232,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 1.349871125640869,
      "train_acc": 0.61288,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 1.2858130752563477,
      "train_acc": 0.62796,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 1.2153400379180908,
      "train_acc": 0.64738,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 1.1526017440032958,
      "train_acc": 0.66382,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 1.0949057772827149,
      "train_acc": 0.67968,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 1.0326979437255859,
      "train_acc": 0.69816,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9756634693527222,
      "train_acc": 0.71718,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9079657271194458,
      "train_acc": 0.73562,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.8592469115066528,
      "train_acc": 0.75202,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.802900199432373,
      "train_acc": 0.77004,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.7680782273101807,
      "train_acc": 0.78104,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.7240010403823852,
      "train_acc": 0.79542,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.6879239670944214,
      "train_acc": 0.81164,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.659356920928955,
      "train_acc": 0.82116,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.64114048412323,
      "train_acc": 0.82822,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.6288225604629517,
      "train_acc": 0.83114,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.6175261636734009,
      "train_acc": 0.83764,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.6113191969299316,
      "train_acc": 0.83776,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.393,
    "test_loss": 2.770118629074097
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7970945206685363,
      "ECE": 0.19667341172099112,
      "ARC_area": 0.6375734898993136,
      "AvUC": 0.4543232484521319
    },
    "gradient": {
      "AUROC_error": 0.4917546143172739,
      "ECE": 0.19667341172099112,
      "ARC_area": 0.3895631197838186,
      "AvUC": 0.5552756516589783
    },
    "hybrid": {
      "AUROC_error": 0.7485653801493182,
      "ECE": 0.19667341172099112,
      "ARC_area": 0.5938370260164922,
      "AvUC": 0.5047994500309229
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.4258888888888889,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.46125,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.5002857142857143,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.5443333333333333,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.5996,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.3884444444444444,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.389875,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.38785714285714284,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.38533333333333336,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.389,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.41855555555555557,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.448625,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.48442857142857143,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.5258333333333334,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.393,
      "accuracy_after_rejection": 0.5722,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      0.11932525783777237,
      0.17117011547088623,
      0.23709636926651,
      0.3010977804660797,
      0.36777275800704956,
      0.4327271580696106,
      0.4988870322704315,
      0.5654850602149963,
      0.6336188316345215,
      0.6981893181800842,
      0.7668087482452393,
      0.8339303135871887,
      0.9007191061973572,
      0.9772965908050537
    ],
    "bin_acc": [
      NaN,
      0.07692307978868484,
      0.07260726392269135,
      0.13215859234333038,
      0.1376248598098755,
      0.178870290517807,
      0.23529411852359772,
      0.25200459361076355,
      0.3182423412799835,
      0.3729323446750641,
      0.4267912805080414,
      0.5210084319114685,
      0.5694227814674377,
      0.645550549030304,
      0.8892128467559814
    ],
    "bin_count": [
      0,
      39,
      303,
      681,
      901,
      956,
      918,
      873,
      751,
      665,
      642,
      595,
      641,
      663,
      1372
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        774,
        374,
        300,
        244,
        283,
        261,
        259,
        222,
        215,
        178,
        152,
        157,
        135,
        120,
        92,
        63,
        39,
        37,
        11,
        4,
        7,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        33,
        87,
        119,
        165,
        224,
        222,
        310,
        314,
        378,
        413,
        463,
        497,
        480,
        524,
        476,
        422,
        335,
        258,
        202,
        92,
        37,
        18,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        6,
        54,
        170,
        263,
        392,
        484,
        482,
        460,
        412,
        338,
        264,
        181,
        137,
        109,
        64,
        36,
        28,
        19,
        13,
        8,
        2,
        4,
        2,
        0,
        2,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        19,
        79,
        258,
        420,
        594,
        757,
        799,
        755,
        611,
        514,
        425,
        286,
        201,
        128,
        95,
        45,
        37,
        17,
        17,
        6,
        3,
        2,
        0,
        1,
        0,
        0,
        0,
        0,
        0,
        1
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        4,
        77,
        259,
        415,
        497,
        521,
        505,
        435,
        359,
        295,
        184,
        159,
        101,
        63,
        25,
        20,
        6,
        2,
        3,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        9,
        40,
        115,
        221,
        366,
        495,
        645,
        760,
        844,
        757,
        675,
        561,
        295,
        166,
        74,
        32,
        9,
        4,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar100_shufflenetv2_0_5_e50_bs64.pth"
}