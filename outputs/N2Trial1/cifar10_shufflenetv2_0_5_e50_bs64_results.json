{
  "config": {
    "dataset": "cifar10",
    "model_name": "shufflenetv2_0_5",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.9725518059539795,
      "train_acc": 0.30448,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.5688277468490601,
      "train_acc": 0.4254,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.6125357357788086,
      "train_acc": 0.40798,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.466328491744995,
      "train_acc": 0.46544,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.3516150165939331,
      "train_acc": 0.5106,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.3100101922607421,
      "train_acc": 0.52852,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.3451400201416015,
      "train_acc": 0.5169,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.251032397956848,
      "train_acc": 0.55154,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.210131221923828,
      "train_acc": 0.56832,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.1951000260543823,
      "train_acc": 0.5756,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1358123962020874,
      "train_acc": 0.5965,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.142132910118103,
      "train_acc": 0.59478,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.0886456772232056,
      "train_acc": 0.61532,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.0421186340713502,
      "train_acc": 0.633,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.001391566181183,
      "train_acc": 0.64462,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 0.9598052392196655,
      "train_acc": 0.66062,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 0.9488557316207886,
      "train_acc": 0.66644,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 0.9312341545104981,
      "train_acc": 0.67012,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 0.8853531427001953,
      "train_acc": 0.6842,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 0.8638992256546021,
      "train_acc": 0.69576,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 0.8390610934066772,
      "train_acc": 0.70438,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 0.8214681411743164,
      "train_acc": 0.70796,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 0.8369721975708008,
      "train_acc": 0.70288,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 0.7861952251052856,
      "train_acc": 0.72228,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 0.7663016558074951,
      "train_acc": 0.72858,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.7434121303939819,
      "train_acc": 0.73652,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.7277393453407287,
      "train_acc": 0.74098,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.7089378713989258,
      "train_acc": 0.74732,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.6850081678771973,
      "train_acc": 0.755,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.6634715913391114,
      "train_acc": 0.7644,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.6481345352554321,
      "train_acc": 0.76876,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.6231199795150757,
      "train_acc": 0.77756,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.5978086840629577,
      "train_acc": 0.78804,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.580603225517273,
      "train_acc": 0.79324,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.5596752245664597,
      "train_acc": 0.79988,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.5276063529586792,
      "train_acc": 0.8126,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.500737102394104,
      "train_acc": 0.82198,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.4774654822921753,
      "train_acc": 0.82924,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.44857346864700315,
      "train_acc": 0.8393,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.42281830748558047,
      "train_acc": 0.84862,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.3961740652656555,
      "train_acc": 0.85954,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.3649907761001587,
      "train_acc": 0.8718,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.33702594813346864,
      "train_acc": 0.88052,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.30970239350318907,
      "train_acc": 0.89126,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.2925127991294861,
      "train_acc": 0.89806,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.27405615512847903,
      "train_acc": 0.90442,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.25481409938812255,
      "train_acc": 0.91338,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.2485171659564972,
      "train_acc": 0.91412,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.2409216991710663,
      "train_acc": 0.91718,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.23757850109100342,
      "train_acc": 0.9183,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6897,
    "test_loss": 1.1586152835845946
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.8029899785485906,
      "ECE": 0.1617038664072752,
      "ARC_area": 0.8728678821122762,
      "AvUC": 0.295248758033354
    },
    "gradient": {
      "AUROC_error": 0.5207737665276057,
      "ECE": 0.1617038664072752,
      "ARC_area": 0.7027162382485744,
      "AvUC": 0.37985187189936404
    },
    "hybrid": {
      "AUROC_error": 0.7753655825455458,
      "ECE": 0.1617038664072752,
      "ARC_area": 0.853769141190794,
      "AvUC": 0.3375503148889169
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.7323333333333333,
      "kept_count": 9000
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.76975,
      "kept_count": 8000
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.8121428571428572,
      "kept_count": 7000
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.853,
      "kept_count": 6000
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.8882,
      "kept_count": 5000
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.6922222222222222,
      "kept_count": 9000
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.6945,
      "kept_count": 8000
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.6972857142857143,
      "kept_count": 7000
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.7008333333333333,
      "kept_count": 6000
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.7044,
      "kept_count": 5000
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.731,
      "kept_count": 9000
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.76625,
      "kept_count": 8000
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.8041428571428572,
      "kept_count": 7000
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.841,
      "kept_count": 6000
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6897,
      "accuracy_after_rejection": 0.8692,
      "kept_count": 5000
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      NaN,
      0.2498323917388916,
      0.30332672595977783,
      0.37044113874435425,
      0.43555134534835815,
      0.5032917261123657,
      0.5654363036155701,
      0.6335198283195496,
      0.7025922536849976,
      0.767535388469696,
      0.8342205286026001,
      0.9019653797149658,
      0.9875117540359497
    ],
    "bin_acc": [
      NaN,
      NaN,
      NaN,
      0.25,
      0.3396226465702057,
      0.270114928483963,
      0.2789115607738495,
      0.3712446391582489,
      0.3763919770717621,
      0.46611911058425903,
      0.46875,
      0.4889267385005951,
      0.5389049053192139,
      0.6504064798355103,
      0.8764172196388245
    ],
    "bin_count": [
      0,
      0,
      0,
      8,
      53,
      174,
      294,
      466,
      449,
      487,
      512,
      587,
      694,
      984,
      5292
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        3392,
        614,
        393,
        303,
        283,
        258,
        218,
        206,
        230,
        200,
        172,
        137,
        118,
        88,
        72,
        54,
        39,
        34,
        36,
        24,
        14,
        3,
        5,
        2,
        1,
        1,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        241,
        167,
        133,
        137,
        128,
        150,
        157,
        174,
        233,
        243,
        196,
        185,
        141,
        149,
        155,
        116,
        98,
        97,
        74,
        48,
        33,
        22,
        16,
        8,
        1,
        1,
        0,
        0,
        0,
        0
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        26,
        157,
        549,
        1096,
        1299,
        1208,
        910,
        629,
        408,
        253,
        158,
        88,
        48,
        28,
        19,
        7,
        6,
        2,
        2,
        0,
        1,
        0,
        0,
        0,
        1,
        0,
        0,
        1,
        0,
        1
      ],
      "incorrect_counts": [
        7,
        72,
        224,
        456,
        530,
        561,
        443,
        299,
        215,
        133,
        74,
        37,
        20,
        18,
        4,
        4,
        0,
        4,
        1,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        95,
        852,
        1443,
        1218,
        910,
        635,
        513,
        395,
        315,
        215,
        141,
        69,
        57,
        23,
        8,
        5,
        1,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        2,
        49,
        155,
        208,
        293,
        313,
        383,
        391,
        355,
        299,
        245,
        184,
        116,
        63,
        26,
        15,
        4,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\cifar10_shufflenetv2_0_5_e50_bs64.pth"
}