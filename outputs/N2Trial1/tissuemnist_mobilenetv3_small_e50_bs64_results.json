{
  "config": {
    "dataset": "tissuemnist",
    "model_name": "mobilenetv3_small",
    "data_root": "./data",
    "tinyimagenet_root": "./tiny-imagenet-200",
    "epochs": 50,
    "batch_size": 64,
    "num_workers": 0,
    "lr": 0.05,
    "weight_decay": 0.0001,
    "momentum": 0.9,
    "seed": 42,
    "reject_percentiles": [
      10,
      20,
      30,
      40,
      50
    ],
    "hybrid_weight_entropy": 0.5,
    "hybrid_weight_grad": 0.5,
    "out_dir": "./outputs"
  },
  "train_history": [
    {
      "epoch": 1,
      "train_loss": 1.3027553415182613,
      "train_acc": 0.5167829040407093,
      "lr": 0.04995066821070679
    },
    {
      "epoch": 2,
      "train_loss": 1.2891606307635763,
      "train_acc": 0.5226693097071302,
      "lr": 0.04980286753286195
    },
    {
      "epoch": 3,
      "train_loss": 1.2529097066467316,
      "train_acc": 0.5350041700409752,
      "lr": 0.04955718126821722
    },
    {
      "epoch": 4,
      "train_loss": 1.2806329336475077,
      "train_acc": 0.52297148658939,
      "lr": 0.04921457902821577
    },
    {
      "epoch": 5,
      "train_loss": 1.310168225556616,
      "train_acc": 0.514552838649632,
      "lr": 0.04877641290737884
    },
    {
      "epoch": 6,
      "train_loss": 1.2664492690094769,
      "train_acc": 0.5313961780667932,
      "lr": 0.04824441214720628
    },
    {
      "epoch": 7,
      "train_loss": 1.2228461401146107,
      "train_acc": 0.5479917324405014,
      "lr": 0.04762067631165049
    },
    {
      "epoch": 8,
      "train_loss": 1.194777955202934,
      "train_acc": 0.5608523805494784,
      "lr": 0.04690766700109659
    },
    {
      "epoch": 9,
      "train_loss": 1.1584875310239489,
      "train_acc": 0.5757678314578222,
      "lr": 0.04610819813755038
    },
    {
      "epoch": 10,
      "train_loss": 1.134525125789194,
      "train_acc": 0.5829415106426697,
      "lr": 0.045225424859373684
    },
    {
      "epoch": 11,
      "train_loss": 1.1174609357765783,
      "train_acc": 0.5905140633121003,
      "lr": 0.04426283106939473
    },
    {
      "epoch": 12,
      "train_loss": 1.1033414296738586,
      "train_acc": 0.5959472036551315,
      "lr": 0.043224215685535285
    },
    {
      "epoch": 13,
      "train_loss": 1.094817356897418,
      "train_acc": 0.5985096636166947,
      "lr": 0.04211367764821721
    },
    {
      "epoch": 14,
      "train_loss": 1.0870467588063584,
      "train_acc": 0.6013199086217108,
      "lr": 0.04093559974371724
    },
    {
      "epoch": 15,
      "train_loss": 1.0784177129286197,
      "train_acc": 0.6046680284771494,
      "lr": 0.03969463130731183
    },
    {
      "epoch": 16,
      "train_loss": 1.069241555889689,
      "train_acc": 0.6079980177196523,
      "lr": 0.03839566987447491
    },
    {
      "epoch": 17,
      "train_loss": 1.0577086668367948,
      "train_acc": 0.6115878790808988,
      "lr": 0.03704384185254288
    },
    {
      "epoch": 18,
      "train_loss": 1.0515212348127263,
      "train_acc": 0.6143920805482698,
      "lr": 0.03564448228912681
    },
    {
      "epoch": 19,
      "train_loss": 1.0440135412458948,
      "train_acc": 0.6167853214557674,
      "lr": 0.034203113817116944
    },
    {
      "epoch": 20,
      "train_loss": 1.038170300450125,
      "train_acc": 0.6183264235552923,
      "lr": 0.03272542485937368
    },
    {
      "epoch": 21,
      "train_loss": 1.0311102055011108,
      "train_acc": 0.6206954903122092,
      "lr": 0.03121724717912136
    },
    {
      "epoch": 22,
      "train_loss": 1.022907932312168,
      "train_acc": 0.624762791147426,
      "lr": 0.029684532864643114
    },
    {
      "epoch": 23,
      "train_loss": 1.019142783785524,
      "train_acc": 0.6258204102353353,
      "lr": 0.028133330839107608
    },
    {
      "epoch": 24,
      "train_loss": 1.010836598760259,
      "train_acc": 0.6272769028078276,
      "lr": 0.026569762988232833
    },
    {
      "epoch": 25,
      "train_loss": 1.0054173971492475,
      "train_acc": 0.6306250226632661,
      "lr": 0.024999999999999998
    },
    {
      "epoch": 26,
      "train_loss": 0.9992743557983859,
      "train_acc": 0.6331149601730869,
      "lr": 0.023430237011767163
    },
    {
      "epoch": 27,
      "train_loss": 0.9930515670696254,
      "train_acc": 0.6359191616404578,
      "lr": 0.02186666916089239
    },
    {
      "epoch": 28,
      "train_loss": 0.9872019918634114,
      "train_acc": 0.6381673576444707,
      "lr": 0.020315467135356882
    },
    {
      "epoch": 29,
      "train_loss": 0.9809649972858129,
      "train_acc": 0.6397809821957381,
      "lr": 0.01878275282087863
    },
    {
      "epoch": 30,
      "train_loss": 0.9746567053400229,
      "train_acc": 0.6412495618435208,
      "lr": 0.017274575140626323
    },
    {
      "epoch": 31,
      "train_loss": 0.9693103825680147,
      "train_acc": 0.6442169388273119,
      "lr": 0.01579688618288306
    },
    {
      "epoch": 32,
      "train_loss": 0.9615424403464705,
      "train_acc": 0.6472749688757812,
      "lr": 0.014355517710873183
    },
    {
      "epoch": 33,
      "train_loss": 0.9558405775030687,
      "train_acc": 0.649492947191568,
      "lr": 0.012956158147457113
    },
    {
      "epoch": 34,
      "train_loss": 0.9504818682233542,
      "train_acc": 0.6504840873653802,
      "lr": 0.011604330125525078
    },
    {
      "epoch": 35,
      "train_loss": 0.9445927663359674,
      "train_acc": 0.6521883649813255,
      "lr": 0.010305368692688173
    },
    {
      "epoch": 36,
      "train_loss": 0.9358029531976946,
      "train_acc": 0.656400710720027,
      "lr": 0.009064400256282756
    },
    {
      "epoch": 37,
      "train_loss": 0.9305619215368165,
      "train_acc": 0.6581049883359723,
      "lr": 0.007886322351782781
    },
    {
      "epoch": 38,
      "train_loss": 0.9224314424908411,
      "train_acc": 0.6603048360388237,
      "lr": 0.006775784314464716
    },
    {
      "epoch": 39,
      "train_loss": 0.9162711999994235,
      "train_acc": 0.662565119118127,
      "lr": 0.005737168930605271
    },
    {
      "epoch": 40,
      "train_loss": 0.9091445344458919,
      "train_acc": 0.6656835845430481,
      "lr": 0.004774575140626316
    },
    {
      "epoch": 41,
      "train_loss": 0.9004383795860765,
      "train_acc": 0.6694064037324888,
      "lr": 0.0038918018624496285
    },
    {
      "epoch": 42,
      "train_loss": 0.8936505296895921,
      "train_acc": 0.6721743439739886,
      "lr": 0.0030923329989034102
    },
    {
      "epoch": 43,
      "train_loss": 0.8867737764492789,
      "train_acc": 0.6745131930426794,
      "lr": 0.0023793236883495163
    },
    {
      "epoch": 44,
      "train_loss": 0.8797949451298963,
      "train_acc": 0.6776618761558266,
      "lr": 0.0017555878527937164
    },
    {
      "epoch": 45,
      "train_loss": 0.8707479264748769,
      "train_acc": 0.6800067687621626,
      "lr": 0.0012235870926211618
    },
    {
      "epoch": 46,
      "train_loss": 0.8646213345600385,
      "train_acc": 0.6837900233280553,
      "lr": 0.0007854209717842259
    },
    {
      "epoch": 47,
      "train_loss": 0.85908553796359,
      "train_acc": 0.6846844668995443,
      "lr": 0.000442818731782782
    },
    {
      "epoch": 48,
      "train_loss": 0.8553745082505584,
      "train_acc": 0.6866183989460071,
      "lr": 0.00019713246713805587
    },
    {
      "epoch": 49,
      "train_loss": 0.8498688774515045,
      "train_acc": 0.6883408071748879,
      "lr": 4.933178929321102e-05
    },
    {
      "epoch": 50,
      "train_loss": 0.8487334656841903,
      "train_acc": 0.6890962493805374,
      "lr": 0.0
    }
  ],
  "baseline": {
    "test_acc": 0.6517343485617597,
    "test_loss": 0.9628682675498794
  },
  "uncertainty_metrics": {
    "entropy": {
      "AUROC_error": 0.7550073167166211,
      "ECE": 0.02911635747970462,
      "ARC_area": 0.8272273221648976,
      "AvUC": 0.38563329853667466
    },
    "gradient": {
      "AUROC_error": 0.41803954715705244,
      "ECE": 0.02911635747970462,
      "ARC_area": 0.5978060800878914,
      "AvUC": 0.42489150009019927
    },
    "hybrid": {
      "AUROC_error": 0.7344785438789864,
      "ECE": 0.02911635747970462,
      "ARC_area": 0.8122748078294035,
      "AvUC": 0.40526239922673596
    }
  },
  "percentile_rejection": [
    {
      "method": "entropy",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6861722128219591,
      "kept_count": 42552
    },
    {
      "method": "entropy",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.7177717851099831,
      "kept_count": 37824
    },
    {
      "method": "entropy",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.7518431230360164,
      "kept_count": 33096
    },
    {
      "method": "entropy",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.788917089678511,
      "kept_count": 28368
    },
    {
      "method": "entropy",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.8265651438240271,
      "kept_count": 23640
    },
    {
      "method": "gradient",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6386068809926678,
      "kept_count": 42552
    },
    {
      "method": "gradient",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6277760152284264,
      "kept_count": 37824
    },
    {
      "method": "gradient",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6175066473289823,
      "kept_count": 33096
    },
    {
      "method": "gradient",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6077975183305132,
      "kept_count": 28368
    },
    {
      "method": "gradient",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.5969966159052453,
      "kept_count": 23640
    },
    {
      "method": "hybrid",
      "reject_percent": 10,
      "rejection_rate": 0.1,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.6820830983267532,
      "kept_count": 42552
    },
    {
      "method": "hybrid",
      "reject_percent": 20,
      "rejection_rate": 0.2,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.7135152284263959,
      "kept_count": 37824
    },
    {
      "method": "hybrid",
      "reject_percent": 30,
      "rejection_rate": 0.3,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.7441382644428329,
      "kept_count": 33096
    },
    {
      "method": "hybrid",
      "reject_percent": 40,
      "rejection_rate": 0.4,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.7758742244782854,
      "kept_count": 28368
    },
    {
      "method": "hybrid",
      "reject_percent": 50,
      "rejection_rate": 0.5,
      "accuracy_before_rejection": 0.6517343485617597,
      "accuracy_after_rejection": 0.810575296108291,
      "kept_count": 23640
    }
  ],
  "reliability": {
    "n_bins": 15,
    "edges": [
      0.0,
      0.06666666666666667,
      0.13333333333333333,
      0.2,
      0.26666666666666666,
      0.3333333333333333,
      0.4,
      0.4666666666666667,
      0.5333333333333333,
      0.6,
      0.6666666666666666,
      0.7333333333333333,
      0.8,
      0.8666666666666667,
      0.9333333333333333,
      1.0
    ],
    "bin_conf": [
      NaN,
      NaN,
      0.19052095711231232,
      0.24506162106990814,
      0.3055184483528137,
      0.36943045258522034,
      0.4348587095737457,
      0.4997280240058899,
      0.565680980682373,
      0.6325560212135315,
      0.6997813582420349,
      0.7666683793067932,
      0.8331355452537537,
      0.9011974334716797,
      0.9717954397201538
    ],
    "bin_acc": [
      NaN,
      NaN,
      0.1428571492433548,
      0.2469135820865631,
      0.312710165977478,
      0.3422003388404846,
      0.418268084526062,
      0.4686242938041687,
      0.5285230875015259,
      0.6056105494499207,
      0.6676528453826904,
      0.725885808467865,
      0.7931361198425293,
      0.8655107021331787,
      0.9524893164634705
    ],
    "bin_count": [
      0,
      0,
      14,
      324,
      1487,
      3045,
      4215,
      4972,
      4435,
      4242,
      4056,
      4064,
      4225,
      4729,
      7472
    ]
  },
  "score_distributions": {
    "entropy": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        1839,
        1696,
        1522,
        1449,
        1381,
        1305,
        1325,
        1353,
        1357,
        1406,
        1543,
        1680,
        1663,
        1627,
        1544,
        1428,
        1344,
        1109,
        982,
        854,
        641,
        526,
        403,
        318,
        248,
        156,
        80,
        27,
        8,
        0
      ],
      "incorrect_counts": [
        23,
        67,
        89,
        109,
        148,
        191,
        239,
        267,
        335,
        444,
        583,
        713,
        883,
        1052,
        1101,
        1242,
        1312,
        1282,
        1130,
        1017,
        895,
        840,
        728,
        607,
        490,
        343,
        213,
        87,
        34,
        2
      ]
    },
    "gradient": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        25,
        446,
        1691,
        3157,
        3855,
        4146,
        4209,
        3955,
        3247,
        2422,
        1612,
        901,
        572,
        281,
        121,
        83,
        47,
        18,
        12,
        6,
        3,
        0,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        1
      ],
      "incorrect_counts": [
        18,
        358,
        1388,
        2301,
        2540,
        2475,
        2175,
        1875,
        1378,
        862,
        502,
        307,
        126,
        80,
        35,
        19,
        15,
        4,
        3,
        2,
        1,
        1,
        0,
        0,
        0,
        0,
        1,
        0,
        0,
        0
      ]
    },
    "hybrid": {
      "n_bins": 30,
      "edges": [
        0.0,
        0.03333333333333333,
        0.06666666666666667,
        0.1,
        0.13333333333333333,
        0.16666666666666666,
        0.2,
        0.23333333333333334,
        0.26666666666666666,
        0.3,
        0.3333333333333333,
        0.36666666666666664,
        0.4,
        0.43333333333333335,
        0.4666666666666667,
        0.5,
        0.5333333333333333,
        0.5666666666666667,
        0.6,
        0.6333333333333333,
        0.6666666666666666,
        0.7,
        0.7333333333333333,
        0.7666666666666666,
        0.8,
        0.8333333333333334,
        0.8666666666666667,
        0.9,
        0.9333333333333333,
        0.9666666666666667,
        1.0
      ],
      "correct_counts": [
        0,
        43,
        396,
        1410,
        2534,
        3153,
        3025,
        3067,
        3203,
        3305,
        3321,
        2846,
        2034,
        1254,
        690,
        336,
        148,
        26,
        19,
        3,
        1,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ],
      "incorrect_counts": [
        0,
        0,
        23,
        84,
        164,
        347,
        537,
        808,
        1250,
        1857,
        2361,
        2617,
        2426,
        1810,
        1120,
        633,
        312,
        82,
        28,
        5,
        2,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0,
        0
      ]
    }
  },
  "checkpoint_path": "./outputs\\tissuemnist_mobilenetv3_small_e50_bs64.pth"
}